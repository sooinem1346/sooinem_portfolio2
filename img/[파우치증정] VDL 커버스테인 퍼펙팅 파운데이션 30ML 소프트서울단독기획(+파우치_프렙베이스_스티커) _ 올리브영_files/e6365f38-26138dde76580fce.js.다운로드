"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9420],{99303:function(t,e,r){r.d(e,{ZP:function(){return vE}});var n,i,o,s,u,a,c,p,l,f,h,d,v,y,g,m,E,w,T,b,I,N,_,A,O,M,P,S,R,U,C,x,k,D,L,F,V,K=r(94993),G=r(35070),B=function(){function t(){}return t.isNotNullOrUndefined=function(t){return null!=t},t.isNullOrUndefined=function(t){return null==t},t.requiredNotNullOrUndefined=function(t,e){if(void 0===e&&(e=function(){return"Required value is null or undefined"}),this.isNullOrUndefined(t))throw Error(e());return t},t.fromMap=function(t){var e={};return t.forEach(function(t,r){e[r]=t}),e},t}(),H=function(){function t(){}return t.mapNotNullOrUndefined=function(t,e){for(var r=[],n=0;n<t.length;n++){var i=e(t[n]);B.isNotNullOrUndefined(i)&&r.push(i)}return r},t.mapOrUndefined=function(t,e){for(var r=[],n=0;n<t.length;n++){var i=e(t[n]);if(B.isNullOrUndefined(i))return;r.push(i)}return r},t.associateTo=function(t,e,r){for(var n=0;n<t.length;n++){var i=r(t[n]);e.set(i[0],i[1])}return e},t.associate=function(t,e){return this.associateTo(t,new Map,e)},t.associateBy=function(t,e){return this.associate(t,function(t){return[e(t),t]})},t.associateRecord=function(t,e){for(var r={},n=0;n<t.length;n++){var i=e(t[n]),o=i[0],s=i[1];r[o]=s}return r},t.chunked=function(t,e){for(var r=[],n=t.slice();n.length;)r.push(n.splice(0,e));return r},t.sum=function(t,e){return t.reduce(function(t,r){return t+e(r)},0)},t}(),j={DISABLE:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},J=function(){function t(){}return t.setLogLevel=function(t){void 0===t&&(t=j.INFO),this.logLevel=t},t.initCounter=function(t){this.counters=H.associate(Object.keys(j),function(e){return[e,t(e)]})},t._log=function(t,e){var r;switch(t){case"WARN":r="orange";break;case"ERROR":r="red";break;default:r="#AAAAAA"}if(e instanceof Error){z.log(t,r,e.message,e);return}try{z.log(t,r,e)}catch(t){}},t.increment=function(e){var r,n;null===(n=null===(r=t.counters)||void 0===r?void 0:r.get(e))||void 0===n||n.increment()},t.logLevel=j.INFO,t.log={error:function(e){t.logLevel>=j.ERROR&&(t._log("ERROR",e),t.increment("ERROR"))},warn:function(e){t.logLevel>=j.WARN&&(t._log("WARN",e),t.increment("WARN"))},info:function(e){t.logLevel>=j.INFO&&(t._log("INFO",e),t.increment("INFO"))},debug:function(e){t.logLevel>=j.DEBUG&&(t._log("DEBUG",e),t.increment("DEBUG"))}},t}(),z=function(){function t(){}return t.log=function(t,e,r,n){},t}(),q=function(t,e){return(q=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function Y(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}q(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var W=function(){return(W=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function X(t,e,r,n){return new(r||(r=Promise))(function(i,o){function s(t){try{a(n.next(t))}catch(t){o(t)}}function u(t){try{a(n.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(s,u)}a((n=n.apply(t,e||[])).next())})}function $(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function Z(t,e,r){if(r||2==arguments.length)for(var n,i=0,o=e.length;i<o;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}var Q=J.log,tt=function(){function t(){}return t.isEqual=function(t,e){return t.type===e.type&&t.value===e.value},t.isEquals=function(t,e){if(null==e)return!1;var r=Object.keys(t);return r.length===Object.keys(e).length&&r.every(function(r){return t[r]===e[r]})},t.sanitize=function(t){var e={};if(B.isNullOrUndefined(t))return e;for(var r=0,n=Object.entries(t);r<n.length;r++){var i=n[r],o=i[0],s=i[1];if(!this.isValidType(o)){Q.debug("Invalid identifier type. The identifier type must be a string of 128 characters or less. [".concat(o,"]"));continue}var u=this.sanitizeValue(s);if(B.isNullOrUndefined(u)){Q.debug("Invalid identifier value. The identifier type value be a string of 512 characters or less. [".concat(o,"]"));continue}e[o]=u}return e},t.isValidType=function(t){return!B.isNullOrUndefined(t)&&"string"==typeof t&&t.length>0&&t.length<=this.MAX_IDENTIFIER_TYPE_LENGTH},t.sanitizeValue=function(t){return"string"==typeof t&&t.length>0&&t.length<=this.MAX_IDENTIFIER_VALUE_LENGTH?t:"number"==typeof t?t.toString():null},t.MAX_IDENTIFIER_TYPE_LENGTH=128,t.MAX_IDENTIFIER_VALUE_LENGTH=512,t}(),te=J.log,tr=function(){function t(){}return t.sanitize=function(t){var e={};if(B.isNullOrUndefined(t))return e;for(var r=0,n=Object.entries(t);r<n.length;r++){var i=n[r],o=i[0],s=i[1];if(Object.keys(e).length>=this.MAX_PROPERTIES_COUNT){te.debug("The number of properties cannot exceed 128. Drops excess properties. [".concat(o,", ").concat(s,"]"));break}if(!this.isValidKey(o)){te.debug("Invalid property key. The property key must be a string of 128 characters or less. [".concat(o,"]"));continue}var u=this.sanitizeValue(o,s);if(B.isNullOrUndefined(u)){te.debug("Invalid property value. The property value mus be 'string(..1024)', 'number', 'boolean', or 'array' type. [".concat(s,"]"));continue}e[o]=u}return e},t.isValidProperty=function(t,e){return this.isValidKey(t)&&this.isValidValue(e)},t.isValidKey=function(t){return B.isNotNullOrUndefined(t)&&"string"==typeof t&&t.length>0&&t.length<=this.MAX_PROPERTY_KEY_LENGTH},t.sanitizeValue=function(t,e){var r=this;return"string"==typeof t&&t.startsWith(this.SYSTEM_PROPERTY_KEY_PREFIX)?e:this.isValidValue(e)?Array.isArray(e)?e.filter(function(t){return r.isValidElement(t)}):e:null},t.isValidValue=function(t){return!B.isNullOrUndefined(t)&&("string"==typeof t?t.length<=this.MAX_PROPERTY_VALUE_LENGTH:"number"==typeof t?!isNaN(t)&&isFinite(t):"boolean"==typeof t||Array.isArray(t))},t.isValidElement=function(t){return!B.isNullOrUndefined(t)&&("string"==typeof t?t.length>0&&t.length<=this.MAX_PROPERTY_VALUE_LENGTH:"number"==typeof t)},t.truncateStringValue=function(t){return"string"==typeof t&&t.length>this.MAX_PROPERTY_VALUE_LENGTH?t.slice(0,this.MAX_PROPERTY_VALUE_LENGTH):t},t.SYSTEM_PROPERTY_KEY_PREFIX="$",t.MAX_PROPERTIES_COUNT=128,t.MAX_PROPERTY_KEY_LENGTH=128,t.MAX_PROPERTY_VALUE_LENGTH=1024,t}(),tn=["nanoseconds","microseconds","milliseconds","seconds","minutes","hours","days"],ti=function(){function t(){}return t.nanosToUnit=function(e,r){switch(r){case"nanoseconds":return e;case"microseconds":return e/(t.C1/t.C0);case"milliseconds":return e/(t.C2/t.C0);case"seconds":return e/(t.C3/t.C0);case"minutes":return e/(t.C4/t.C0);case"hours":return e/(t.C5/t.C0);case"days":return e/(t.C6/t.C0)}},t.microsToUnit=function(e,r){switch(r){case"nanoseconds":return t.C1/t.C0*e;case"milliseconds":return e/(t.C2/t.C1);case"microseconds":return e;case"seconds":return e/(t.C3/t.C1);case"minutes":return e/(t.C4/t.C1);case"hours":return e/(t.C5/t.C1);case"days":return e/(t.C6/t.C1)}},t.millisToUnit=function(e,r){switch(r){case"nanoseconds":return t.C2/t.C0*e;case"microseconds":return t.C2/t.C1*e;case"milliseconds":return e;case"seconds":return e/(t.C3/t.C2);case"minutes":return e/(t.C4/t.C2);case"hours":return e/(t.C5/t.C2);case"days":return e/(t.C6/t.C2)}},t.secondsToUnit=function(e,r){switch(r){case"nanoseconds":return t.C3/t.C0*e;case"microseconds":return t.C3/t.C1*e;case"milliseconds":return t.C3/t.C2*e;case"seconds":return e;case"minutes":return e/(t.C4/t.C3);case"hours":return e/(t.C5/t.C3);case"days":return e/(t.C6/t.C3)}},t.minutesToUnit=function(e,r){switch(r){case"nanoseconds":return t.C4/t.C0*e;case"microseconds":return t.C4/t.C1*e;case"milliseconds":return t.C4/t.C2*e;case"seconds":return t.C4/t.C3*e;case"minutes":return e;case"hours":return e/(t.C5/t.C4);case"days":return e/(t.C6/t.C4)}},t.hoursToUnit=function(e,r){switch(r){case"nanoseconds":return t.C5/t.C0*e;case"microseconds":return t.C5/t.C1*e;case"milliseconds":return t.C5/t.C2*e;case"seconds":return t.C5/t.C3*e;case"minutes":return t.C5/t.C4*e;case"hours":return e;case"days":return e/(t.C6/t.C5)}},t.daysToUnit=function(e,r){switch(r){case"nanoseconds":return t.C6/t.C0*e;case"microseconds":return t.C6/t.C1*e;case"milliseconds":return t.C6/t.C2*e;case"seconds":return t.C6/t.C3*e;case"minutes":return t.C6/t.C4*e;case"hours":return t.C6/t.C5*e;case"days":return e}},t.C0=1,t.C1=1e3*t.C0,t.C2=1e3*t.C1,t.C3=1e3*t.C2,t.C4=60*t.C3,t.C5=60*t.C4,t.C6=24*t.C5,t.converter={nanoseconds:t.nanosToUnit,microseconds:t.microsToUnit,milliseconds:t.millisToUnit,seconds:t.secondsToUnit,minutes:t.minutesToUnit,hours:t.hoursToUnit,days:t.daysToUnit},t}(),to=function(){function t(){}return t.prototype.tick=function(){return 1e3*Date.now()},t.prototype.currentMillis=function(){return Date.now()},t.instance=new t,t}(),ts=function(){function t(){this.parameters={}}return t.prototype.get=function(t,e){return e},t}(),tu=function(){function t(t){this.parameters=t}return t.prototype.get=function(t,e){var r=this.parameters[t];return B.isNullOrUndefined(r)?e:B.isNullOrUndefined(e)||typeof r==typeof e?r:e},t}(),ta="X-HACKLE-SDK-KEY",tc="X-HACKLE-SDK-NAME",tp="X-HACKLE-SDK-VERSION",tl="X-HACKLE-SDK-TIME",tf="_hackle_hid",th="_hackle_id",td="_hackle_session_id",tv="_hackle_last_event_ts",ty="_hackle_uid",tg="_hackle_did",tm="_hackle_mkt",tE=1/86400*3,tw="hackle-workspace-config",tT=J.log;function tb(t,e){var r=t.find(function(t){return t===e||t.toLowerCase()===e.toLowerCase()});return r||tT.debug("Unsupported type [".concat(e,"]. Please use the latest version of sdk.")),r}function tI(t,e){if(!B.isNullOrUndefined(e)){for(var r=[],n=0;n<e.length;n++){var i=tb(t,e[n]);if(B.isNullOrUndefined(i))return;r.push(i)}return r}}var tN=function(){function t(t,e){this.value=t,this.reason=e}return t.of=function(e,r){return new t(e,r)},t}(),t_=function(){function t(t,e,r,n){this.variation=t,this.reason=e,this.config=r,this.experiment=n}return t.of=function(e,r,n,i){return void 0===n&&(n=new ts),void 0===i&&(i=void 0),new t(e,r,n,i)},Object.defineProperty(t.prototype,"parameters",{get:function(){return this.config.parameters},enumerable:!1,configurable:!0}),t.prototype.get=function(t,e){return this.config.get(t,e)},t}(),tA=function(){function t(t,e,r,n){this.isOn=t,this.reason=e,this.config=r,this.experiment=n}return t.on=function(e,r,n){return void 0===r&&(r=new ts),void 0===n&&(n=void 0),new t(!0,e,r,n)},t.off=function(e,r,n){return void 0===r&&(r=new ts),void 0===n&&(n=void 0),new t(!1,e,r,n)},Object.defineProperty(t.prototype,"parameters",{get:function(){return this.config.parameters},enumerable:!1,configurable:!0}),t.prototype.get=function(t,e){return this.config.get(t,e)},t}();(function(){}).prototype.get=function(t,e){return e};var tO=function(){function t(t,e){this.id=t,this.config=e}return Object.defineProperty(t.prototype,"parameters",{get:function(){return this.config.parameters},enumerable:!1,configurable:!0}),t.fromJson=function(e){return new t(e.id,new tu(H.associateRecord(e.parameters,function(t){return[t.key,t.value]})))},t.prototype.get=function(t,e){switch(typeof e){case"string":case"number":case"boolean":return this.config.get(t,e);default:return e}},t}(),tM=function(){function t(){}return t.SDK_NOT_READY="SDK_NOT_READY",t.EXCEPTION="EXCEPTION",t.INVALID_INPUT="INVALID_INPUT",t.UNSUPPORTED_PLATFORM="UNSUPPORTED_PLATFORM",t.TYPE_MISMATCH="TYPE_MISMATCH",t.EXPERIMENT_NOT_FOUND="EXPERIMENT_NOT_FOUND",t.EXPERIMENT_DRAFT="EXPERIMENT_DRAFT",t.EXPERIMENT_PAUSED="EXPERIMENT_PAUSED",t.EXPERIMENT_COMPLETED="EXPERIMENT_COMPLETED",t.OVERRIDDEN="OVERRIDDEN",t.TRAFFIC_NOT_ALLOCATED="TRAFFIC_NOT_ALLOCATED",t.NOT_IN_MUTUAL_EXCLUSION_EXPERIMENT="NOT_IN_MUTUAL_EXCLUSION_EXPERIMENT",t.IDENTIFIER_NOT_FOUND="IDENTIFIER_NOT_FOUND",t.VARIATION_DROPPED="VARIATION_DROPPED",t.TRAFFIC_ALLOCATED="TRAFFIC_ALLOCATED",t.TRAFFIC_ALLOCATED_BY_TARGETING="TRAFFIC_ALLOCATED_BY_TARGETING",t.NOT_IN_EXPERIMENT_TARGET="NOT_IN_EXPERIMENT_TARGET",t.FEATURE_FLAG_NOT_FOUND="FEATURE_FLAG_NOT_FOUND",t.FEATURE_FLAG_INACTIVE="FEATURE_FLAG_INACTIVE",t.INDIVIDUAL_TARGET_MATCH="INDIVIDUAL_TARGET_MATCH",t.TARGET_RULE_MATCH="TARGET_RULE_MATCH",t.DEFAULT_RULE="DEFAULT_RULE",t.REMOTE_CONFIG_PARAMETER_NOT_FOUND="REMOTE_CONFIG_PARAMETER_NOT_FOUND",t.IN_APP_MESSAGE_NOT_FOUND="IN_APP_MESSAGE_NOT_FOUND",t.IN_APP_MESSAGE_DRAFT="IN_APP_MESSAGE_DRAFT",t.IN_APP_MESSAGE_PAUSED="IN_APP_MESSAGE_PAUSED",t.IN_APP_MESSAGE_HIDDEN="IN_APP_MESSAGE_HIDDEN",t.IN_APP_MESSAGE_TARGET="IN_APP_MESSAGE_TARGET",t.NOT_IN_IN_APP_MESSAGE_PERIOD="NOT_IN_IN_APP_MESSAGE_PERIOD",t.NOT_IN_IN_APP_MESSAGE_TARGET="NOT_IN_IN_APP_MESSAGE_TARGET",t.IN_APP_MESSAGE_FREQUENCY_CAPPED="IN_APP_MESSAGE_FREQUENCY_CAPPED",t.EXPERIMENT_CONTROL_GROUP="EXPERIMENT_CONTROL_GROUP",t}(),tP=["DEFAULT","SPLIT_URL","IN_APP_MESSAGE"],tS=function(){function t(t,e,r,n,i,o,s,u,a,c,p,l,f,h,d,v,y){this.id=t,this.key=e,this.type=r,this.identifierType=n,this.status=i,this.version=o,this.executionVersion=s,this.variations=u,this.userOverrides=a,this.segmentOverrides=c,this.targetAudiences=p,this.splitUrlTargets=l,this.targetRules=f,this.defaultRule=h,this.containerId=d,this.implementationType=v,this.winnerVariationId=y}return t.fromJson=function(e,r,n){var i=t.experimentStatusOrNull(r.execution.status),o=r.variations.map(function(t){return new tR(t.id,t.key,"DROPPED"===t.status,n.find(function(e){return e.id===t.parameterConfigurationId}))}),s=H.associate(r.execution.userOverrides,function(t){return[t.userId,t.variationId]}),u=H.mapNotNullOrUndefined(r.execution.segmentOverrides,function(t){return tj.fromJson(t,t5.IDENTIFIER)}),a=H.mapNotNullOrUndefined(r.execution.targetAudiences,function(t){return tV.fromJson(t,t5.PROPERTY)}),c=eF.fromJson(r.execution.targetUrls),p=tb(tP,r.implementationType),l=H.mapNotNullOrUndefined(r.execution.targetRules,function(t){return tj.fromJson(t,t5.PROPERTY)}),f=tH.fromJson(r.execution.defaultRule);return i&&p&&f&&new t(r.id,r.key,e,r.identifierType,i,r.version,r.execution.version,o,s,u,a,c,l,f,r.containerId,p,r.winnerVariationId)},t.experimentStatusOrNull=function(t){switch(t){case"READY":return"DRAFT";case"RUNNING":return"RUNNING";case"PAUSED":return"PAUSED";case"STOPPED":return"COMPLETED";default:tT.debug("Unsupported status [".concat(t,"]"));return}},t.prototype._winnerVariationOrNull=function(){if(this.winnerVariationId)return this._getVariationByIdOrNull(this.winnerVariationId)},t.prototype._getVariationByIdOrNull=function(t){return this.variations.find(function(e){return e.id===t})},t.prototype._getVariationByKeyOrNull=function(t){return this.variations.find(function(e){return e.key===t})},t}(),tR=function(){function t(t,e,r,n){this.id=t,this.key=e,this.isDropped=r,this.config=n}return Object.defineProperty(t.prototype,"parameters",{get:function(){var t,e;return null!==(e=null===(t=this.config)||void 0===t?void 0:t.parameters)&&void 0!==e?e:{}},enumerable:!1,configurable:!0}),t}(),tU=function(){function t(t,e,r,n){this.id=t,this.seed=e,this.slotSize=r,this.slots=n}return t.fromJson=function(e){return new t(e.id,e.seed,e.slotSize,e.slots.map(function(t){return new tC(t.startInclusive,t.endExclusive,t.variationId)}))},t}(),tC=function(){function t(t,e,r){this.startInclusive=t,this.endExclusive=e,this.variationId=r}return t.prototype.contains=function(t){return this.startInclusive<=t&&t<this.endExclusive},t}(),tx=function(){function t(t,e){this.id=t,this.key=e}return t.fromJson=function(e){return new t(e.id,e.key)},t}(),tk=function(){function t(){}return t.ID="$id",t.USER="$userId",t.DEVICE="$deviceId",t.SESSION="$sessionId",t.HACKLE_DEVICE="$hackleDeviceId",t}(),tD=function(t){var e=new tL;return e.addIdentifiers(t.identifiers||{}),e.add(tk.ID,t.id),e.add(tk.DEVICE,t.deviceId),B.isNotNullOrUndefined(t.userId)&&e.add(tk.USER,t.userId),e.build()},tL=function(){function t(){this.identifiers={}}return t.prototype.addIdentifiers=function(t){for(var e in t)this.add(e,t[e]);return this},t.prototype.add=function(t,e){var r=tt.sanitizeValue(e);return tt.isValidType(t)&&r?this.identifiers[t]=e:tT.warn("Invalid user identifier [type=".concat(t,", value=").concat(e,"]")),this},t.prototype.build=function(){return this.identifiers},t}(),tF=function(t){var e,r,n,i={};return(i.id=null!==(e=tt.sanitizeValue(t.id))&&void 0!==e?e:void 0,i.userId=null!==(r=tt.sanitizeValue(t.userId))&&void 0!==r?r:void 0,i.deviceId=null!==(n=tt.sanitizeValue(t.deviceId))&&void 0!==n?n:void 0,"object"==typeof t.properties&&(i.properties=tr.sanitize(t.properties)),"object"==typeof t.identifiers&&(i.identifiers=tt.sanitize(t.identifiers)),i.id||i.userId||i.deviceId||i.identifiers&&Object.keys(i.identifiers).length>0)?i:null},tV=function(){function t(t){this.conditions=t}return t.fromJson=function(e,r){return new t(H.mapNotNullOrUndefined(e.conditions,function(t){return tK.fromJson(t,r)}))},t.prototype.toJson=function(){return{conditions:this.conditions.map(function(t){return t.toJson()})}},t}(),tK=function(){function t(t,e){this.key=t,this.match=e}return t.fromJson=function(e,r){var n=tG.fromJson(e.key);if(n&&r.supports(n.type)){var i=tB.fromJson(e.match);return i&&new t(n,i)}},t.prototype.toJson=function(){return{key:this.key.toJson(),match:this.match.toJson()}},t}(),tG=function(){function t(t,e){this.type=t,this.name=e}return t.fromJson=function(e){var r=tb(t3,e.type);return r&&new t(r,e.name)},t.prototype.toJson=function(){return{type:this.type,name:this.name}},t}(),tB=function(){function t(t,e,r,n){this.type=t,this.operator=e,this.valueType=r,this.values=n}return t.fromJson=function(e){var r=tb(t0,e.type),n=tb(t2,e.operator),i=tb(t1,e.valueType);return r&&n&&i&&new t(r,n,i,e.values)},t.prototype.toJson=function(){return{operator:this.operator,type:this.type,valueType:this.valueType,values:this.values}},t}(),tH=function(){function t(t,e,r){this.type=t,this.variationId=e,this.bucketId=r}return t.fromJson=function(e){var r=tb(t4,e.type);return r&&new t(r,e.variationId,e.bucketId)},t}(),tj=function(){function t(t,e){this.target=t,this.action=e}return t.fromJson=function(e,r){var n=tV.fromJson(e.target,r),i=tH.fromJson(e.action);return n&&i&&new t(n,i)},t}(),tJ=function(){function t(t,e,r,n){this.id=t,this.key=e,this.type=r,this.targets=n}return t.fromJson=function(e){var r=tb(t6,e.type);return r&&new t(e.id,e.key,r,H.mapNotNullOrUndefined(e.targets,function(t){return tV.fromJson(t,t5.SEGMENT)}))},t}(),tz=function(){function t(t,e,r){this.id=t,this.bucketId=e,this.groups=r}return t.fromJson=function(e){return new t(e.id,e.bucketId,e.groups.map(function(t){return tq.fromJson(t)}))},t.prototype.getGroupOrNull=function(t){return this.groups.find(function(e){return e.id===t})},t}(),tq=function(){function t(t,e){this.id=t,this.experiments=e}return t.fromJson=function(e){return new t(e.id,e.experiments)},t}(),tY=function(){function t(t,e,r,n,i,o){this.id=t,this.key=e,this.type=r,this.identifierType=n,this.targetRules=i,this.defaultValue=o}return t.fromJson=function(e){var r=tb(t1,e.type),n=H.mapNotNullOrUndefined(e.targetRules,function(t){return tW.fromJson(t,t5.PROPERTY)}),i=tX.fromJson(e.defaultValue);return r&&new t(e.id,e.key,r,e.identifierType,n,i)},t}(),tW=function(){function t(t,e,r,n,i){this.key=t,this.name=e,this.target=r,this.bucketId=n,this.value=i}return t.fromJson=function(e,r){var n=tV.fromJson(e.target,r);return n&&new t(e.key,e.name,n,e.bucketId,tX.fromJson(e.value))},t}(),tX=function(){function t(t,e){this.id=t,this.rawValue=e}return t.fromJson=function(e){return new t(e.id,e.value)},t}(),t$=function(){function t(t,e,r){this.coreVersion=t,this.prerelease=e,this.build=r}return t.tryParse=function(e){if(e instanceof t)return e;var r=t.regExp.exec(e);if(r){r[0];var n=r[1],i=r[2],o=r[3],s=r[4],u=r[5];return new t(new tZ(parseInt(n,10),parseInt(void 0===i?"0":i,10),parseInt(void 0===o?"0":o,10)),tQ.parse(s),tQ.parse(u))}},t.prototype.compareTo=function(t){return this.coreVersion.compareTo(t.coreVersion)||this.prerelease.compareTo(t.prerelease)},t.prototype.isEqualTo=function(t){return 0===this.compareTo(t)},t.prototype.isGreaterThan=function(t){return this.compareTo(t)>0},t.prototype.isGreaterThanOrEqualTo=function(t){return this.compareTo(t)>=0},t.prototype.isLessThan=function(t){return 0>this.compareTo(t)},t.prototype.isLessThanOrEqualTo=function(t){return 0>=this.compareTo(t)},t.regExp=/^(0|[1-9]\d*)(?:\.(0|[1-9]\d*))?(?:\.(0|[1-9]\d*))?(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/,t}(),tZ=function(){function t(t,e,r){this.major=t,this.minor=e,this.patch=r}return t.prototype.compareTo=function(t){return this.major-t.major||this.minor-t.minor||this.patch-t.patch},t}(),tQ=function(){function t(t){this.identifiers=t}return t.parse=function(e){return e?new t(e.split(".")):t.EMPTY},t.prototype.isEmpty=function(){return 0===this.identifiers.length},t.prototype.isNotEmpty=function(){return!this.isEmpty()},t.prototype.compareTo=function(t){return this.isEmpty()&&t.isEmpty()?0:this.isEmpty()&&t.isNotEmpty()?1:this.isNotEmpty()&&t.isEmpty()?-1:this.compareIdentifiers(t)},t.prototype.compareIdentifiers=function(e){for(var r=Math.min(this.identifiers.length,e.identifiers.length),n=0;n<r;n++){var i=t.compareIdentifiers(this.identifiers[n],e.identifiers[n]);if(0!==i)return i}return this.identifiers.length-e.identifiers.length},t.compareIdentifiers=function(e,r){return t.numericIdentifierRegExp.test(e)&&t.numericIdentifierRegExp.test(r)?+e-+r:e===r?0:e<r?-1:1},t.EMPTY=new t([]),t.numericIdentifierRegExp=/^(0|[1-9]\d*)$/,t}(),t0=["MATCH","NOT_MATCH"],t1=["STRING","NUMBER","BOOLEAN","VERSION","JSON","URL","NULL","UNKNOWN"],t2=["IN","CONTAINS","STARTS_WITH","ENDS_WITH","GT","GTE","LT","LTE","EXISTS"],t4=["VARIATION","BUCKET"],t3=["USER_ID","USER_PROPERTY","HACKLE_PROPERTY","SEGMENT","AB_TEST","FEATURE_FLAG","EVENT_PROPERTY","COHORT","NUMBER_OF_EVENTS_IN_DAYS","NUMBER_OF_EVENTS_WITH_PROPERTY_IN_DAYS"],t6=["USER_ID","USER_PROPERTY"],t5=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.supportedKeyTypes=t}return t.prototype.supports=function(t){return this.supportedKeyTypes.includes(t)},t.IDENTIFIER=new t("SEGMENT"),t.PROPERTY=new t("SEGMENT","USER_PROPERTY","HACKLE_PROPERTY","AB_TEST","FEATURE_FLAG","EVENT_PROPERTY","COHORT","NUMBER_OF_EVENTS_IN_DAYS","NUMBER_OF_EVENTS_WITH_PROPERTY_IN_DAYS"),t.SEGMENT=new t("USER_ID","USER_PROPERTY","HACKLE_PROPERTY","COHORT","NUMBER_OF_EVENTS_IN_DAYS","NUMBER_OF_EVENTS_WITH_PROPERTY_IN_DAYS"),t}(),t9=["ACTIVE","DRAFT","PAUSE"],t8=["WEB","ANDROID","IOS"],t7=["IMMEDIATE","CUSTOM"],et=["MODAL","BANNER","BOTTOM_SHEET","NONE"],ee=["IMAGE_TEXT","IMAGE_ONLY","TEXT_ONLY","IMAGE","NONE"],er=["VERTICAL","HORIZONTAL"],en=["CLICK"],ei=["CLOSE","WEB_LINK","HIDDEN","LINK_AND_CLOSE","LINK_NEW_TAB","LINK_NEW_TAB_AND_CLOSE","LINK_NEW_WINDOW","LINK_NEW_WINDOW_AND_CLOSE"],eo=["TOP","MIDDLE","BOTTOM"],es=["LEFT","CENTER","RIGHT"],eu=function(){function t(t,e,r,n,i,o,s,u){this.id=t,this.key=e,this.status=r,this.period=n,this.eventTrigger=i,this.targetContext=o,this.messageContext=s,this.evaluateContext=u}return t.fromJson=function(e){var r,n,i,o=tb(t9,e.status);if(!B.isNullOrUndefined(o)){switch(tb(t7,e.timeUnit)){case"IMMEDIATE":i=new ea;break;case"CUSTOM":if(B.isNullOrUndefined(e.startEpochTimeMillis)||B.isNullOrUndefined(e.endEpochTimeMillis))return;i=new ec(e.startEpochTimeMillis,e.endEpochTimeMillis);break;default:return}var s=eg.fromJson(e.messageContext);if(!B.isNullOrUndefined(s)){var u=e.eventTriggerRules.map(el.fromJson),a=ef.fromJson(e.eventFrequencyCap),c=null!==(r=e.eventTriggerDelay&&ex.fromJson(e.eventTriggerDelay))&&void 0!==r?r:ex.immediate(),p=eU.fromJson(null!==(n=e.evaluateContext)&&void 0!==n?n:{atDeliverTime:!1});return new t(e.id,e.key,o,i,new ep(u,a,c),ev.fromJson(e.targetContext),s,p)}}},t.prototype.supports=function(t){return this.messageContext.platformTypes.includes(t)},t.prototype.toString=function(){return"InAppMessage(id=".concat(this.id,", key=").concat(this.key,", status=").concat(this.status,")")},t}(),ea=function(){function t(){this.type="IMMEDIATE"}return t.prototype.within=function(t){return!0},t}(),ec=function(){function t(t,e){this.startMillisInclusive=t,this.endMillisExclusive=e,this.type="CUSTOM"}return t.prototype.within=function(t){return this.startMillisInclusive<=t&&t<this.endMillisExclusive},t}(),ep=function(t,e,r){this.rules=t,this.frequencyCap=e,this.delay=r},el=function(){function t(t,e){this.eventKey=t,this.targets=e}return t.fromJson=function(e){return new t(e.eventKey,H.mapNotNullOrUndefined(e.targets,function(t){return tV.fromJson(t,t5.PROPERTY)}))},t}(),ef=function(){function t(t,e){this.identifierCaps=t,this.durationCap=e}return t.fromJson=function(e){return e?new t(e.identifiers.map(eh.fromJson),ed.fromJson(e.duration)):null},t}(),eh=function(){function t(t,e){this.identifierType=t,this.count=e}return t.fromJson=function(e){return new t(e.identifierType,e.countPerIdentifier)},t}(),ed=function(){function t(t,e){this.durationMillis=t,this.count=e}return t.fromJson=function(e){if(!e)return null;var r=tb(tn,e.durationUnit.timeUnit);return r?new t(ti.converter[r](e.durationUnit.amount,"milliseconds"),e.countPerDuration):null},t}(),ev=function(){function t(t,e){this.overrides=t,this.targets=e}return t.fromJson=function(e){return new t(e.overrides.map(ey.fromJson),H.mapNotNullOrUndefined(e.targets,function(t){return tV.fromJson(t,t5.PROPERTY)}))},t}(),ey=function(){function t(t,e){this.identifierType=t,this.identifiers=e}return t.fromJson=function(e){return new t(e.identifierType,e.identifiers)},t}(),eg=function(){function t(t,e,r,n,i){this.defaultLang=t,this.experimentContext=e,this.platformTypes=r,this.orientations=n,this.messages=i}return t.fromJson=function(e){var r=null;"AB_TEST"===e.exposure.type&&null!==e.exposure.key&&(r=new em(e.exposure.key));var n=tI(t8,e.platformTypes);if(!B.isNullOrUndefined(n)){var i=tI(er,e.orientations);if(!B.isNullOrUndefined(i)){var o=H.mapOrUndefined(e.messages,eE.fromJson);if(!B.isNullOrUndefined(o))return new t(e.defaultLang,r,n,i,o)}}},t}(),em=function(t){this.key=t},eE=function(){function t(t,e,r,n,i,o,s,u,a,c,p,l){this.variationKey=t,this.lang=e,this.layout=r,this.images=n,this.imageAutoScroll=i,this.text=o,this.buttons=s,this.closeButton=u,this.background=a,this.action=c,this.outerButtons=p,this.innerButtons=l}return t.fromJson=function(e){var r=ew.fromJson(e.layout);if(B.isNullOrUndefined(r))return;var n=H.mapOrUndefined(e.images,eb.fromJson);if(!B.isNullOrUndefined(n)){var i=void 0;if(!(B.isNotNullOrUndefined(e.imageAutoScroll)&&(i=eI.fromJson(e.imageAutoScroll),B.isNullOrUndefined(i)))){var o=H.mapOrUndefined(e.buttons,eO.fromJson);if(!B.isNullOrUndefined(o)){var s=void 0;if(!(B.isNotNullOrUndefined(e.closeButton)&&(s=eO.fromJson2(e.closeButton),B.isNullOrUndefined(s)))){var u=H.mapOrUndefined(e.outerButtons,eM.fromJson),a=H.mapOrUndefined(e.innerButtons,eM.fromJson);if(!(B.isNullOrUndefined(u)||B.isNullOrUndefined(a)))return new t(e.variationKey,e.lang,r,n,i,e.text?eN.fromJson(e.text):void 0,o,s,new eS(e.background.color),e.action?eR.fromJson(e.action):void 0,u,a)}}}}},t.prototype.toJson=function(){var t,e,r,n,i,o,s,u,a,c;return{variationKey:this.variationKey,lang:this.lang,layout:{layoutType:this.layout.layoutType,alignment:null!==(e=null===(t=this.layout.alignment)||void 0===t?void 0:t.toJson())&&void 0!==e?e:null,displayType:this.layout.displayType},images:this.images.map(function(t){return t.toJson()}),imageAutoScroll:null!==(n=null===(r=this.imageAutoScroll)||void 0===r?void 0:r.toJson())&&void 0!==n?n:null,text:null!==(o=null===(i=this.text)||void 0===i?void 0:i.toJson())&&void 0!==o?o:null,closeButton:null!==(u=null===(s=this.closeButton)||void 0===s?void 0:s.toCloseButtonJson())&&void 0!==u?u:null,buttons:this.buttons.map(function(t){return t.toJson()}),background:{color:this.background.color},action:null!==(c=null===(a=this.action)||void 0===a?void 0:a.toJson())&&void 0!==c?c:null,outerButtons:this.outerButtons.map(function(t){return t.toJson()}),innerButtons:this.innerButtons.map(function(t){return t.toJson()})}},t}(),ew=function(){function t(t,e,r){this.displayType=t,this.layoutType=e,this.alignment=r}return t.fromJson=function(e){var r=tb(ee,e.layoutType),n=tb(et,e.displayType);if(!(B.isNullOrUndefined(n)||B.isNullOrUndefined(r)))return new t(n,r,e.alignment?eT.fromJson(e.alignment):void 0)},t}(),eT=function(){function t(t,e){this.horizontal=t,this.vertical=e}return t.fromJson=function(e){var r=tb(es,e.horizontal);if(!B.isNullOrUndefined(r)){var n=tb(eo,e.vertical);if(!B.isNullOrUndefined(n))return new t(r,n)}},t.prototype.toJson=function(){return{horizontal:this.horizontal,vertical:this.vertical}},t}(),eb=function(){function t(t,e,r){this.orientation=t,this.imagePath=e,this.action=r}return t.fromJson=function(e){var r=tb(er,e.orientation);if(!B.isNullOrUndefined(r)){var n=void 0;if(!(B.isNotNullOrUndefined(e.action)&&(n=eR.fromJson(e.action),B.isNullOrUndefined(n))))return new t(r,e.imagePath,n)}},t.prototype.toJson=function(){var t,e;return{orientation:this.orientation,imagePath:this.imagePath,action:null!==(e=null===(t=this.action)||void 0===t?void 0:t.toJson())&&void 0!==e?e:null}},t}(),eI=function(){function t(t){this.intervalMillis=t}return t.fromJson=function(e){var r=tb(tn,e.interval.timeUnit);if(r)return new t(ti.converter[r](e.interval.amount,"milliseconds"))},t.prototype.toJson=function(){return{interval:{timeUnit:"milliseconds",amount:this.intervalMillis}}},t}(),eN=function(){function t(t,e){this.title=t,this.body=e}return t.fromJson=function(e){return new t(e_.fromJson(e.title),e_.fromJson(e.body))},t.prototype.toJson=function(){return{title:{text:this.title.text,style:{textColor:this.title.style.color}},body:{text:this.body.text,style:{textColor:this.body.style.color}}}},t}(),e_=function(){function t(t,e){this.text=t,this.style=e}return t.fromJson=function(e){return new t(e.text,new eA(e.style.textColor))},t}(),eA=function(t){this.color=t},eO=function(){function t(t,e,r){this.text=t,this.style=e,this.action=r}return t.fromJson=function(e){var r=eR.fromJson(e.action);if(!B.isNullOrUndefined(r))return new t(e.text,new eP(e.style.textColor,e.style.bgColor,e.style.borderColor),r)},t.fromJson2=function(e){var r=eR.fromJson(e.action);if(!B.isNullOrUndefined(r))return new t("âœ•",new eP(e.style.color,"#FFFFFF","#FFFFFF"),r)},t.prototype.toJson=function(){return{text:this.text,action:this.action.toJson(),style:{textColor:this.style.textColor,bgColor:this.style.backgroundColor,borderColor:this.style.borderColor}}},t.prototype.toCloseButtonJson=function(){return{action:this.action.toJson(),style:{color:this.style.textColor}}},t}(),eM=function(){function t(t,e){this.button=t,this.alignment=e}return t.fromJson=function(e){var r=eO.fromJson(e.button);if(!B.isNullOrUndefined(r)){var n=eT.fromJson(e.alignment);if(!B.isNullOrUndefined(n))return new t(r,n)}},t.prototype.toJson=function(){return{button:this.button.toJson(),alignment:this.alignment.toJson()}},t}(),eP=function(t,e,r){this.textColor=t,this.backgroundColor=e,this.borderColor=r},eS=function(t){this.color=t},eR=function(){function t(t,e,r){this.behavior=t,this.type=e,this.value=r}return t.fromJson=function(e){var r,n=tb(en,e.behavior);if(!B.isNullOrUndefined(n)){var i=tb(ei,e.type);if(!B.isNullOrUndefined(i))return new t(n,i,null!==(r=e.value)&&void 0!==r?r:void 0)}},t.prototype.toJson=function(){var t;return{behavior:this.behavior,type:this.type,value:null!==(t=this.value)&&void 0!==t?t:null}},t}(),eU=function(){function t(t){this.atDeliverTime=t}return t.fromJson=function(e){return new t(e.atDeliverTime)},t}(),eC=function(){function t(t){this.durationMillis=t}return t.fromJson=function(e){var r=tb(tn,e.duration.timeUnit);return B.isNullOrUndefined(r)?null:new t(ti.converter[r](e.duration.amount,"milliseconds"))},t}(),ex=function(){function t(t,e){this.type=t,this.afterCondition=e}return t.fromJson=function(e){var r=e.afterCondition&&eC.fromJson(e.afterCondition);return new t(e.type,r)},t.immediate=function(){return new t("IMMEDIATE",null)},t.prototype.deliverAt=function(t){var e=this.type;switch(e){case"IMMEDIATE":return t;case"AFTER":if(null===this.afterCondition)throw Error("AfterCondition is required for AFTER delay type");return t+this.afterCondition.durationMillis;default:throw Error("Unsupported delay type: ".concat(e))}},t}(),ek=function(){function t(t,e,r){this.type=t,this.close=e,this.link=r}return t.fromJson=function(e){var r=e.type,n=e.value,i=this.linkActionTypes.some(function(t){return t===r}),o=this.closeActionTypes.some(function(t){return t===r}),s=this.tabTargetActionsTypes.some(function(t){return t===r}),u=this.windowTargetActionsTypes.some(function(t){return t===r});return new t(i?"LINK":"CLOSE",o?{hideDurationMillis:"HIDDEN"===r?864e5:null}:void 0,i?{url:null!=n?n:"",target:u?"NEW_WINDOW":s?"NEW_TAB":"CURRENT",shouldCloseAfterLink:o}:void 0)},t.fromInteraction=function(e){return"CLOSE"===e.type?new t(e.type,{hideDurationMillis:null}):t.fromJson(e.action)},t.fromAction=function(e){return t.fromJson(e.toJson())},t.linkActionTypes=["LINK_AND_CLOSE","LINK_NEW_TAB","LINK_NEW_TAB_AND_CLOSE","LINK_NEW_WINDOW","LINK_NEW_WINDOW_AND_CLOSE","WEB_LINK"],t.closeActionTypes=["CLOSE","HIDDEN","LINK_AND_CLOSE","LINK_NEW_TAB_AND_CLOSE","LINK_NEW_WINDOW_AND_CLOSE"],t.tabTargetActionsTypes=["LINK_NEW_TAB","LINK_NEW_TAB_AND_CLOSE"],t.windowTargetActionsTypes=["LINK_NEW_WINDOW","LINK_NEW_WINDOW_AND_CLOSE"],t}(),eD=function(t){this.id=t};(u||(u={})).MANUAL="MANUAL";var eL=function(){function t(t,e,r){this.needRedirect=t,this.redirectType=e,this.redirectUrl=r}return t.fromDto=function(e){var r;return new t(e.needRedirect,(r=e.properties.type,Object.values(u).includes(r))?e.properties.type:null,e.properties.value)},t}(),eF=function(){function t(t,e){this.includeTargets=t,this.excludeTargets=e}return t.fromJson=function(e){if(null!==e)return new t(H.mapNotNullOrUndefined(e.match,function(t){return tV.fromJson(t,t5.PROPERTY)}),H.mapNotNullOrUndefined(e.notMatch,function(t){return tV.fromJson(t,t5.PROPERTY)}))},t}(),eV=function(){function t(t,e,r){this.eventKey=t,this.property=e,this.stats=r}return t.fromJson=function(e){return new t(e.eventKey,e.property,e.stats)},t.prototype.countWithinDays=function(t){return H.sum(this.stats.filter(function(e){return e.date>=t}),function(t){return t.count})},t}(),eK=function(){function t(t){this.name=t,this._tags={},this.name=t}return t.prototype.tags=function(t){var e=this;return Object.entries(t).forEach(function(t){var r=t[0],n=t[1];e._tags[r]=n}),this},t.prototype.tag=function(t,e){return this._tags[t]=e,this},t.prototype.register=function(t){return t.registerTimer({name:this.name,tags:this._tags,type:"TIMER"})},t}(),eG=function(){function t(t){this._clock=t,this.startTime=this._clock.tick()}return t.start=function(e){return void 0===e&&(e=t.defaultClock),new t(e)},t.prototype.stop=function(t){var e=this._clock.tick()-this.startTime;t.record(e,"microseconds")},t.defaultClock=new to,t}(),eB=function(){function t(t){this.name=t,this._tags={}}return t.prototype.tags=function(t){var e=this;return Object.entries(t).forEach(function(t){var r=t[0],n=t[1];e._tags[r]=n}),this},t.prototype.tag=function(t,e){return this._tags[t]=e,this},t.prototype.register=function(t){return t.registerCounter({name:this.name,tags:this._tags,type:"COUNTER"})},t}(),eH=function(){function t(t){this.compareFn=t,this.data=new Map,this.compareFn=t,this.data=new Map}return t.prototype.values=function(){return Array.from(this.data.values())},t.prototype.keys=function(){return Array.from(this.data.keys())},t.prototype.get=function(t){var e=this,r=this.keys().find(function(r){return e.compareFn(r,t)});return r?this.data.get(r):void 0},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.add=function(t,e){var r=e;return r||(r=t),this.data.set(t,r),this},t.prototype.delete=function(t){if(this.has(t)){var e=this.get(t);return this.data.delete(t),e}},t.prototype.forEach=function(t){this.data.forEach(t)},t.prototype.filter=function(e){for(var r=new t(this.compareFn),n=0,i=this.entries();n<i.length;n++){var o=i[n];e(o[0],o[1])&&r.add(o[0],o[1])}return r},t.prototype.entries=function(){return Array.from(this.data.entries())},t}(),ej=function(){function t(t,e){this.valueSupplier=e,this.field=t}return Object.defineProperty(t.prototype,"value",{get:function(){return this.valueSupplier()},enumerable:!1,configurable:!0}),t}();function eJ(t,e){return t.name===e.name&&tt.isEquals(t.tags,e.tags)}var ez=function(){function t(){this.id=(0,K.Z)(),this.name="MetricRegistry",this._metrics=new eH(eJ)}return Object.defineProperty(t.prototype,"metrics",{get:function(){return Array.from(this._metrics.values())},enumerable:!1,configurable:!0}),t.prototype.registerCounter=function(t){return this.registerMetricIfNecessary(t,this.createCounter.bind(this))},t.prototype.registerTimer=function(t){return this.registerMetricIfNecessary(t,this.createTimer.bind(this))},t.prototype.counter=function(t,e){return void 0===e&&(e={}),new eB(t).tags(e).register(this)},t.prototype.timer=function(t,e){return void 0===e&&(e={}),new eK(t).tags(e).register(this)},t.prototype.registerMetricIfNecessary=function(t,e){return this.getOrCreateMetric(t,e)},t.prototype.getOrCreateMetric=function(t,e){var r,n=this._metrics.get(t);return n?r=n:(r=e(t),this._metrics.add(t,r)),r},t.prototype.close=function(){},t}(),eq=function(t){function e(e,r){var n=t.call(this)||this;return n.scheduler=e,n.pushIntervalMillis=r,n.publishingJob=null,n}return Y(e,t),e.prototype.start=function(){var t=this;null===this.publishingJob&&(this.publishingJob=this.scheduler.schedulePeriodically(this.pushIntervalMillis,this.pushIntervalMillis,function(){return t.publish(!1)}),J.log.debug("PushMetricRegistry started. Publish metrics every ".concat(this.pushIntervalMillis,"ms.")))},e.prototype.stop=function(){var t;null===(t=this.publishingJob)||void 0===t||t.cancel(),this.publishingJob=null,this.publish(!0),J.log.debug("PushMetricRegistry stopped.")},e.prototype.close=function(){this.stop()},e}(ez),eY=function(){function t(t){this.counterValue=0,this.id=t}return t.prototype.count=function(){return this.counterValue},t.prototype.increment=function(t){this.counterValue+=null!=t?t:1},t.prototype.measure=function(){return[new ej("count",this.count.bind(this))]},t}(),eW=function(){function t(t){this.id=t,this.currentCounter=new eY(t)}return t.prototype.flush=function(){var t=this.currentCounter;return this.currentCounter=new eY(this.id),t},t.prototype.count=function(){return this.currentCounter.count()},t.prototype.increment=function(t){this.currentCounter.increment(t)},t.prototype.measure=function(){return[new ej("count",this.count.bind(this))]},t}(),eX=function(){function t(t){this._count=0,this._total=0,this._max=0,this.id=t}return t.prototype.count=function(){return this._count},t.prototype.totalTime=function(t){return ti.nanosToUnit(this._total,t)},t.prototype.max=function(t){return ti.nanosToUnit(this._max,t)},t.prototype.mean=function(t){return 0===this.count()?0:this.totalTime(t)/this.count()},t.prototype.record=function(t,e){if(!(t<0)){var r=ti.converter[e](t,"nanoseconds");this._count=this.count()+1,this._total+=r,this._max=Math.max(r,this._max)}},t.prototype.measure=function(){var t=this;return[new ej("count",this.count.bind(this)),new ej("total",function(){return t.totalTime("milliseconds")}),new ej("max",function(){return t.max("milliseconds")}),new ej("mean",function(){return t.mean("milliseconds")})]},t}(),e$=function(){function t(t){this.id=t,this.currentTimer=new eX(t)}return t.prototype.flush=function(){var t=this.currentTimer;return this.currentTimer=new eX(this.id),t},t.prototype.count=function(){return this.currentTimer.count()},t.prototype.totalTime=function(t){return this.currentTimer.totalTime(t)},t.prototype.max=function(t){return this.currentTimer.max(t)},t.prototype.record=function(t,e){this.currentTimer.record(t,e)},t.prototype.mean=function(t){return 0===this.count()?0:this.totalTime(t)/this.count()},t.prototype.measure=function(){var t=this;return[new ej("count",this.count.bind(this)),new ej("total",function(){return t.totalTime("milliseconds")}),new ej("max",function(){return t.max("milliseconds")}),new ej("mean",function(){return t.mean("milliseconds")})]},t}(),eZ=function(t){function e(e,r){return t.call(this,e,r)||this}return Y(e,t),e.prototype.createCounter=function(t){return new eW(t)},e.prototype.createTimer=function(t){return new e$(t)},e.prototype.publish=function(t){void 0===t&&(t=!1);var e=this.metrics.reduce(function(t,e){return void 0!==e.flush&&"function"==typeof e.flush?t.concat(e.flush()):t},[]);this.flushMetrics(e,t)},e}(eq),eQ=function(){function t(t){this.id=t}return t.prototype.count=function(){return 0},t.prototype.increment=function(t){},t.prototype.measure=function(){return[new ej("count",this.count.bind(this))]},t}(),e0=function(){function t(t){this._counters=new eH(function(t,e){return t.id===e.id}),this.id=t,this.noopCounter=new eQ(t)}return Object.defineProperty(t.prototype,"counters",{get:function(){return Array.from(this._counters.values())},enumerable:!1,configurable:!0}),t.prototype.add=function(t){this._counters.add(t,t.registerCounter(this.id))},t.prototype.count=function(){return(this.counters[0]||this.noopCounter).count()},t.prototype.increment=function(t){this.counters.forEach(function(e){e.increment(t)})},t.prototype.measure=function(){return[new ej("count",this.count.bind(this))]},t}(),e1=function(){function t(t){this.id=t}return t.prototype.measure=function(){var t=this;return[new ej("count",this.count.bind(this)),new ej("total",function(){return t.totalTime("milliseconds")}),new ej("max",function(){return t.max("milliseconds")}),new ej("mean",function(){return t.mean("milliseconds")})]},t.prototype.count=function(){return 0},t.prototype.totalTime=function(t){return 0},t.prototype.max=function(t){return 0},t.prototype.mean=function(t){return 0},t.prototype.record=function(t,e){},t}(),e2=function(){function t(t){this._timers=new eH(function(t,e){return t.id===e.id}),this.id=t,this.noopTimer=new e1(t)}return Object.defineProperty(t.prototype,"firstTimer",{get:function(){return this.timers[0]||this.noopTimer},enumerable:!1,configurable:!0}),t.prototype.totalTime=function(t){return this.firstTimer.totalTime(t)},t.prototype.max=function(t){return this.firstTimer.max(t)},t.prototype.mean=function(t){return this.firstTimer.mean(t)},t.prototype.record=function(t,e){this.timers.forEach(function(r){r.record(t,e)})},Object.defineProperty(t.prototype,"timers",{get:function(){return Array.from(this._timers.values())},enumerable:!1,configurable:!0}),t.prototype.add=function(t){this._timers.add(t,t.registerTimer(this.id))},t.prototype.count=function(){return this.firstTimer.count()},t.prototype.measure=function(){var t=this;return[new ej("count",this.count.bind(this)),new ej("total",function(){return t.totalTime("milliseconds")}),new ej("max",function(){return t.max("milliseconds")}),new ej("mean",function(){return t.mean("milliseconds")})]},t}(),e4=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.registries=new eH(function(t,e){return t.id===e.id}),e}return Y(e,t),e.prototype.createCounter=function(t){var e=new e0(t);return this.addRegistry(e),e},e.prototype.createTimer=function(t){var e=new e2(t);return this.addRegistry(e),e},e.prototype.addRegistry=function(t){this.registries.forEach(function(e){return t.add(e)})},e.prototype.add=function(t){t instanceof e||this.registries.has(t)||(this.registries.add(t),this.metrics.forEach(function(e){void 0!==e.add&&"function"==typeof e.add&&e.add(t)}))},e.prototype.close=function(){this.registries.forEach(function(t){t.close()})},e}(ez),e3=function(){function t(){}return t.counter=function(e,r){return t.globalRegistry.counter(e,r)},t.timer=function(e,r){return t.globalRegistry.timer(e,r)},t.addRegistry=function(e){t.globalRegistry.add(e),J.log.debug("MetricRegistry added ".concat(e.name))},t.globalRegistry=new e4,t}(),e6=function(){function t(){}return t.equalsIgnoreCase=function(t,e){return t.toLowerCase()===e.toLowerCase()},t.isNotEmptyString=function(t){return!B.isNullOrUndefined(t)&&"string"==typeof t&&t.length>0},t}(),e5=function(){function t(t,e,r,n,i){this.url=t,this.method=e,this.body=r,this.headers=n,this.options=i}return t.builder=function(){return new e9},t.get=function(e){return t.builder().url(e).build()},t.prototype.toBuilder=function(){return new e9(this)},t}(),e9=function(){function t(t){var e,r,n,i,o,s,u;this._url=null!==(e=null==t?void 0:t.url)&&void 0!==e?e:null,this._method=null!==(r=null==t?void 0:t.method)&&void 0!==r?r:"GET",this._body=null!==(n=null==t?void 0:t.body)&&void 0!==n?n:null,this._headers=null!==(o=null===(i=null==t?void 0:t.headers)||void 0===i?void 0:i.toBuilder())&&void 0!==o?o:e7.builder(),this._timeoutMillis=null!==(u=null===(s=null==t?void 0:t.options)||void 0===s?void 0:s.timeoutMillis)&&void 0!==u?u:null}return t.prototype.url=function(t){return this._url=t,this},t.prototype.method=function(t){return this._method=t,this},t.prototype.body=function(t){return this._body=t,this},t.prototype.addHeader=function(t,e){return this._headers.add(t,e),this},t.prototype.timeoutMillis=function(t){return this._timeoutMillis=t,this},t.prototype.build=function(){if(null===this._url)throw Error("url is null");var t={timeoutMillis:this._timeoutMillis};return new e5(this._url,this._method,this._body,this._headers.build(),t)},t}(),e8=function(){function t(t,e,r){this.statusCode=t,this.body=e,this.headers=r}return t.ok=function(e,r){return t.of(200,e,r)},t.of=function(e,r,n){return new t(e,null!=r?r:null,null!=n?n:e7.empty())},t.prototype.isSuccessful=function(){return this.statusCode>=200&&this.statusCode<300},t.prototype.isClientError=function(){return this.statusCode>=400&&this.statusCode<500},t.prototype.isNotModified=function(){return 304===this.statusCode},t}(),e7=function(){function t(t){this.headers=t}return t.empty=function(){return new t(new Map)},t.builder=function(){return new rt(new Map)},t.prototype.get=function(t){for(var e=0,r=Array.from(this.headers.entries());e<r.length;e++){var n=r[e],i=n[0],o=n[1];if(e6.equalsIgnoreCase(i,t))return o}return null},t.prototype.getOrDefault=function(t,e){var r;return null!==(r=this.get(t))&&void 0!==r?r:e},t.prototype.raw=function(){return Array.from(this.headers.entries()).reduce(function(t,e){var r=e[0],n=e[1];return t[r]=n,t},{})},t.prototype.toBuilder=function(){return new rt(this.headers)},t.IF_MODIFIED_SINCE="If-Modified-Since",t.LAST_MODIFIED="Last-Modified",t.ACCEPT_ENCODING="Accept-Encoding",t}(),rt=function(){function t(t){this.headers=t}return t.prototype.add=function(t,e){return this.headers.set(t,e),this},t.prototype.build=function(){return new e7(this.headers)},t}(),re=function(t){function e(e,r,n,i,o){var s=t.call(this,i,o)||this;return s.url=e,s.transport=r,s.synchronousTransport=n,s.start(),s}return Y(e,t),e.prototype.flushMetrics=function(t,e){var r=this;H.chunked(t.filter(this.isDispatchTarget.bind(this)),100).forEach(function(t){r.dispatch(t,e)})},e.prototype.isDispatchTarget=function(t){return("COUNTER"===t.id.type||"TIMER"===t.id.type)&&t.count()>0},e.prototype.dispatch=function(t,e){var r=this.createRequest(t);this.execute(r,e).catch(function(t){return J.log.debug("Failed to flushing metrics: ".concat(t))})},e.prototype.createRequest=function(t){return e5.builder().url(this.url).method("POST").body(JSON.stringify(this.batch(t))).addHeader("Content-Type","application/json").build()},e.prototype.execute=function(t,e){return e?this.synchronousTransport.send(t):this.transport.send(t)},e.prototype.batch=function(t){return{metrics:t.map(function(t){return{name:t.id.name,type:t.id.type,tags:t.id.tags,measurements:B.fromMap(H.associate(t.measure(),function(t){return[t.field,t.value]}))}})}},e.prototype.onLifecycleChanged=function(t,e){switch(t){case"hidden":case"pagehide":return this.publish(!0);case"visible":case"pageshow":case"blur":case"locationChange":case"focus":return}},e}(eZ),rr=function(){function t(){}return t.experiment=function(t,e,r){var n=e3.timer("experiment.decision",{key:String(e),variation:r.variation,reason:String(r.reason)});t.stop(n)},t.featureFlag=function(t,e,r){var n=e3.timer("feature.flag.decision",{key:String(e),on:String(r.isOn),reason:String(r.reason)});t.stop(n)},t.remoteConfig=function(t,e,r){var n=e3.timer("remote.config.decision",{key:String(e),reason:String(r.reason)});t.stop(n)},t}(),rn=function(){function t(){}return t.record=function(e,r,n){var i=e3.timer("api.call",{operation:e,success:t.success(n)});r.stop(i)},t.success=function(t){return null===t?"false":String(t.isSuccessful()||t.isNotModified())},t}(),ri=function(){function t(){}return t.decide=function(t,e,r,n){if(B.isNullOrUndefined(r))return this.decision(t,e,"NULL",r,n);switch(typeof r){case"string":return this.decision(t,e,"STRING",r,n);case"number":return this.decision(t,e,"NUMBER",r,n);case"boolean":return this.decision(t,e,"BOOLEAN",r,n);default:return this.decision(t,e,"UNKNOWN",r,n)}},t.decision=function(t,e,r,n,i){return B.isNullOrUndefined(e)?tN.of(n,tM.INVALID_INPUT):t.remoteConfig(e,i,r,n)},t}(),ro=J.log,rs=function(){function t(t,e,r){this.core=t,this.userManager=e,this.user=r}return t.prototype.get=function(t,e){var r,n=eG.start();try{r=this.decide(t,e)}catch(n){ro.error("Unexpected exception while deciding remote config parameter[".concat(t,"]. Returning default value. : ").concat(n)),r=tN.of(e,tM.EXCEPTION)}return rr.remoteConfig(n,t,r),r.value},t.prototype.decide=function(t,e){var r=this.userManager.resolve(this.user);return ri.decide(this.core,t,e,r)},t}(),ru=function(){function t(){this._properties=new Map,this.MAX_PROPERTIES_COUNT=128,this.MAX_PROPERTY_KEY_LENGTH=128}return t.prototype.contains=function(t){return this._properties.has(t)},t.prototype.remove=function(t){var e=this;return t instanceof Map&&t.forEach(function(t,r){e.remove(r)}),"string"==typeof t&&this._properties.delete(t),this},t.prototype.compute=function(t,e){var r=this._properties.get(t),n=e(r);null!==n?this.add(t,n):(null!==r||this.contains(t))&&this.remove(t)},t.prototype.add=function(t,e,r){if(void 0===r&&(r=!1),r&&this.contains(t)||this._properties.size>=this.MAX_PROPERTIES_COUNT||"string"==typeof t&&t.length>this.MAX_PROPERTY_KEY_LENGTH)return this;var n=tr.sanitizeValue(t,e);return B.isNullOrUndefined(n)||this._properties.set(t,n),this},t.prototype.addProperties=function(t,e){var r=this;return void 0===e&&(e=!1),t.forEach(function(t,n){r.add(n,t,e)}),this},t.prototype.build=function(){return this._properties},t}();(n=a||(a={})).SET="$set",n.SET_ONCE="$setOnce",n.UNSET="$unset",n.INCREMENT="$increment",n.APPEND="$append",n.APPEND_ONCE="$appendOnce",n.PREPEND="$prepend",n.PREPEND_ONCE="$prependOnce",n.REMOVE="$remove",n.CLEAR_ALL="$clearAll";var ra=function(){function t(){}return t.prototype.operate=function(t,e){return 0===t.size?e:0===e.size?t:new ru().addProperties(t).addProperties(e).build()},t}(),rc=function(){function t(){}return t.prototype.operate=function(t,e){return 0===t.size?e:0===e.size?t:new ru().addProperties(t).addProperties(e,!0).build()},t}(),rp=function(){function t(){}return t.prototype.operate=function(t,e){return 0===t.size?new Map:0===e.size?t:new ru().addProperties(t).remove(e).build()},t}(),rl=function(){function t(){}return t.prototype.operate=function(t,e){var r=this;if(0===e.size)return t;var n=new ru;return n.addProperties(t),e.forEach(function(t,e){n.compute(e,function(e){return r.increment(e,t)})}),n.build()},t.prototype.increment=function(t,e){return"number"!=typeof e?t:"number"!=typeof t?null==t?e:t:t+e},t}(),rf=function(){function t(){}return t.prototype.operate=function(t,e){var r=this;if(0===e.size)return t;var n=new ru;return n.addProperties(t),e.forEach(function(t,e){n.compute(e,function(e){return r.compute(e,t)})}),n.build()},t.prototype.compute=function(t,e){var r=this.toArray(t),n=this.toArray(e);return this.operateArray(r,n)},t.prototype.toArray=function(t){return null==t?[]:Array.isArray(t)?t:[t]},t.prototype.contains=function(t,e){return t.includes(e)},t.prototype.prepend=function(t,e,r){return(void 0===r&&(r=!1),r&&this.contains(e,t))?e:Z([t],e,!0)},t.prototype.append=function(t,e,r){return(void 0===r&&(r=!1),r&&this.contains(t,e))?t:Z(Z([],t,!0),[e],!1)},t}(),rh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Y(e,t),e.prototype.operateArray=function(t,e){var r=this;return e.reduce(function(t,e){return r.append.bind(r)(t,e)},t)},e}(rf),rd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Y(e,t),e.prototype.operateArray=function(t,e){return e.reduce(this.appendOnce.bind(this),t)},e.prototype.appendOnce=function(t,e){return this.append(t,e,!0)},e}(rf),rv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Y(e,t),e.prototype.operateArray=function(t,e){var r=this;return e.reduceRight(function(t,e){return r.prepend.bind(r)(e,t)},t)},e}(rf),ry=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Y(e,t),e.prototype.operateArray=function(t,e){var r=this;return e.reduce(this.appendOnce.bind(this),[]).reduceRight(function(t,e){return r.prependOnce.bind(r)(e,t)},t)},e.prototype.appendOnce=function(t,e){return this.append(t,e,!0)},e.prototype.prependOnce=function(t,e){return this.prepend(t,e,!0)},e}(rf),rg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Y(e,t),e.prototype.operateArray=function(t,e){return e.reduce(this.remove.bind(this),t)},e.prototype.remove=function(t,e){return t.filter(function(t){return t!==e})},e}(rf),rm=function(){function t(){}return t.prototype.operate=function(t,e){return new Map},t}(),rE=function(){function t(){}return t.get=function(t){switch(t){case a.SET:return new ra;case a.SET_ONCE:return new rc;case a.UNSET:return new rp;case a.INCREMENT:return new rl;case a.APPEND:return new rh;case a.APPEND_ONCE:return new rd;case a.PREPEND:return new rv;case a.PREPEND_ONCE:return new ry;case a.CLEAR_ALL:return new rm;case a.REMOVE:return new rg}},t}(),rw=function(){function t(){this.operations=new Map}return t.prototype.set=function(t,e){return this.add(a.SET,t,e)},t.prototype.setOnce=function(t,e){return this.add(a.SET_ONCE,t,e)},t.prototype.unset=function(t){return this.add(a.UNSET,t,"-")},t.prototype.increment=function(t,e){return this.add(a.INCREMENT,t,e)},t.prototype.append=function(t,e){return this.add(a.APPEND,t,e)},t.prototype.appendOnce=function(t,e){return this.add(a.APPEND_ONCE,t,e)},t.prototype.prepend=function(t,e){return this.add(a.PREPEND,t,e)},t.prototype.prependOnce=function(t,e){return this.add(a.PREPEND_ONCE,t,e)},t.prototype.remove=function(t,e){return this.add(a.REMOVE,t,e)},t.prototype.clearAll=function(){return this.add(a.CLEAR_ALL,"clearAll","-")},t.prototype.build=function(){return new rT(new Map(Array.from(this.operations.entries()).map(function(t){return[t[0],t[1].build()]})))},t.prototype.containsKey=function(t){return Array.from(this.operations.entries()).some(function(e){return e[0],e[1].contains(t)})},t.prototype.add=function(t,e,r){if(this.containsKey(e))return this;this.operations.has(t)||this.operations.set(t,new ru);var n=this.operations.get(t);return null==n||n.add(e,r),this},t}(),rT=function(){function t(t){this.operations=null!=t?t:new Map}return t.prototype.operate=function(t){var e=t;return this.operations.forEach(function(t,r){e=rE.get(r).operate(e,t)}),e},t.prototype.toEvent=function(){var t={key:"$properties"};return this.operations.forEach(function(e,r){var n,i;t.properties=W(W({},t.properties),((n={})[r]=W(W({},null===(i=t.properties)||void 0===i?void 0:i[r]),tr.sanitize(B.fromMap(e))),n))}),t},t.prototype.toSecuredEvent=function(){var t={key:"$secured_properties"};return this.operations.forEach(function(e,r){var n,i;t.properties=W(W({},t.properties),((n={})[r]=W(W({},null===(i=t.properties)||void 0===i?void 0:i[r]),tr.sanitize(B.fromMap(e))),n))}),t},t.prototype.toRecord=function(){var t={};return this.operations.forEach(function(e,r){var n={};e.forEach(function(t,e){n[e]=t}),t[r]=n}),t},t}(),rb=function(){function t(){}return t.timeout=function(t,e){return new Promise(function(r,n){setTimeout(function(){return n(Error("timeout (".concat(e,"ms)")))},e),t.then(r,n)})},t}(),rI=function(){function t(t,e,r,n,i,o,s){void 0===t&&(t=""),void 0===e&&(e=""),void 0===r&&(r=""),void 0===n&&(n=""),void 0===i&&(i=""),void 0===o&&(o=""),void 0===s&&(s=""),this.pagePath=t,this.host=e,this.hostname=r,this.url=n,this.referrer=i,this.queryParameter=o,this.protocol=s}return t.prototype.isEquals=function(t){return this.url===t.url},Object.defineProperty(t.prototype,"pageTitle",{get:function(){return"undefined"==typeof window||"undefined"==typeof document?"":window.document.title},enumerable:!1,configurable:!0}),t.createWithCurrentPage=function(){return"undefined"==typeof window||"undefined"==typeof document?new t:new t(window.location.pathname,window.location.host,window.location.hostname,window.location.href,window.document.referrer,window.location.search,window.location.protocol)},t.prototype.toProperties=function(){return{pagePath:this.pagePath,pageTitle:this.pageTitle,host:this.host,url:this.url,referrer:this.referrer,queryParameter:this.queryParameter,protocol:this.protocol.replace(":","")}},t}(),rN=function(){function t(t){this.value=t}return t.create=function(e){return new t(e)},t.prototype.getValue=function(){return this.value},t}(),r_=function(){function t(){}return t.toPublic=function(t){return{key:t.key}},t}(),rA=function(){function t(){}return t.toPublic=function(t){return{close:t.close.bind(t),inAppMessage:r_.toPublic(t.context.inAppMessage)}},t}(),rO=J.log,rM=function(){function t(t,e,r,n,i,o,s,u,a){this.core=t,this.synchronizer=e,this.sessionManager=r,this.userManager=n,this.piiEventManager=i,this.fetchThrottler=o,this.pageEventTracker=s,this.inAppMessageUi=u,this.devTools=a,this.initialized=!1,this.initialize=this.initialize.bind(this),this.getSessionId=this.getSessionId.bind(this),this.getUser=this.getUser.bind(this),this.setUser=this.setUser.bind(this),this.setUserId=this.setUserId.bind(this),this.setDeviceId=this.setDeviceId.bind(this),this.setUserProperty=this.setUserProperty.bind(this),this.setUserProperties=this.setUserProperties.bind(this),this.updateUserProperties=this.updateUserProperties.bind(this),this.updatePushSubscriptions=this.updatePushSubscriptions.bind(this),this.updateSmsSubscriptions=this.updateSmsSubscriptions.bind(this),this.updateKakaoSubscriptions=this.updateKakaoSubscriptions.bind(this),this.resetUser=this.resetUser.bind(this),this.variation=this.variation.bind(this),this.variationDetail=this.variationDetail.bind(this),this.isFeatureOn=this.isFeatureOn.bind(this),this.featureFlagDetail=this.featureFlagDetail.bind(this),this.track=this.track.bind(this),this.trackPageView=this.trackPageView.bind(this),this.remoteConfig=this.remoteConfig.bind(this),this.onReady=this.onReady.bind(this),this.onInitialized=this.onInitialized.bind(this),this.showUserExplorer=this.showUserExplorer.bind(this),this.hideUserExplorer=this.hideUserExplorer.bind(this),this.fetch=this.fetch.bind(this),this.close=this.close.bind(this),this.setInAppMessageListener=this.setInAppMessageListener.bind(this),this.getExperiment=this.getExperiment.bind(this),this.setPhoneNumber=this.setPhoneNumber.bind(this),this.unsetPhoneNumber=this.unsetPhoneNumber.bind(this),this.getDisplayedInAppMessageView=this.getDisplayedInAppMessageView.bind(this),this.initialization=this.initialize()}return t.prototype.initialize=function(){return X(this,void 0,void 0,function(){var t;return $(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,3,4]),rO.debug("HackleClient initializing"),[4,this.synchronizer.sync()];case 1:return e.sent(),rO.debug("HackleClient initialized"),[3,4];case 2:throw t=e.sent(),rO.error("HackleClient initialize failed: ".concat(t)),t;case 3:return this.initialized=!0,[7];case 4:return[2]}})})},t.prototype.getSessionId=function(){return this.sessionManager.sessionId},t.prototype.getUser=function(){return this.userManager.currentUser},t.prototype.setUser=function(t){try{var e=tF(t);if(!e)return rO.warn("invalid user"),Promise.resolve();var r=this.userManager.setUser(e);return this.userManager.syncIfNeeded(r).catch(function(){})}catch(t){return rO.error("Unexpected exception while set user: ".concat(t)),Promise.resolve()}},t.prototype.setUserId=function(t){try{var e=void 0;if(B.isNullOrUndefined(t))e=this.userManager.setUserId(void 0);else{var r=tt.sanitizeValue(t);if(!r)return rO.warn("Invalid userId. [userId=".concat(t,"]")),Promise.resolve();e=this.userManager.setUserId(r)}return this.userManager.syncIfNeeded(e).catch(function(){})}catch(t){return rO.error("Unexpected exception while set userId: ".concat(t)),Promise.resolve()}},t.prototype.setDeviceId=function(t){try{var e=tt.sanitizeValue(t);if(!e)return rO.warn("Invalid deviceId. [deviceId=".concat(t,"]")),Promise.resolve();var r=this.userManager.setDeviceId(e);return this.userManager.syncIfNeeded(r).catch(function(){})}catch(t){return rO.error("Unexpected exception while set deviceId: ".concat(t)),Promise.resolve()}},t.prototype.setUserProperty=function(t,e){var r=new rw().set(t,e).build();return this.updateUserProperties(r)},t.prototype.setUserProperties=function(t){try{var e=tr.sanitize(t),r=new rw;return Object.entries(e).forEach(function(t){var e=t[0],n=t[1];r.set(e,n)}),this.updateUserProperties(r.build())}catch(t){return rO.error("Unexpected exception while set userProperties: ".concat(t)),Promise.resolve()}},t.prototype.updateUserProperties=function(t){try{var e=t.toEvent();return this.track(e),this.userManager.updateUserProperties(t),this.core.flush(!1),Promise.resolve()}catch(t){return rO.error("Unexpected exception while update userProperties: ".concat(t)),Promise.resolve()}},t.prototype.updatePushSubscriptions=function(t){try{var e=t.toEvent("$push_subscriptions");return this.track(e),this.core.flush(!1),Promise.resolve()}catch(t){return rO.error("Unexpected exception while update userProperties: ".concat(t)),Promise.resolve()}},t.prototype.updateSmsSubscriptions=function(t){try{var e=t.toEvent("$sms_subscriptions");return this.track(e),this.core.flush(!1),Promise.resolve()}catch(t){return rO.error("Unexpected exception while update userProperties: ".concat(t)),Promise.resolve()}},t.prototype.updateKakaoSubscriptions=function(t){try{var e=t.toEvent("$kakao_subscriptions");return this.track(e),this.core.flush(!1),Promise.resolve()}catch(t){return rO.error("Unexpected exception while update userProperties: ".concat(t)),Promise.resolve()}},t.prototype.resetUser=function(){try{var t=this.userManager.resetUser(),e=new rw().clearAll().build();return this.track(e.toEvent()),this.userManager.syncIfNeeded(t).catch(function(){})}catch(t){return rO.error("Unexpected exception while reset user: ".concat(t)),Promise.resolve()}},t.prototype.setPhoneNumber=function(t){try{if("string"!=typeof t)return rO.error("Invalid value ".concat(t,": phoneNumber value type must be string.")),Promise.resolve();var e=rN.create(t),r=to.instance.currentMillis();return this.piiEventManager.setPhoneNumber(e,r),this.core.flush(!1),Promise.resolve()}catch(t){return rO.error("Unexpected exception occurred while setting phone number: ".concat(t)),Promise.resolve()}},t.prototype.unsetPhoneNumber=function(){try{var t=to.instance.currentMillis();return this.piiEventManager.unsetPhoneNumber(t),this.core.flush(!1),Promise.resolve()}catch(t){return rO.error("Unexpected exception occurred while unsetting phone number: ".concat(t)),Promise.resolve()}},t.prototype.variation=function(t,e,r){return this.variationDetail(t,e,r).variation},t.prototype.variationDetail=function(t,e,r){var n=r||"A",i=eG.start(),o=function(r){try{var i=r.userManager.resolve(e);return r.core.experiment(t,i,n)}catch(e){return rO.error("Unexpected exception while deciding variation for experiment[".concat(t,"]. Returning default variation[").concat(n,"] : ").concat(e)),t_.of(n,tM.EXCEPTION)}}(this);return rr.experiment(i,t,o),o},t.prototype.isFeatureOn=function(t,e){return this.featureFlagDetail(t,e).isOn},t.prototype.featureFlagDetail=function(t,e){var r=eG.start(),n=function(r){try{var n=r.userManager.resolve(e);return r.core.featureFlag(t,n)}catch(e){return rO.error("Unexpected exception while deciding feature flag[".concat(t,"]. Returning default value[false] : ").concat(e)),tA.off(tM.EXCEPTION)}}(this);return rr.featureFlag(r,t,n),n},t.prototype.track=function(t,e){try{rO.debug("track event : ".concat(JSON.stringify(t)));var r=this._convertEvent(t),n=this.userManager.resolve(e);this.core.track(r,n)}catch(t){rO.error("Unexpected exception while tracking event: ".concat(t))}},t.prototype.trackPageView=function(t){var e=rI.createWithCurrentPage();this.pageEventTracker.track(e)},t.prototype.remoteConfig=function(t){return new rs(this.core,this.userManager,t)},t.prototype.onReady=function(t,e){void 0===e&&(e=3e3),this.onInitialized({timeout:e}).finally(function(){return t()})},t.prototype.getExperiment=function(t){try{return this.core.getExperiment(t)}catch(e){rO.error('"Unexpected exception while get experiment['.concat(t,"]"));return}},t.prototype.onInitialized=function(t){var e;return X(this,void 0,void 0,function(){var r;return $(this,function(n){switch(n.label){case 0:if(this.initialized)return[2,{success:!0}];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,rb.timeout(this.initialization,null!==(e=null==t?void 0:t.timeout)&&void 0!==e?e:3e3)];case 2:return n.sent(),[2,{success:!0}];case 3:return r=n.sent(),rO.error("Failed to onInitialized: ".concat(r)),[2,{success:!1}];case 4:return[2]}})})},t.prototype._convertEvent=function(t){return"string"==typeof t?{key:t}:t},t.prototype.showUserExplorer=function(){var t;if(!(null===(t=this.devTools)||void 0===t?void 0:t.userExplorer)){rO.error("UserExplorer is not provided");return}rO.debug("UserExplorer opened."),e3.counter("user.explorer.show",{}).increment(),this.devTools.manager.userExplorer(this.devTools.userExplorer)},t.prototype.hideUserExplorer=function(){if(!this.devTools){rO.warn("There is no active HackleDevtools.");return}this.devTools.manager.close()},t.prototype.fetch=function(){var t=this;return this.fetchThrottler.execute(function(){return t.synchronizer.sync()},function(){return Promise.resolve()})},t.prototype.setInAppMessageListener=function(t){this.inAppMessageUi.setListener(t)},t.prototype.getDisplayedInAppMessageView=function(){return this.inAppMessageUi.currentMessageView?rA.toPublic(this.inAppMessageUi.currentMessageView):null},t.prototype.close=function(){rO.debug("HackleClient closing"),this.core.close(),this.synchronizer.close()},t}(),rP=J.log,rS=function(){function t(t,e,r){this.invocationProcessor=t,this.user=e,this.browserPropertyProvider=r}return t.prototype.get=function(t,e){var r=typeof e;try{var n={command:"remoteConfig",parameters:{defaultValue:e,key:t,valueType:r,user:this.user},browserProperties:this.browserPropertyProvider.getBrowserProperties()},i=this.invocationProcessor.process(n);if(!i)throw Error("invoke result data not exists");switch(r){case"number":return Number(i);case"boolean":return!!i;default:return i}}catch(r){return rP.error("Unexpected exception while deciding remote config parameter[".concat(t,"]. Returning default value. : ").concat(r)),e}},t}(),rR=function(){function t(){}return t.tryParse=function(t){try{return new URL(t)}catch(t){return}},t.removePathnameTrailingSlash=function(e){var r=e instanceof URL?e:t.tryParse(e);return r?(r.pathname.endsWith("/")&&(r.pathname=r.pathname.replace(/\/+$/,"")),r.href):String(e)},t.tryDecodeURI=function(t){try{return decodeURI(t)}catch(t){return}},t.tryDecodeURIComponent=function(t){try{return decodeURIComponent(t)}catch(t){return}},t.decodeURIOrOriginal=function(t){try{return decodeURI(t)}catch(e){return t}},t.decodeURIComponentOrOriginal=function(t){try{return decodeURIComponent(t)}catch(e){return t}},t}(),rU=function(){function t(t){void 0===t&&(t={days:0,isCrossSubdomain:!1,isSecure:!1}),this.options=t}return t.extractDomain=function(t){var e=/[a-z0-9][a-z0-9-]+\.[a-z.]{2,6}$/i,r=t.split("."),n=r[r.length-1];(n.length>4||"com"===n||"org"===n)&&(e=/[a-z0-9][a-z0-9-]*\.[a-z]+$/i);var i=t.match(e);return i?i[0]:""},t.prototype.getItem=function(t){for(var e,r=t+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(r))return null!==(e=rR.tryDecodeURIComponent(o.substring(r.length,o.length)))&&void 0!==e?e:null}return null},t.prototype.getAllItem=function(t){var e=document.cookie.split("; ").map(function(t){return t.split("=")}),r=null==t?void 0:t.keyPrefix;return r?e.filter(function(t){var e=t[0];return t[1],e.startsWith(r)}):e},t.prototype.setItem=function(e,r,n){var i=W(W({},this.options),n),o="",s="",u="",a="";if(i.isCrossSubdomain){var c=t.extractDomain(document.location.hostname);o=c?"; domain=."+c:""}if(i.days){var p=new Date;p.setTime(p.getTime()+864e5*i.days),s="; expires="+p.toUTCString()}i.sameSite&&(a="; SameSite=".concat(i.sameSite)),i.isSecure&&(u+="; secure");var l=e+"="+encodeURIComponent(r)+s+"; path=/"+o+a+u;return document.cookie=l,l},t.prototype.removeItem=function(t,e){this.setItem(t,"",W(W({},e),{days:-1}))},t.prototype.getOptions=function(){return this.options},t.getInstance=function(e){return void 0===e&&(e={days:3650,isCrossSubdomain:!0}),t.storage||(t.storage=new t(e)),t.storage},t}(),rC=function(){function t(){}return t.prototype.initialize=function(){rU.getInstance().getItem(tf)||rD()},t.prototype.onLifecycleChanged=function(t,e){switch(t){case"hidden":case"pagehide":return rk();case"blur":case"focus":case"locationChange":case"visible":case"pageshow":return}},t}();function rx(){var t=rU.getInstance(),e=t.getItem(th);return e?e:t.getItem(tf)||rD()}function rk(){rU.getInstance().removeItem(th)}function rD(){var t=(0,K.Z)();return rU.getInstance().setItem(tf,t),t}var rL=J.log;(i=c||(c={})).native="native",i.web_view_wrapper="web_view_wrapper";var rF=function(){function t(t,e){this.invocationProcessor=t,this.browserPropertyProvider=e,this.getSessionId=this.getSessionId.bind(this),this.getUser=this.getUser.bind(this),this.setUser=this.setUser.bind(this),this.setUserId=this.setUserId.bind(this),this.setDeviceId=this.setDeviceId.bind(this),this.setUserProperty=this.setUserProperty.bind(this),this.setUserProperties=this.setUserProperties.bind(this),this.updateUserProperties=this.updateUserProperties.bind(this),this.updatePushSubscriptions=this.updatePushSubscriptions.bind(this),this.updateSmsSubscriptions=this.updateSmsSubscriptions.bind(this),this.updateKakaoSubscriptions=this.updateKakaoSubscriptions.bind(this),this.resetUser=this.resetUser.bind(this),this.variation=this.variation.bind(this),this.variationDetail=this.variationDetail.bind(this),this.isFeatureOn=this.isFeatureOn.bind(this),this.featureFlagDetail=this.featureFlagDetail.bind(this),this.track=this.track.bind(this),this.trackPageView=this.trackPageView.bind(this),this.remoteConfig=this.remoteConfig.bind(this),this.onReady=this.onReady.bind(this),this.onInitialized=this.onInitialized.bind(this),this.showUserExplorer=this.showUserExplorer.bind(this),this.hideUserExplorer=this.hideUserExplorer.bind(this),this.fetch=this.fetch.bind(this),this.close=this.close.bind(this),this.setInAppMessageListener=this.setInAppMessageListener.bind(this),this.getExperiment=this.getExperiment.bind(this),this.setPhoneNumber=this.setPhoneNumber.bind(this),this.unsetPhoneNumber=this.unsetPhoneNumber.bind(this),this.getDisplayedInAppMessageView=this.getDisplayedInAppMessageView.bind(this)}return t.prototype.getSessionId=function(){try{var t={command:"getSessionId",browserProperties:this.browserPropertyProvider.getBrowserProperties()},e=this.invocationProcessor.process(t);return null!=e?e:rx()}catch(t){return rL.error("Unexpected exception while get sessionId: ".concat(t)),rx()}},t.prototype.getUser=function(){var t;try{var e={command:"getUser",browserProperties:this.browserPropertyProvider.getBrowserProperties()},r=this.invocationProcessor.process(e);return null!==(t=tF(r))&&void 0!==t?t:this.defaultUser()}catch(t){return rL.error("Unexpected exception while get user: ".concat(t)),this.defaultUser()}},t.prototype.setUser=function(t){return X(this,void 0,void 0,function(){var e,r;return $(this,function(n){try{if(!(e=tF(t)))return rL.warn("invalid user"),[2];r={command:"setUser",parameters:{user:e},browserProperties:this.browserPropertyProvider.getBrowserProperties()},this.invocationProcessor.process(r)}catch(t){rL.error("Unexpected exception while set user: ".concat(t))}return[2]})})},t.prototype.setUserId=function(t){return X(this,void 0,void 0,function(){var e,r;return $(this,function(n){try{if(e=void 0,B.isNullOrUndefined(t))e=null;else if(!(e=tt.sanitizeValue(t)))return rL.warn("Invalid userId. [userId=".concat(t,"]")),[2];r={command:"setUserId",parameters:{userId:e},browserProperties:this.browserPropertyProvider.getBrowserProperties()},this.invocationProcessor.process(r)}catch(t){rL.error("Unexpected exception while set userId: ".concat(t))}return[2]})})},t.prototype.setDeviceId=function(t){return X(this,void 0,void 0,function(){var e,r;return $(this,function(n){try{if(!(e=tt.sanitizeValue(t)))return rL.warn("Invalid deviceId. [deviceId=".concat(t,"]")),[2];r={command:"setDeviceId",parameters:{deviceId:e},browserProperties:this.browserPropertyProvider.getBrowserProperties()},this.invocationProcessor.process(r)}catch(t){rL.error("Unexpected exception while set deviceId: ".concat(t))}return[2]})})},t.prototype.setUserProperty=function(t,e){return X(this,void 0,void 0,function(){var r;return $(this,function(n){try{r={command:"setUserProperty",parameters:{key:t,value:e},browserProperties:this.browserPropertyProvider.getBrowserProperties()},this.invocationProcessor.process(r)}catch(t){rL.error("Unexpected exception while set userProperty: ".concat(t))}return[2]})})},t.prototype.setUserProperties=function(t){return X(this,void 0,void 0,function(){var e,r;return $(this,function(n){try{e=tr.sanitize(t),r=new rw,Object.entries(e).forEach(function(t){var e=t[0],n=t[1];r.set(e,n)}),this.updateUserProperties(r.build())}catch(t){rL.error("Unexpected exception while set userProperties: ".concat(t))}return[2]})})},t.prototype.updateUserProperties=function(t){return X(this,void 0,void 0,function(){var e;return $(this,function(r){try{e={command:"updateUserProperties",parameters:{operations:t.toRecord()},browserProperties:this.browserPropertyProvider.getBrowserProperties()},this.invocationProcessor.process(e)}catch(t){rL.error("Unexpected exception while update userProperties: ".concat(t))}return[2]})})},t.prototype.updatePushSubscriptions=function(t){return X(this,void 0,void 0,function(){var e;return $(this,function(r){try{e={command:"updatePushSubscriptions",parameters:{operations:t.toRecord()},browserProperties:this.browserPropertyProvider.getBrowserProperties()},this.invocationProcessor.process(e)}catch(t){rL.error("Unexpected exception while update push subscriptions: ".concat(t))}return[2]})})},t.prototype.updateSmsSubscriptions=function(t){return X(this,void 0,void 0,function(){var e;return $(this,function(r){try{e={command:"updateSmsSubscriptions",parameters:{operations:t.toRecord()},browserProperties:this.browserPropertyProvider.getBrowserProperties()},this.invocationProcessor.process(e)}catch(t){rL.error("Unexpected exception while update sms subscriptions: ".concat(t))}return[2]})})},t.prototype.updateKakaoSubscriptions=function(t){return X(this,void 0,void 0,function(){var e;return $(this,function(r){try{e={command:"updateKakaoSubscriptions",parameters:{operations:t.toRecord()},browserProperties:this.browserPropertyProvider.getBrowserProperties()},this.invocationProcessor.process(e)}catch(t){rL.error("Unexpected exception while update Kakao subscriptions: ".concat(t))}return[2]})})},t.prototype.resetUser=function(){return X(this,void 0,void 0,function(){var t;return $(this,function(e){try{t={command:"resetUser",browserProperties:this.browserPropertyProvider.getBrowserProperties()},this.invocationProcessor.process(t)}catch(t){rL.error("Unexpected exception while reset user: ".concat(t))}return[2]})})},t.prototype.setPhoneNumber=function(t){return X(this,void 0,void 0,function(){var e;return $(this,function(r){try{if("string"!=typeof t)return rL.error("Invalid type ".concat(t,": phoneNumber value must be string.")),[2,Promise.resolve()];e={command:"setPhoneNumber",parameters:{phoneNumber:t},browserProperties:this.browserPropertyProvider.getBrowserProperties()},this.invocationProcessor.process(e)}catch(t){rL.error("Unexpected exception occurred while setting phone number: ".concat(t))}return[2]})})},t.prototype.unsetPhoneNumber=function(){return X(this,void 0,void 0,function(){var t;return $(this,function(e){try{t={command:"unsetPhoneNumber",browserProperties:this.browserPropertyProvider.getBrowserProperties()},this.invocationProcessor.process(t)}catch(t){rL.error("Unexpected exception occurred while unsetting phone number: ".concat(t))}return[2]})})},t.prototype.variation=function(t,e,r){void 0===r&&(r="A");try{var n={command:"variation",parameters:{experimentKey:t,defaultVariation:r,user:this.convertUser(e)},browserProperties:this.browserPropertyProvider.getBrowserProperties()},i=this.invocationProcessor.process(n);if(!i)throw Error("invoke result data not exists");return i}catch(e){return rL.error("Unexpected exception while deciding variation for experiment[".concat(t,"]. Returning default variation[").concat(r,"] : ").concat(e)),r}},t.prototype.variationDetail=function(t,e,r){var n;void 0===r&&(r="A");try{var i={command:"variationDetail",parameters:{experimentKey:t,defaultVariation:r,user:this.convertUser(e)},browserProperties:this.browserPropertyProvider.getBrowserProperties()},o=this.invocationProcessor.process(i);if(null===o)throw Error("invoke result data not exists");return t_.of(o.variation,o.reason,new tu(null!==(n=o.config.parameters)&&void 0!==n?n:{}))}catch(e){return rL.error("Unexpected exception while deciding variation for experiment[".concat(t,"]. Returning default variation[").concat(r,"] : ").concat(e)),t_.of(r,tM.EXCEPTION)}},t.prototype.isFeatureOn=function(t,e){try{var r={command:"isFeatureOn",parameters:{featureKey:t,user:this.convertUser(e)},browserProperties:this.browserPropertyProvider.getBrowserProperties()},n=this.invocationProcessor.process(r);if(null===n)throw Error("invoke result data not exists");return!!n}catch(e){return rL.error("Unexpected exception while deciding feature flag[".concat(t,"]. Returning default value[false] : ").concat(e)),!1}},t.prototype.featureFlagDetail=function(t,e){var r;try{var n={command:"featureFlagDetail",parameters:{featureKey:t,user:this.convertUser(e)},browserProperties:this.browserPropertyProvider.getBrowserProperties()},i=this.invocationProcessor.process(n);if(null===i)throw Error("invoke result data not exists");return new tA(i.isOn,i.reason,new tu(null!==(r=i.config.parameters)&&void 0!==r?r:{}),void 0)}catch(e){return rL.error("Unexpected exception while deciding feature flag[".concat(t,"]. Returning default value[false] : ").concat(e)),tA.off(tM.EXCEPTION)}},t.prototype.track=function(t,e){try{var r={command:"track",parameters:{event:this.convertEvent(t),user:this.convertUser(e)},browserProperties:this.browserPropertyProvider.getBrowserProperties()};this.invocationProcessor.process(r)}catch(t){rL.error("Unexpected exception while tracking event: ".concat(t))}},t.prototype.trackPageView=function(t){rL.info("Web to app integration feature is not support 'trackPageView' method")},t.prototype.remoteConfig=function(t){return new rS(this.invocationProcessor,this.convertUser(t),this.browserPropertyProvider)},t.prototype.onReady=function(t,e){t()},t.prototype.showUserExplorer=function(){try{var t={command:"showUserExplorer",browserProperties:this.browserPropertyProvider.getBrowserProperties()};this.invocationProcessor.process(t)}catch(t){rL.error("Unexpected exception while show userExplorer: ".concat(t))}},t.prototype.hideUserExplorer=function(){try{var t={command:"hideUserExplorer",browserProperties:this.browserPropertyProvider.getBrowserProperties()};this.invocationProcessor.process(t)}catch(t){rL.error("Unexpected exception while hide userExplorer: ".concat(t))}},t.prototype.setInAppMessageListener=function(t){rL.info("Web to app integration feature is not support 'setInAppMessageListener' method")},t.prototype.fetch=function(){return Promise.resolve()},t.prototype.onInitialized=function(t){return Promise.resolve({success:!0})},t.prototype.close=function(){rL.info("Web to app integration feature is not support 'close' method")},t.prototype.getExperiment=function(t){rL.info("Web to app integration feature is not support 'getExperiment' method")},t.prototype.convertEvent=function(t){return"string"==typeof t?{key:t}:t},t.prototype.convertUser=function(t){var e;return"string"==typeof t?t:t&&null!==(e=tF(t))&&void 0!==e?e:void 0},t.prototype.defaultUser=function(){return{deviceId:rx()}},t.prototype.getDisplayedInAppMessageView=function(){return rL.info("Web to app integration feature is not support 'getDisplayedInAppMessageView' method"),null},t}(),rV=function(){function t(t,e){this.browser=t,this.app=e,this.getSessionId=this.getSessionId.bind(this),this.getUser=this.getUser.bind(this),this.setUser=this.setUser.bind(this),this.setUserId=this.setUserId.bind(this),this.setDeviceId=this.setDeviceId.bind(this),this.setUserProperty=this.setUserProperty.bind(this),this.setUserProperties=this.setUserProperties.bind(this),this.updateUserProperties=this.updateUserProperties.bind(this),this.updatePushSubscriptions=this.updatePushSubscriptions.bind(this),this.updateSmsSubscriptions=this.updateSmsSubscriptions.bind(this),this.updateKakaoSubscriptions=this.updateKakaoSubscriptions.bind(this),this.resetUser=this.resetUser.bind(this),this.variation=this.variation.bind(this),this.variationDetail=this.variationDetail.bind(this),this.isFeatureOn=this.isFeatureOn.bind(this),this.featureFlagDetail=this.featureFlagDetail.bind(this),this.track=this.track.bind(this),this.trackPageView=this.trackPageView.bind(this),this.remoteConfig=this.remoteConfig.bind(this),this.onReady=this.onReady.bind(this),this.onInitialized=this.onInitialized.bind(this),this.showUserExplorer=this.showUserExplorer.bind(this),this.hideUserExplorer=this.hideUserExplorer.bind(this),this.fetch=this.fetch.bind(this),this.close=this.close.bind(this),this.setInAppMessageListener=this.setInAppMessageListener.bind(this),this.getExperiment=this.getExperiment.bind(this),this.setPhoneNumber=this.setPhoneNumber.bind(this),this.unsetPhoneNumber=this.unsetPhoneNumber.bind(this),this.getDisplayedInAppMessageView=this.getDisplayedInAppMessageView.bind(this)}return t.prototype.getSessionId=function(){return this.browser.getSessionId()},t.prototype.getUser=function(){return this.browser.getUser()},t.prototype.syncUser=function(){return X(this,void 0,void 0,function(){var t;return $(this,function(e){switch(e.label){case 0:return t=this.browser.getUser(),[4,this.app.setUser(t)];case 1:return e.sent(),[2]}})})},t.prototype.setUser=function(t){return X(this,void 0,void 0,function(){return $(this,function(e){switch(e.label){case 0:return[4,this.browser.setUser(t)];case 1:return e.sent(),[4,this.syncUser()];case 2:return e.sent(),[2]}})})},t.prototype.setUserId=function(t){return X(this,void 0,void 0,function(){return $(this,function(e){switch(e.label){case 0:return[4,this.browser.setUserId(t)];case 1:return e.sent(),[4,this.syncUser()];case 2:return e.sent(),[2]}})})},t.prototype.setDeviceId=function(t){return X(this,void 0,void 0,function(){return $(this,function(e){switch(e.label){case 0:return[4,this.browser.setDeviceId(t)];case 1:return e.sent(),[4,this.syncUser()];case 2:return e.sent(),[2]}})})},t.prototype.setUserProperty=function(t,e){return X(this,void 0,void 0,function(){return $(this,function(r){switch(r.label){case 0:return[4,this.browser.setUserProperty(t,e)];case 1:return r.sent(),[4,this.syncUser()];case 2:return r.sent(),[2]}})})},t.prototype.setUserProperties=function(t){return X(this,void 0,void 0,function(){return $(this,function(e){switch(e.label){case 0:return[4,this.browser.setUserProperties(t)];case 1:return e.sent(),[4,this.syncUser()];case 2:return e.sent(),[2]}})})},t.prototype.updateUserProperties=function(t){return X(this,void 0,void 0,function(){return $(this,function(e){switch(e.label){case 0:return[4,this.browser.updateUserProperties(t)];case 1:return e.sent(),[4,this.syncUser()];case 2:return e.sent(),[2]}})})},t.prototype.updatePushSubscriptions=function(t){return X(this,void 0,void 0,function(){return $(this,function(e){switch(e.label){case 0:return[4,this.browser.updatePushSubscriptions(t)];case 1:return e.sent(),[2]}})})},t.prototype.updateSmsSubscriptions=function(t){return X(this,void 0,void 0,function(){return $(this,function(e){switch(e.label){case 0:return[4,this.browser.updateSmsSubscriptions(t)];case 1:return e.sent(),[2]}})})},t.prototype.updateKakaoSubscriptions=function(t){return X(this,void 0,void 0,function(){return $(this,function(e){switch(e.label){case 0:return[4,this.browser.updateKakaoSubscriptions(t)];case 1:return e.sent(),[2]}})})},t.prototype.resetUser=function(){return X(this,void 0,void 0,function(){return $(this,function(t){switch(t.label){case 0:return[4,this.browser.resetUser()];case 1:return t.sent(),[4,this.syncUser()];case 2:return t.sent(),[2]}})})},t.prototype.setPhoneNumber=function(t){return X(this,void 0,void 0,function(){return $(this,function(e){switch(e.label){case 0:return[4,this.browser.setPhoneNumber(t)];case 1:return e.sent(),[4,this.syncUser()];case 2:return e.sent(),[2]}})})},t.prototype.unsetPhoneNumber=function(){return X(this,void 0,void 0,function(){return $(this,function(t){switch(t.label){case 0:return[4,this.browser.unsetPhoneNumber()];case 1:return t.sent(),[4,this.syncUser()];case 2:return t.sent(),[2]}})})},t.prototype.variation=function(t,e,r){return void 0===r&&(r="A"),this.browser.variation(t,e,r)},t.prototype.variationDetail=function(t,e,r){return void 0===r&&(r="A"),this.browser.variationDetail(t,e,r)},t.prototype.isFeatureOn=function(t,e){return this.browser.isFeatureOn(t,e)},t.prototype.featureFlagDetail=function(t,e){return this.browser.featureFlagDetail(t,e)},t.prototype.track=function(t,e){return this.browser.track(t,e)},t.prototype.trackPageView=function(t){return this.browser.trackPageView(t)},t.prototype.remoteConfig=function(t){return this.browser.remoteConfig(t)},t.prototype.onReady=function(t,e){this.browser.onReady(t,e)},t.prototype.showUserExplorer=function(){this.browser.showUserExplorer()},t.prototype.hideUserExplorer=function(){this.browser.hideUserExplorer()},t.prototype.fetch=function(){return this.browser.fetch()},t.prototype.onInitialized=function(t){return this.browser.onInitialized(t)},t.prototype.close=function(){this.browser.close()},t.prototype.setInAppMessageListener=function(t){this.browser.setInAppMessageListener(t)},t.prototype.getExperiment=function(t){return this.browser.getExperiment(t)},t.prototype.getDisplayedInAppMessageView=function(){return this.browser.getDisplayedInAppMessageView()},t}(),rK="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:{},rG=function(t){return t&&t.Math==Math&&t},rB=rG("object"==typeof globalThis&&globalThis)||rG("object"==typeof window&&window)||rG("object"==typeof self&&self)||rG("object"==typeof rK&&rK)||function(){return this}()||Function("return this")(),rH={},rj=function(t){try{return!!t()}catch(t){return!0}},rJ=!rj(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),rz=!rj(function(){var t=(function(){}).bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}),rq=Function.prototype.call,rY=rz?rq.bind(rq):function(){return rq.apply(rq,arguments)},rW={},rX={}.propertyIsEnumerable,r$=Object.getOwnPropertyDescriptor,rZ=r$&&!rX.call({1:2},1);rW.f=rZ?function(t){var e=r$(this,t);return!!e&&e.enumerable}:rX;var rQ=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},r0=Function.prototype,r1=r0.bind,r2=r0.call,r4=rz&&r1.bind(r2,r2),r3=rz?function(t){return t&&r4(t)}:function(t){return t&&function(){return r2.apply(t,arguments)}},r6=r3({}.toString),r5=r3("".slice),r9=function(t){return r5(r6(t),8,-1)},r8=Object,r7=r3("".split),nt=rj(function(){return!r8("z").propertyIsEnumerable(0)})?function(t){return"String"==r9(t)?r7(t,""):r8(t)}:r8,ne=TypeError,nr=function(t){if(void 0==t)throw ne("Can't call method on "+t);return t},nn=function(t){return nt(nr(t))},ni=function(t){return"function"==typeof t},no=function(t){return"object"==typeof t?null!==t:ni(t)},ns=function(t,e){var r;return arguments.length<2?ni(r=rB[t])?r:void 0:rB[t]&&rB[t][e]},nu=r3({}.isPrototypeOf),na=ns("navigator","userAgent")||"",nc=rB.process,np=rB.Deno,nl=nc&&nc.versions||np&&np.version,nf=nl&&nl.v8;nf&&(l=(p=nf.split("."))[0]>0&&p[0]<4?1:+(p[0]+p[1])),!l&&na&&(!(p=na.match(/Edge\/(\d+)/))||p[1]>=74)&&(p=na.match(/Chrome\/(\d+)/))&&(l=+p[1]);var nh=l,nd=!!Object.getOwnPropertySymbols&&!rj(function(){var t=Symbol();return!String(t)||!(Object(t) instanceof Symbol)||!Symbol.sham&&nh&&nh<41}),nv=nd&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ny=Object,ng=nv?function(t){return"symbol"==typeof t}:function(t){var e=ns("Symbol");return ni(e)&&nu(e.prototype,ny(t))},nm=String,nE=function(t){try{return nm(t)}catch(t){return"Object"}},nw=TypeError,nT=function(t){if(ni(t))return t;throw nw(nE(t)+" is not a function")},nb=function(t,e){var r=t[e];return null==r?void 0:nT(r)},nI=TypeError,nN={exports:{}},n_=Object.defineProperty,nA=function(t,e){try{n_(rB,t,{value:e,configurable:!0,writable:!0})}catch(r){rB[t]=e}return e},nO="__core-js_shared__",nM=rB[nO]||nA(nO,{});(nN.exports=function(t,e){return nM[t]||(nM[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.24.1",mode:"global",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.24.1/LICENSE",source:"https://github.com/zloirock/core-js"});var nP=Object,nS=function(t){return nP(nr(t))},nR=r3({}.hasOwnProperty),nU=Object.hasOwn||function(t,e){return nR(nS(t),e)},nC=0,nx=Math.random(),nk=r3(1..toString),nD=function(t){return"Symbol("+(void 0===t?"":t)+")_"+nk(++nC+nx,36)},nL=(0,nN.exports)("wks"),nF=rB.Symbol,nV=nF&&nF.for,nK=nv?nF:nF&&nF.withoutSetter||nD,nG=function(t){if(!nU(nL,t)||!(nd||"string"==typeof nL[t])){var e="Symbol."+t;nd&&nU(nF,t)?nL[t]=nF[t]:nv&&nV?nL[t]=nV(e):nL[t]=nK(e)}return nL[t]},nB=function(t,e){var r,n;if("string"===e&&ni(r=t.toString)&&!no(n=rY(r,t))||ni(r=t.valueOf)&&!no(n=rY(r,t))||"string"!==e&&ni(r=t.toString)&&!no(n=rY(r,t)))return n;throw nI("Can't convert object to primitive value")},nH=TypeError,nj=nG("toPrimitive"),nJ=function(t,e){if(!no(t)||ng(t))return t;var r,n=nb(t,nj);if(n){if(void 0===e&&(e="default"),!no(r=rY(n,t,e))||ng(r))return r;throw nH("Can't convert object to primitive value")}return void 0===e&&(e="number"),nB(t,e)},nz=function(t){var e=nJ(t,"string");return ng(e)?e:e+""},nq=rB.document,nY=no(nq)&&no(nq.createElement),nW=function(t){return nY?nq.createElement(t):{}},nX=!rJ&&!rj(function(){return 7!=Object.defineProperty(nW("div"),"a",{get:function(){return 7}}).a}),n$=Object.getOwnPropertyDescriptor;rH.f=rJ?n$:function(t,e){if(t=nn(t),e=nz(e),nX)try{return n$(t,e)}catch(t){}if(nU(t,e))return rQ(!rY(rW.f,t,e),t[e])};var nZ={},nQ=rJ&&rj(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),n0=String,n1=TypeError,n2=function(t){if(no(t))return t;throw n1(n0(t)+" is not an object")},n4=TypeError,n3=Object.defineProperty,n6=Object.getOwnPropertyDescriptor,n5="enumerable",n9="configurable",n8="writable";nZ.f=rJ?nQ?function(t,e,r){if(n2(t),e=nz(e),n2(r),"function"==typeof t&&"prototype"===e&&"value"in r&&n8 in r&&!r[n8]){var n=n6(t,e);n&&n[n8]&&(t[e]=r.value,r={configurable:n9 in r?r[n9]:n[n9],enumerable:n5 in r?r[n5]:n[n5],writable:!1})}return n3(t,e,r)}:n3:function(t,e,r){if(n2(t),e=nz(e),n2(r),nX)try{return n3(t,e,r)}catch(t){}if("get"in r||"set"in r)throw n4("Accessors not supported");return"value"in r&&(t[e]=r.value),t};var n7=rJ?function(t,e,r){return nZ.f(t,e,rQ(1,r))}:function(t,e,r){return t[e]=r,t},it={exports:{}},ie=Function.prototype,ir=rJ&&Object.getOwnPropertyDescriptor,ii=nU(ie,"name"),io=ii&&(!rJ||rJ&&ir(ie,"name").configurable),is={PROPER:ii&&"something"===(function(){}).name,CONFIGURABLE:io},iu=r3(Function.toString);ni(nM.inspectSource)||(nM.inspectSource=function(t){return iu(t)});var ia=nM.inspectSource,ic=rB.WeakMap,ip=ni(ic)&&/native code/.test(ia(ic)),il=(0,nN.exports)("keys"),ih=function(t){return il[t]||(il[t]=nD(t))},id={},iv="Object already initialized",iy=rB.TypeError,ig=rB.WeakMap;if(ip||nM.state){var im=nM.state||(nM.state=new ig),iE=r3(im.get),iw=r3(im.has),iT=r3(im.set);f=function(t,e){if(iw(im,t))throw new iy(iv);return e.facade=t,iT(im,t,e),e},h=function(t){return iE(im,t)||{}},d=function(t){return iw(im,t)}}else{var ib=ih("state");id[ib]=!0,f=function(t,e){if(nU(t,ib))throw new iy(iv);return e.facade=t,n7(t,ib,e),e},h=function(t){return nU(t,ib)?t[ib]:{}},d=function(t){return nU(t,ib)}}var iI=f,iN=h,i_=function(t){return function(e){var r;if(!no(e)||(r=h(e)).type!==t)throw iy("Incompatible receiver, "+t+" required");return r}},iA=is.CONFIGURABLE,iO=Object.defineProperty,iM=rJ&&!rj(function(){return 8!==iO(function(){},"length",{value:8}).length}),iP=String(String).split("String"),iS=it.exports=function(t,e,r){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!nU(t,"name")||iA&&t.name!==e)&&(rJ?iO(t,"name",{value:e,configurable:!0}):t.name=e),iM&&r&&nU(r,"arity")&&t.length!==r.arity&&iO(t,"length",{value:r.arity});try{r&&nU(r,"constructor")&&r.constructor?rJ&&iO(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var n,i=d(n=t)?h(n):f(n,{});return nU(i,"source")||(i.source=iP.join("string"==typeof e?e:"")),t};Function.prototype.toString=iS(function(){return ni(this)&&iN(this).source||ia(this)},"toString");var iR=it.exports,iU=function(t,e,r,n){n||(n={});var i=n.enumerable,o=void 0!==n.name?n.name:e;if(ni(r)&&iR(r,o,n),n.global)i?t[e]=r:nA(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch(t){}i?t[e]=r:nZ.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},iC={},ix=Math.ceil,ik=Math.floor,iD=Math.trunc||function(t){var e=+t;return(e>0?ik:ix)(e)},iL=function(t){var e=+t;return e!=e||0===e?0:iD(e)},iF=Math.max,iV=Math.min,iK=function(t,e){var r=iL(t);return r<0?iF(r+e,0):iV(r,e)},iG=Math.min,iB=function(t){var e;return(e=t.length)>0?iG(iL(e),9007199254740991):0},iH=function(t){return function(e,r,n){var i,o=nn(e),s=iB(o),u=iK(n,s);if(t&&r!=r){for(;s>u;)if((i=o[u++])!=i)return!0}else for(;s>u;u++)if((t||u in o)&&o[u]===r)return t||u||0;return!t&&-1}},ij={includes:iH(!0),indexOf:iH(!1)},iJ=ij.indexOf,iz=r3([].push),iq=function(t,e){var r,n=nn(t),i=0,o=[];for(r in n)!nU(id,r)&&nU(n,r)&&iz(o,r);for(;e.length>i;)nU(n,r=e[i++])&&(~iJ(o,r)||iz(o,r));return o},iY=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],iW=iY.concat("length","prototype");iC.f=Object.getOwnPropertyNames||function(t){return iq(t,iW)};var iX={};iX.f=Object.getOwnPropertySymbols;var i$=r3([].concat),iZ=ns("Reflect","ownKeys")||function(t){var e=iC.f(n2(t)),r=iX.f;return r?i$(e,r(t)):e},iQ=function(t,e,r){for(var n=iZ(e),i=nZ.f,o=rH.f,s=0;s<n.length;s++){var u=n[s];nU(t,u)||r&&nU(r,u)||i(t,u,o(e,u))}},i0=/#|\.prototype\./,i1=function(t,e){var r=i4[i2(t)];return r==i6||r!=i3&&(ni(e)?rj(e):!!e)},i2=i1.normalize=function(t){return String(t).replace(i0,".").toLowerCase()},i4=i1.data={},i3=i1.NATIVE="N",i6=i1.POLYFILL="P",i5=rH.f,i9=function(t,e){var r,n,i,o,s,u=t.target,a=t.global,c=t.stat;if(r=a?rB:c?rB[u]||nA(u,{}):(rB[u]||{}).prototype)for(n in e){if(o=e[n],i=t.dontCallGetSet?(s=i5(r,n))&&s.value:r[n],!i1(a?n:u+(c?".":"#")+n,t.forced)&&void 0!==i){if(typeof o==typeof i)continue;iQ(o,i)}(t.sham||i&&i.sham)&&n7(o,"sham",!0),iU(r,n,o,t)}},i8=!rj(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),i7=ih("IE_PROTO"),ot=Object,oe=ot.prototype,or=i8?ot.getPrototypeOf:function(t){var e=nS(t);if(nU(e,i7))return e[i7];var r=e.constructor;return ni(r)&&e instanceof r?r.prototype:e instanceof ot?oe:null},on=String,oi=TypeError,oo=function(t){if("object"==typeof t||ni(t))return t;throw oi("Can't set "+on(t)+" as a prototype")},os=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=r3(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return n2(r),oo(n),e?t(r,n):r.__proto__=n,r}}():void 0),ou={},oa=Object.keys||function(t){return iq(t,iY)};ou.f=rJ&&!nQ?Object.defineProperties:function(t,e){n2(t);for(var r,n=nn(e),i=oa(e),o=i.length,s=0;o>s;)nZ.f(t,r=i[s++],n[r]);return t};var oc=ns("document","documentElement"),op="prototype",ol="script",of=ih("IE_PROTO"),oh=function(){},od=function(t){return"<"+ol+">"+t+"</"+ol+">"},ov=function(t){t.write(od("")),t.close();var e=t.parentWindow.Object;return t=null,e},oy=function(){var t,e=nW("iframe");return e.style.display="none",oc.appendChild(e),e.src=String("java"+ol+":"),(t=e.contentWindow.document).open(),t.write(od("document.F=Object")),t.close(),t.F},og=function(){try{v=new ActiveXObject("htmlfile")}catch(t){}og="undefined"!=typeof document?document.domain&&v?ov(v):oy():ov(v);for(var t=iY.length;t--;)delete og[op][iY[t]];return og()};id[of]=!0;var om=Object.create||function(t,e){var r;return null!==t?(oh[op]=n2(t),r=new oh,oh[op]=null,r[of]=t):r=og(),void 0===e?r:ou.f(r,e)},oE=Error,ow=r3("".replace),oT=String(oE("zxcasd").stack),ob=/\n\s*at [^:]*:[^\n]*/,oI=ob.test(oT),oN=r3(r3.bind),o_=function(t,e){return nT(t),void 0===e?t:rz?oN(t,e):function(){return t.apply(e,arguments)}},oA={},oO=nG("iterator"),oM=Array.prototype,oP=function(t){return void 0!==t&&(oA.Array===t||oM[oO]===t)},oS=nG("toStringTag"),oR={};oR[oS]="z";var oU="[object z]"===String(oR),oC=nG("toStringTag"),ox=Object,ok="Arguments"==r9(function(){return arguments}()),oD=function(t,e){try{return t[e]}catch(t){}},oL=oU?r9:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=oD(e=ox(t),oC))?r:ok?r9(e):"Object"==(n=r9(e))&&ni(e.callee)?"Arguments":n},oF=nG("iterator"),oV=function(t){if(void 0!=t)return nb(t,oF)||nb(t,"@@iterator")||oA[oL(t)]},oK=TypeError,oG=function(t,e){var r=arguments.length<2?oV(t):e;if(nT(r))return n2(rY(r,t));throw oK(nE(t)+" is not iterable")},oB=function(t,e,r){var n,i;n2(t);try{if(!(n=nb(t,"return"))){if("throw"===e)throw r;return r}n=rY(n,t)}catch(t){i=!0,n=t}if("throw"===e)throw r;if(i)throw n;return n2(n),r},oH=TypeError,oj=function(t,e){this.stopped=t,this.result=e},oJ=oj.prototype,oz=function(t,e,r){var n,i,o,s,u,a,c,p=r&&r.that,l=!!(r&&r.AS_ENTRIES),f=!!(r&&r.IS_RECORD),h=!!(r&&r.IS_ITERATOR),d=!!(r&&r.INTERRUPTED),v=o_(e,p),y=function(t){return n&&oB(n,"normal",t),new oj(!0,t)},g=function(t){return l?(n2(t),d?v(t[0],t[1],y):v(t[0],t[1])):d?v(t,y):v(t)};if(f)n=t.iterator;else if(h)n=t;else{if(!(i=oV(t)))throw oH(nE(t)+" is not iterable");if(oP(i)){for(o=0,s=iB(t);s>o;o++)if((u=g(t[o]))&&nu(oJ,u))return u;return new oj(!1)}n=oG(t,i)}for(a=f?t.next:n.next;!(c=rY(a,n)).done;){try{u=g(c.value)}catch(t){oB(n,"throw",t)}if("object"==typeof u&&u&&nu(oJ,u))return u}return new oj(!1)},oq=String,oY=function(t){if("Symbol"===oL(t))throw TypeError("Cannot convert a Symbol value to a string");return oq(t)},oW=!rj(function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",rQ(1,7)),7!==t.stack)}),oX=function(t,e){if(oI&&"string"==typeof t&&!oE.prepareStackTrace)for(;e--;)t=ow(t,ob,"");return t},o$=function(t,e){no(e)&&"cause"in e&&n7(t,"cause",e.cause)},oZ=nG("toStringTag"),oQ=Error,o0=[].push,o1=function(t,e){var r,n=arguments.length>2?arguments[2]:void 0,i=nu(o2,this);os?r=os(new oQ,i?or(this):o2):n7(r=i?this:om(o2),oZ,"Error"),void 0!==e&&n7(r,"message",function(t,e){return void 0===t?arguments.length<2?"":e:oY(t)}(e)),oW&&n7(r,"stack",oX(r.stack,1)),o$(r,n);var o=[];return oz(t,o0,{that:o}),n7(r,"errors",o),r};os?os(o1,oQ):iQ(o1,oQ,{name:!0});var o2=o1.prototype=om(oQ.prototype,{constructor:rQ(1,o1),message:rQ(1,""),name:rQ(1,"AggregateError")});i9({global:!0,constructor:!0,arity:2},{AggregateError:o1});var o4=nZ.f,o3=nG("unscopables"),o6=Array.prototype;void 0==o6[o3]&&o4(o6,o3,{configurable:!0,value:om(null)});var o5=function(t){o6[o3][t]=!0},o9=nG("iterator"),o8=!1;[].keys&&("next"in(m=[].keys())?(g=or(or(m)))!==Object.prototype&&(y=g):o8=!0),(void 0==y||rj(function(){var t={};return y[o9].call(t)!==t}))&&(y={}),ni(y[o9])||iU(y,o9,function(){return this});var o7=y,st=o8,se=nZ.f,sr=nG("toStringTag"),sn=function(t,e,r){t&&!r&&(t=t.prototype),t&&!nU(t,sr)&&se(t,sr,{configurable:!0,value:e})},si=function(){return this},so=function(t,e,r,n){var i=e+" Iterator";return t.prototype=om(o7,{next:rQ(+!n,r)}),sn(t,i,!1),oA[i]=si,t},ss=is.PROPER,su=is.CONFIGURABLE,sa=nG("iterator"),sc="keys",sp="values",sl="entries",sf=function(){return this},sh=function(t,e,r,n,i,o,s){so(r,e,n);var u,a,c,p=function(t){if(t===i&&d)return d;if(!st&&t in f)return f[t];switch(t){case sc:case sp:case sl:return function(){return new r(this,t)}}return function(){return new r(this)}},l=!1,f=t.prototype,h=f[sa]||f["@@iterator"]||i&&f[i],d=!st&&h||p(i),v="Array"==e&&f.entries||h;if(v&&(u=or(v.call(new t)))!==Object.prototype&&u.next&&(or(u)===o7||(os?os(u,o7):ni(u[sa])||iU(u,sa,sf)),sn(u,e+" Iterator",!0)),ss&&i==sp&&h&&h.name!==sp&&(su?n7(f,"name",sp):(l=!0,d=function(){return rY(h,this)})),i){if(a={values:p(sp),keys:o?d:p(sc),entries:p(sl)},s)for(c in a)!st&&!l&&c in f||iU(f,c,a[c]);else i9({target:e,proto:!0,forced:st||l},a)}return f[sa]!==d&&iU(f,sa,d,{name:i}),oA[e]=d,a},sd=nZ.f,sv="Array Iterator",sy=i_(sv),sg=sh(Array,"Array",function(t,e){iI(this,{type:sv,target:nn(t),index:0,kind:e})},function(){var t=sy(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}},"values"),sm=oA.Arguments=oA.Array;if(o5("keys"),o5("values"),o5("entries"),rJ&&"values"!==sm.name)try{sd(sm,"name",{value:"values"})}catch(t){}oU||iU(Object.prototype,"toString",oU?({}).toString:function(){return"[object "+oL(this)+"]"},{unsafe:!0});var sE="process"==r9(rB.process),sw=nG("species"),sT=function(t){var e=ns(t),r=nZ.f;rJ&&e&&!e[sw]&&r(e,sw,{configurable:!0,get:function(){return this}})},sb=TypeError,sI=function(t,e){if(nu(e,t))return t;throw sb("Incorrect invocation")},sN=function(){},s_=[],sA=ns("Reflect","construct"),sO=/^\s*(?:class|function)\b/,sM=r3(sO.exec),sP=!sO.exec(sN),sS=function(t){if(!ni(t))return!1;try{return sA(sN,s_,t),!0}catch(t){return!1}},sR=function(t){if(!ni(t))return!1;switch(oL(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return sP||!!sM(sO,ia(t))}catch(t){return!0}};sR.sham=!0;var sU=!sA||rj(function(){var t;return sS(sS.call)||!sS(Object)||!sS(function(){t=!0})||t})?sR:sS,sC=TypeError,sx=function(t){if(sU(t))return t;throw sC(nE(t)+" is not a constructor")},sk=nG("species"),sD=function(t,e){var r,n=n2(t).constructor;return void 0===n||void 0==(r=n2(n)[sk])?e:sx(r)},sL=Function.prototype,sF=sL.apply,sV=sL.call,sK="object"==typeof Reflect&&Reflect.apply||(rz?sV.bind(sF):function(){return sV.apply(sF,arguments)}),sG=r3([].slice),sB=TypeError,sH=/(?:ipad|iphone|ipod).*applewebkit/i.test(na),sj=function(t,e){if(t<e)throw sB("Not enough arguments");return t},sJ=rB.setImmediate,sz=rB.clearImmediate,sq=rB.process,sY=rB.Dispatch,sW=rB.Function,sX=rB.MessageChannel,s$=rB.String,sZ=0,sQ={},s0="onreadystatechange";try{E=rB.location}catch(t){}var s1=function(t){if(nU(sQ,t)){var e=sQ[t];delete sQ[t],e()}},s2=function(t){return function(){s1(t)}},s4=function(t){s1(t.data)},s3=function(t){rB.postMessage(s$(t),E.protocol+"//"+E.host)};sJ&&sz||(sJ=function(t){sj(arguments.length,1);var e=ni(t)?t:sW(t),r=sG(arguments,1);return sQ[++sZ]=function(){sK(e,void 0,r)},w(sZ),sZ},sz=function(t){delete sQ[t]},sE?w=function(t){sq.nextTick(s2(t))}:sY&&sY.now?w=function(t){sY.now(s2(t))}:sX&&!sH?(b=(T=new sX).port2,T.port1.onmessage=s4,w=o_(b.postMessage,b)):rB.addEventListener&&ni(rB.postMessage)&&!rB.importScripts&&E&&"file:"!==E.protocol&&!rj(s3)?(w=s3,rB.addEventListener("message",s4,!1)):w=s0 in nW("script")?function(t){oc.appendChild(nW("script"))[s0]=function(){oc.removeChild(this),s1(t)}}:function(t){setTimeout(s2(t),0)});var s6=sJ,s5=/ipad|iphone|ipod/i.test(na)&&void 0!==rB.Pebble,s9=/web0s(?!.*chrome)/i.test(na),s8=rH.f,s7=s6,ut=rB.MutationObserver||rB.WebKitMutationObserver,ue=rB.document,ur=rB.process,un=rB.Promise,ui=s8(rB,"queueMicrotask"),uo=ui&&ui.value;uo||(I=function(){var t,e;for(sE&&(t=ur.domain)&&t.exit();N;){e=N.fn,N=N.next;try{e()}catch(t){throw N?A():_=void 0,t}}_=void 0,t&&t.enter()},sH||sE||s9||!ut||!ue?!s5&&un&&un.resolve?((P=un.resolve(void 0)).constructor=un,S=o_(P.then,P),A=function(){S(I)}):sE?A=function(){ur.nextTick(I)}:(s7=o_(s7,rB),A=function(){s7(I)}):(O=!0,M=ue.createTextNode(""),new ut(I).observe(M,{characterData:!0}),A=function(){M.data=O=!O}));var us=uo||function(t){var e={fn:t,next:void 0};_&&(_.next=e),N||(N=e,A()),_=e},uu=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},ua=function(){this.head=null,this.tail=null};ua.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var uc=rB.Promise,up="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,ul=!up&&!sE&&"object"==typeof window&&"object"==typeof document;uc&&uc.prototype;var uf=nG("species"),uh=!1,ud=ni(rB.PromiseRejectionEvent),uv={CONSTRUCTOR:i1("Promise",function(){var t=ia(uc),e=t!==String(uc);if(!e&&66===nh)return!0;if(!nh||nh<51||!/native code/.test(t)){var r=new uc(function(t){t(1)}),n=function(t){t(function(){},function(){})};if((r.constructor={})[uf]=n,!(uh=r.then(function(){}) instanceof n))return!0}return!e&&(ul||up)&&!ud}),REJECTION_EVENT:ud,SUBCLASSING:uh},uy={},ug=function(t){var e,r;this.promise=new t(function(t,n){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=n}),this.resolve=nT(e),this.reject=nT(r)};uy.f=function(t){return new ug(t)};var um=function(t,e){var r=rB.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,e))},uE="Promise",uw=uv.CONSTRUCTOR,uT=uv.REJECTION_EVENT,ub=uv.SUBCLASSING,uI=i_(uE),uN=uc&&uc.prototype,u_=uc,uA=uN,uO=rB.TypeError,uM=rB.document,uP=rB.process,uS=uy.f,uR=uS,uU=!!(uM&&uM.createEvent&&rB.dispatchEvent),uC="unhandledrejection",ux=function(t){var e;return!!(no(t)&&ni(e=t.then))&&e},uk=function(t,e){var r,n,i,o=e.value,s=1==e.state,u=s?t.ok:t.fail,a=t.resolve,c=t.reject,p=t.domain;try{u?(s||(2===e.rejection&&uK(e),e.rejection=1),!0===u?r=o:(p&&p.enter(),r=u(o),p&&(p.exit(),i=!0)),r===t.promise?c(uO("Promise-chain cycle")):(n=ux(r))?rY(n,r,a,c):a(r)):c(o)}catch(t){p&&!i&&p.exit(),c(t)}},uD=function(t,e){t.notified||(t.notified=!0,us(function(){for(var r,n=t.reactions;r=n.get();)uk(r,t);t.notified=!1,e&&!t.rejection&&uF(t)}))},uL=function(t,e,r){var n,i;uU?((n=uM.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),rB.dispatchEvent(n)):n={promise:e,reason:r},!uT&&(i=rB["on"+t])?i(n):t===uC&&um("Unhandled promise rejection",r)},uF=function(t){rY(s6,rB,function(){var e,r=t.facade,n=t.value;if(uV(t)&&(e=uu(function(){sE?uP.emit("unhandledRejection",n,r):uL(uC,r,n)}),t.rejection=sE||uV(t)?2:1,e.error))throw e.value})},uV=function(t){return 1!==t.rejection&&!t.parent},uK=function(t){rY(s6,rB,function(){var e=t.facade;sE?uP.emit("rejectionHandled",e):uL("rejectionhandled",e,t.value)})},uG=function(t,e,r){return function(n){t(e,n,r)}},uB=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,uD(t,!0))},uH=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw uO("Promise can't be resolved itself");var n=ux(e);n?us(function(){var r={done:!1};try{rY(n,e,uG(uH,r,t),uG(uB,r,t))}catch(e){uB(r,e,t)}}):(t.value=e,t.state=1,uD(t,!1))}catch(e){uB({done:!1},e,t)}}};if(uw&&(uA=(u_=function(t){sI(this,uA),nT(t),rY(R,this);var e=uI(this);try{t(uG(uH,e),uG(uB,e))}catch(t){uB(e,t)}}).prototype,(R=function(t){iI(this,{type:uE,done:!1,notified:!1,parent:!1,reactions:new ua,rejection:!1,state:0,value:void 0})}).prototype=iU(uA,"then",function(t,e){var r=uI(this),n=uS(sD(this,u_));return r.parent=!0,n.ok=!ni(t)||t,n.fail=ni(e)&&e,n.domain=sE?uP.domain:void 0,0==r.state?r.reactions.add(n):us(function(){uk(n,r)}),n.promise}),U=function(){var t=new R,e=uI(t);this.promise=t,this.resolve=uG(uH,e),this.reject=uG(uB,e)},uy.f=uS=function(t){return t===u_||t===C?new U(t):uR(t)},ni(uc)&&uN!==Object.prototype)){x=uN.then,ub||iU(uN,"then",function(t,e){var r=this;return new u_(function(t,e){rY(x,r,t,e)}).then(t,e)},{unsafe:!0});try{delete uN.constructor}catch(t){}os&&os(uN,uA)}i9({global:!0,constructor:!0,wrap:!0,forced:uw},{Promise:u_}),sn(u_,uE,!1),sT(uE);var uj=nG("iterator"),uJ=!1;try{var uz=0,uq={next:function(){return{done:!!uz++}},return:function(){uJ=!0}};uq[uj]=function(){return this},Array.from(uq,function(){throw 2})}catch(t){}var uY=function(t,e){if(!e&&!uJ)return!1;var r=!1;try{var n={};n[uj]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r},uW=uv.CONSTRUCTOR||!uY(function(t){uc.all(t).then(void 0,function(){})});i9({target:"Promise",stat:!0,forced:uW},{all:function(t){var e=this,r=uy.f(e),n=r.resolve,i=r.reject,o=uu(function(){var r=nT(e.resolve),o=[],s=0,u=1;oz(t,function(t){var a=s++,c=!1;u++,rY(r,e,t).then(function(t){!c&&(c=!0,o[a]=t,--u||n(o))},i)}),--u||n(o)});return o.error&&i(o.value),r.promise}});var uX=uv.CONSTRUCTOR,u$=uc&&uc.prototype;if(i9({target:"Promise",proto:!0,forced:uX,real:!0},{catch:function(t){return this.then(void 0,t)}}),ni(uc)){var uZ=ns("Promise").prototype.catch;u$.catch!==uZ&&iU(u$,"catch",uZ,{unsafe:!0})}i9({target:"Promise",stat:!0,forced:uW},{race:function(t){var e=this,r=uy.f(e),n=r.reject,i=uu(function(){var i=nT(e.resolve);oz(t,function(t){rY(i,e,t).then(r.resolve,n)})});return i.error&&n(i.value),r.promise}}),i9({target:"Promise",stat:!0,forced:uv.CONSTRUCTOR},{reject:function(t){var e=uy.f(this);return rY(e.reject,void 0,t),e.promise}});var uQ=function(t,e){if(n2(t),no(e)&&e.constructor===t)return e;var r=uy.f(t);return(0,r.resolve)(e),r.promise},u0=uv.CONSTRUCTOR;ns("Promise"),i9({target:"Promise",stat:!0,forced:u0},{resolve:function(t){return uQ(this,t)}}),i9({target:"Promise",stat:!0},{allSettled:function(t){var e=this,r=uy.f(e),n=r.resolve,i=r.reject,o=uu(function(){var r=nT(e.resolve),i=[],o=0,s=1;oz(t,function(t){var u=o++,a=!1;s++,rY(r,e,t).then(function(t){!a&&(a=!0,i[u]={status:"fulfilled",value:t},--s||n(i))},function(t){!a&&(a=!0,i[u]={status:"rejected",reason:t},--s||n(i))})}),--s||n(i)});return o.error&&i(o.value),r.promise}});var u1="No one promise resolved";i9({target:"Promise",stat:!0},{any:function(t){var e=this,r=ns("AggregateError"),n=uy.f(e),i=n.resolve,o=n.reject,s=uu(function(){var n=nT(e.resolve),s=[],u=0,a=1,c=!1;oz(t,function(t){var p=u++,l=!1;a++,rY(n,e,t).then(function(t){l||c||(c=!0,i(t))},function(t){!l&&!c&&(l=!0,s[p]=t,--a||o(new r(s,u1)))})}),--a||o(new r(s,u1))});return s.error&&o(s.value),n.promise}});var u2=uc&&uc.prototype;if(i9({target:"Promise",proto:!0,real:!0,forced:!!uc&&rj(function(){u2.finally.call({then:function(){}},function(){})})},{finally:function(t){var e=sD(this,ns("Promise")),r=ni(t);return this.then(r?function(r){return uQ(e,t()).then(function(){return r})}:t,r?function(r){return uQ(e,t()).then(function(){throw r})}:t)}}),ni(uc)){var u4=ns("Promise").prototype.finally;u2.finally!==u4&&iU(u2,"finally",u4,{unsafe:!0})}var u3=r3("".charAt),u6=r3("".charCodeAt),u5=r3("".slice),u9=function(t){return function(e,r){var n,i,o=oY(nr(e)),s=iL(r),u=o.length;return s<0||s>=u?t?"":void 0:(n=u6(o,s))<55296||n>56319||s+1===u||(i=u6(o,s+1))<56320||i>57343?t?u3(o,s):n:t?u5(o,s,s+2):(n-55296<<10)+(i-56320)+65536}},u8={codeAt:u9(!1),charAt:u9(!0)}.charAt,u7="String Iterator",at=i_(u7);sh(String,"String",function(t){iI(this,{type:u7,string:oY(t),index:0})},function(){var t,e=at(this),r=e.string,n=e.index;return n>=r.length?{value:void 0,done:!0}:(t=u8(r,n),e.index+=t.length,{value:t,done:!1})}),rB.Promise;var ae=nW("span").classList,ar=ae&&ae.constructor&&ae.constructor.prototype,an=ar===Object.prototype?void 0:ar,ai={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},ao=nG("iterator"),as=nG("toStringTag"),au=sg.values,aa=function(t,e){if(t){if(t[ao]!==au)try{n7(t,ao,au)}catch(e){t[ao]=au}if(t[as]||n7(t,as,e),ai[e]){for(var r in sg)if(t[r]!==sg[r])try{n7(t,r,sg[r])}catch(e){t[r]=sg[r]}}}};for(var ac in ai)aa(rB[ac]&&rB[ac].prototype,ac);aa(an,"DOMTokenList"),i9({target:"Promise",stat:!0,forced:!0},{try:function(t){var e=uy.f(this),r=uu(t);return(r.error?e.reject:e.resolve)(r.value),e.promise}});var ap=function(t,e,r){var n=nz(e);n in t?nZ.f(t,n,rQ(0,r)):t[n]=r},al=function(t,e,r,n){try{return n?e(n2(r)[0],r[1]):e(r)}catch(e){oB(t,"throw",e)}},af=Array;i9({target:"Array",stat:!0,forced:!uY(function(t){Array.from(t)})},{from:function(t){var e,r,n,i,o,s,u=nS(t),a=sU(this),c=arguments.length,p=c>1?arguments[1]:void 0,l=void 0!==p;l&&(p=o_(p,c>2?arguments[2]:void 0));var f=oV(u),h=0;if(f&&!(this===af&&oP(f)))for(o=(i=oG(u,f)).next,r=a?new this:[];!(n=rY(o,i)).done;h++)s=l?al(i,p,[n.value,h],!0):n.value,ap(r,h,s);else for(e=iB(u),r=a?new this(e):af(e);e>h;h++)s=l?p(u[h],h):u[h],ap(r,h,s);return r.length=h,r}});var ah=Array.isArray||function(t){return"Array"==r9(t)};i9({target:"Array",stat:!0},{isArray:ah});var ad=Array;i9({target:"Array",stat:!0,forced:rj(function(){function t(){}return!(ad.of.call(t) instanceof t)})},{of:function(){for(var t=0,e=arguments.length,r=new(sU(this)?this:ad)(e);e>t;)ap(r,t,arguments[t++]);return r.length=e,r}}),i9({target:"Array",proto:!0},{at:function(t){var e=nS(this),r=iB(e),n=iL(t),i=n>=0?n:r+n;return i<0||i>=r?void 0:e[i]}}),o5("at");var av=TypeError,ay=function(t){if(t>9007199254740991)throw av("Maximum allowed index exceeded");return t},ag=nG("species"),am=Array,aE=function(t){var e;return ah(t)&&(sU(e=t.constructor)&&(e===am||ah(e.prototype))?e=void 0:no(e)&&null===(e=e[ag])&&(e=void 0)),void 0===e?am:e},aw=function(t,e){return new(aE(t))(0===e?0:e)},aT=nG("species"),ab=function(t){return nh>=51||!rj(function(){var e=[];return(e.constructor={})[aT]=function(){return{foo:1}},1!==e[t](Boolean).foo})},aI=nG("isConcatSpreadable"),aN=nh>=51||!rj(function(){var t=[];return t[aI]=!1,t.concat()[0]!==t}),a_=ab("concat"),aA=function(t){if(!no(t))return!1;var e=t[aI];return void 0!==e?!!e:ah(t)};i9({target:"Array",proto:!0,arity:1,forced:!aN||!a_},{concat:function(t){var e,r,n,i,o,s=nS(this),u=aw(s,0),a=0;for(e=-1,n=arguments.length;e<n;e++)if(o=-1===e?s:arguments[e],aA(o))for(ay(a+(i=iB(o))),r=0;r<i;r++,a++)r in o&&ap(u,a,o[r]);else ay(a+1),ap(u,a++,o);return u.length=a,u}});var aO=TypeError,aM=function(t,e){if(!delete t[e])throw aO("Cannot delete property "+nE(e)+" of "+nE(t))},aP=Math.min;i9({target:"Array",proto:!0},{copyWithin:[].copyWithin||function(t,e){var r=nS(this),n=iB(r),i=iK(t,n),o=iK(e,n),s=arguments.length>2?arguments[2]:void 0,u=aP((void 0===s?n:iK(s,n))-o,n-i),a=1;for(o<i&&i<o+u&&(a=-1,o+=u-1,i+=u-1);u-- >0;)o in r?r[i]=r[o]:aM(r,i),i+=a,o+=a;return r}}),o5("copyWithin");var aS=r3([].push),aR=function(t){var e=1==t,r=2==t,n=3==t,i=4==t,o=6==t,s=7==t,u=5==t||o;return function(a,c,p,l){for(var f,h,d=nS(a),v=nt(d),y=o_(c,p),g=iB(v),m=0,E=l||aw,w=e?E(a,g):r||s?E(a,0):void 0;g>m;m++)if((u||m in v)&&(h=y(f=v[m],m,d),t)){if(e)w[m]=h;else if(h)switch(t){case 3:return!0;case 5:return f;case 6:return m;case 2:aS(w,f)}else switch(t){case 4:return!1;case 7:aS(w,f)}}return o?-1:n||i?i:w}},aU={forEach:aR(0),map:aR(1),filter:aR(2),some:aR(3),every:aR(4),find:aR(5),findIndex:aR(6),filterReject:aR(7)},aC=function(t,e){var r=[][t];return!!r&&rj(function(){r.call(null,e||function(){return 1},1)})},ax=aU.every;i9({target:"Array",proto:!0,forced:!aC("every")},{every:function(t){return ax(this,t,arguments.length>1?arguments[1]:void 0)}}),i9({target:"Array",proto:!0},{fill:function(t){for(var e=nS(this),r=iB(e),n=arguments.length,i=iK(n>1?arguments[1]:void 0,r),o=n>2?arguments[2]:void 0,s=void 0===o?r:iK(o,r);s>i;)e[i++]=t;return e}}),o5("fill");var ak=aU.filter;i9({target:"Array",proto:!0,forced:!ab("filter")},{filter:function(t){return ak(this,t,arguments.length>1?arguments[1]:void 0)}});var aD=aU.find,aL="find",aF=!0;aL in[]&&[,][aL](function(){aF=!1}),i9({target:"Array",proto:!0,forced:aF},{find:function(t){return aD(this,t,arguments.length>1?arguments[1]:void 0)}}),o5(aL);var aV=aU.findIndex,aK="findIndex",aG=!0;aK in[]&&[,][aK](function(){aG=!1}),i9({target:"Array",proto:!0,forced:aG},{findIndex:function(t){return aV(this,t,arguments.length>1?arguments[1]:void 0)}}),o5(aK);var aB=function(t){var e=1==t;return function(r,n,i){for(var o,s=nS(r),u=nt(s),a=o_(n,i),c=iB(u);c-- >0;)if(a(o=u[c],c,s))switch(t){case 0:return o;case 1:return c}return e?-1:void 0}},aH={findLast:aB(0),findLastIndex:aB(1)},aj=aH.findLast;i9({target:"Array",proto:!0},{findLast:function(t){return aj(this,t,arguments.length>1?arguments[1]:void 0)}}),o5("findLast");var aJ=aH.findLastIndex;i9({target:"Array",proto:!0},{findLastIndex:function(t){return aJ(this,t,arguments.length>1?arguments[1]:void 0)}}),o5("findLastIndex");var az=function(t,e,r,n,i,o,s,u){for(var a,c,p=i,l=0,f=!!s&&o_(s,u);l<n;)l in r&&(a=f?f(r[l],l,e):r[l],o>0&&ah(a)?(c=iB(a),p=az(t,e,a,c,p,o-1)-1):(ay(p+1),t[p]=a),p++),l++;return p};i9({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,e=nS(this),r=iB(e),n=aw(e,0);return n.length=az(n,e,e,r,0,void 0===t?1:iL(t)),n}}),i9({target:"Array",proto:!0},{flatMap:function(t){var e,r=nS(this),n=iB(r);return nT(t),(e=aw(r,0)).length=az(e,r,r,n,0,1,t,arguments.length>1?arguments[1]:void 0),e}});var aq=aU.forEach,aY=aC("forEach")?[].forEach:function(t){return aq(this,t,arguments.length>1?arguments[1]:void 0)};i9({target:"Array",proto:!0,forced:[].forEach!=aY},{forEach:aY});var aW=ij.includes;i9({target:"Array",proto:!0,forced:rj(function(){return![,].includes()})},{includes:function(t){return aW(this,t,arguments.length>1?arguments[1]:void 0)}}),o5("includes");var aX=ij.indexOf,a$=r3([].indexOf),aZ=!!a$&&1/a$([1],1,-0)<0,aQ=aC("indexOf");i9({target:"Array",proto:!0,forced:aZ||!aQ},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return aZ?a$(this,t,e)||0:aX(this,t,e)}});var a0=r3([].join),a1=aC("join",",");i9({target:"Array",proto:!0,forced:nt!=Object||!a1},{join:function(t){return a0(nn(this),void 0===t?",":t)}});var a2=Math.min,a4=[].lastIndexOf,a3=!!a4&&1/[1].lastIndexOf(1,-0)<0,a6=aC("lastIndexOf"),a5=a3||!a6?function(t){if(a3)return sK(a4,this,arguments)||0;var e=nn(this),r=iB(e),n=r-1;for(arguments.length>1&&(n=a2(n,iL(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return -1}:a4;i9({target:"Array",proto:!0,forced:a5!==[].lastIndexOf},{lastIndexOf:a5});var a9=aU.map;i9({target:"Array",proto:!0,forced:!ab("map")},{map:function(t){return a9(this,t,arguments.length>1?arguments[1]:void 0)}});var a8=rj(function(){return 4294967297!==[].push.call({length:4294967296},1)}),a7=!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}();i9({target:"Array",proto:!0,arity:1,forced:a8||a7},{push:function(t){var e=nS(this),r=iB(e),n=arguments.length;ay(r+n);for(var i=0;i<n;i++)e[r]=arguments[i],r++;return e.length=r,r}});var ct=TypeError,ce=function(t){return function(e,r,n,i){nT(r);var o=nS(e),s=nt(o),u=iB(o),a=t?u-1:0,c=t?-1:1;if(n<2)for(;;){if(a in s){i=s[a],a+=c;break}if(a+=c,t?a<0:u<=a)throw ct("Reduce of empty array with no initial value")}for(;t?a>=0:u>a;a+=c)a in s&&(i=r(i,s[a],a,o));return i}},cr={left:ce(!1),right:ce(!0)},cn=cr.left;i9({target:"Array",proto:!0,forced:!aC("reduce")||!sE&&nh>79&&nh<83},{reduce:function(t){var e=arguments.length;return cn(this,t,e,e>1?arguments[1]:void 0)}});var ci=cr.right;i9({target:"Array",proto:!0,forced:!aC("reduceRight")||!sE&&nh>79&&nh<83},{reduceRight:function(t){return ci(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}});var co=r3([].reverse),cs=[1,2];i9({target:"Array",proto:!0,forced:String(cs)===String(cs.reverse())},{reverse:function(){return ah(this)&&(this.length=this.length),co(this)}});var cu=ab("slice"),ca=nG("species"),cc=Array,cp=Math.max;i9({target:"Array",proto:!0,forced:!cu},{slice:function(t,e){var r,n,i,o=nn(this),s=iB(o),u=iK(t,s),a=iK(void 0===e?s:e,s);if(ah(o)&&(sU(r=o.constructor)&&(r===cc||ah(r.prototype))?r=void 0:no(r)&&null===(r=r[ca])&&(r=void 0),r===cc||void 0===r))return sG(o,u,a);for(i=0,n=new(void 0===r?cc:r)(cp(a-u,0));u<a;u++,i++)u in o&&ap(n,i,o[u]);return n.length=i,n}});var cl=aU.some;i9({target:"Array",proto:!0,forced:!aC("some")},{some:function(t){return cl(this,t,arguments.length>1?arguments[1]:void 0)}});var cf=Array,ch=Math.max,cd=function(t,e,r){for(var n=iB(t),i=iK(e,n),o=iK(void 0===r?n:r,n),s=cf(ch(o-i,0)),u=0;i<o;i++,u++)ap(s,u,t[i]);return s.length=u,s},cv=Math.floor,cy=function(t,e){var r=t.length,n=cv(r/2);return r<8?cg(t,e):cm(t,cy(cd(t,0,n),e),cy(cd(t,n),e),e)},cg=function(t,e){for(var r,n,i=t.length,o=1;o<i;){for(n=o,r=t[o];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==o++&&(t[n]=r)}return t},cm=function(t,e,r,n){for(var i=e.length,o=r.length,s=0,u=0;s<i||u<o;)t[s+u]=s<i&&u<o?0>=n(e[s],r[u])?e[s++]:r[u++]:s<i?e[s++]:r[u++];return t},cE=na.match(/firefox\/(\d+)/i),cw=!!cE&&+cE[1],cT=/MSIE|Trident/.test(na),cb=na.match(/AppleWebKit\/(\d+)\./),cI=!!cb&&+cb[1],cN=[],c_=r3(cN.sort),cA=r3(cN.push),cO=rj(function(){cN.sort(void 0)}),cM=rj(function(){cN.sort(null)}),cP=aC("sort"),cS=!rj(function(){if(nh)return nh<70;if(!cw||!(cw>3)){if(cT)return!0;if(cI)return cI<603;var t,e,r,n,i="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)cN.push({k:e+n,v:r})}for(cN.sort(function(t,e){return e.v-t.v}),n=0;n<cN.length;n++)e=cN[n].k.charAt(0),i.charAt(i.length-1)!==e&&(i+=e);return"DGBEFHACIJK"!==i}});i9({target:"Array",proto:!0,forced:cO||!cM||!cP||!cS},{sort:function(t){void 0!==t&&nT(t);var e,r,n=nS(this);if(cS)return void 0===t?c_(n):c_(n,t);var i=[],o=iB(n);for(r=0;r<o;r++)r in n&&cA(i,n[r]);for(cy(i,function(e,r){return void 0===r?-1:void 0===e?1:void 0!==t?+t(e,r)||0:oY(e)>oY(r)?1:-1}),e=i.length,r=0;r<e;)n[r]=i[r++];for(;r<o;)aM(n,r++);return n}}),sT("Array");var cR=ab("splice"),cU=Math.max,cC=Math.min;i9({target:"Array",proto:!0,forced:!cR},{splice:function(t,e){var r,n,i,o,s,u,a=nS(this),c=iB(a),p=iK(t,c),l=arguments.length;for(0===l?r=n=0:1===l?(r=0,n=c-p):(r=l-2,n=cC(cU(iL(e),0),c-p)),ay(c+r-n),i=aw(a,n),o=0;o<n;o++)(s=p+o)in a&&ap(i,o,a[s]);if(i.length=n,r<n){for(o=p;o<c-n;o++)s=o+n,u=o+r,s in a?a[u]=a[s]:aM(a,u);for(o=c;o>c-n+r;o--)aM(a,o-1)}else if(r>n)for(o=c-n;o>p;o--)s=o+n-1,u=o+r-1,s in a?a[u]=a[s]:aM(a,u);for(o=0;o<r;o++)a[o+p]=arguments[o+2];return a.length=c-n+r,i}}),o5("flat"),o5("flatMap");var cx=1!==[].unshift(0),ck=!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}();i9({target:"Array",proto:!0,arity:1,forced:cx||ck},{unshift:function(t){var e=nS(this),r=iB(e),n=arguments.length;if(n){ay(r+n);for(var i=r;i--;){var o=i+n;i in e?e[o]=e[i]:aM(e,o)}for(var s=0;s<n;s++)e[s]=arguments[s]}return e.length=r+n}}),rB.Array;var cD={exports:{}},cL={},cF=iC.f,cV="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],cK=function(t){try{return cF(t)}catch(t){return cd(cV)}};cL.f=function(t){return cV&&"Window"==r9(t)?cK(t):cF(nn(t))};var cG=rj(function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}),cB=Object.isExtensible,cH=rj(function(){cB(1)})||cG?function(t){return!!no(t)&&(!cG||"ArrayBuffer"!=r9(t))&&(!cB||cB(t))}:cB,cj=!rj(function(){return Object.isExtensible(Object.preventExtensions({}))}),cJ=nZ.f,cz=!1,cq=nD("meta"),cY=0,cW=function(t){cJ(t,cq,{value:{objectID:"O"+cY++,weakData:{}}})},cX=cD.exports={enable:function(){cX.enable=function(){},cz=!0;var t=iC.f,e=r3([].splice),r={};r[cq]=1,t(r).length&&(iC.f=function(r){for(var n=t(r),i=0,o=n.length;i<o;i++)if(n[i]===cq){e(n,i,1);break}return n},i9({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:cL.f}))},fastKey:function(t,e){if(!no(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!nU(t,cq)){if(!cH(t))return"F";if(!e)return"E";cW(t)}return t[cq].objectID},getWeakData:function(t,e){if(!nU(t,cq)){if(!cH(t))return!0;if(!e)return!1;cW(t)}return t[cq].weakData},onFreeze:function(t){return cj&&cz&&cH(t)&&!nU(t,cq)&&cW(t),t}};id[cq]=!0;var c$=cD.exports,cZ=function(t,e,r){var n,i;return os&&ni(n=e.constructor)&&n!==r&&no(i=n.prototype)&&i!==r.prototype&&os(t,i),t},cQ=function(t,e,r){for(var n in e)iU(t,n,e[n],r);return t},c0=nZ.f,c1=cD.exports.fastKey;!function(t,e,r){var n=-1!=="Map".indexOf("Map"),i=-1!=="Map".indexOf("Weak"),o=n?"set":"add",s=rB.Map,u=s&&s.prototype,a=s,c={},p=function(t){var e=r3(u[t]);iU(u,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return(!i||!!no(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return i&&!no(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return(!i||!!no(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if(i1(t,!ni(s)||!(i||u.forEach&&!rj(function(){new s().entries().next()}))))a=r.getConstructor(e,t,n,o),c$.enable();else if(i1(t,!0)){var l=new a,f=l[o](i?{}:-0,1)!=l,h=rj(function(){l.has(1)}),d=uY(function(t){new s(t)}),v=!i&&rj(function(){for(var t=new s,e=5;e--;)t[o](e,e);return!t.has(-0)});d||((a=e(function(t,e){sI(t,u);var r=cZ(new s,t,a);return void 0!=e&&oz(e,r[o],{that:r,AS_ENTRIES:n}),r})).prototype=u,u.constructor=a),(h||v)&&(p("delete"),p("has"),n&&p("get")),(v||f)&&p(o),i&&u.clear&&delete u.clear}c[t]=a,i9({global:!0,constructor:!0,forced:a!=s},c),sn(a,t),i||r.setStrong(a,t,n)}("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},{getConstructor:function(t,e,r,n){var i=t(function(t,i){sI(t,o),iI(t,{type:e,index:om(null),first:void 0,last:void 0,size:0}),rJ||(t.size=0),void 0!=i&&oz(i,t[n],{that:t,AS_ENTRIES:r})}),o=i.prototype,s=i_(e),u=function(t,e,r){var n,i,o=s(t),u=a(t,e);return u?u.value=r:(o.last=u={index:i=c1(e,!0),key:e,value:r,previous:n=o.last,next:void 0,removed:!1},o.first||(o.first=u),n&&(n.next=u),rJ?o.size++:t.size++,"F"!==i&&(o.index[i]=u)),t},a=function(t,e){var r,n=s(t),i=c1(e);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key==e)return r};return cQ(o,{clear:function(){for(var t=s(this),e=t.index,r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete e[r.index],r=r.next;t.first=t.last=void 0,rJ?t.size=0:this.size=0},delete:function(t){var e=s(this),r=a(this,t);if(r){var n=r.next,i=r.previous;delete e.index[r.index],r.removed=!0,i&&(i.next=n),n&&(n.previous=i),e.first==r&&(e.first=n),e.last==r&&(e.last=i),rJ?e.size--:this.size--}return!!r},forEach:function(t){for(var e,r=s(this),n=o_(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!a(this,t)}}),cQ(o,r?{get:function(t){var e=a(this,t);return e&&e.value},set:function(t,e){return u(this,0===t?0:t,e)}}:{add:function(t){return u(this,t=0===t?0:t,t)}}),rJ&&c0(o,"size",{get:function(){return s(this).size}}),i},setStrong:function(t,e,r){var n=e+" Iterator",i=i_(e),o=i_(n);sh(t,e,function(t,e){iI(this,{type:n,target:t,state:i(t),kind:e,last:void 0})},function(){for(var t=o(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?"keys"==e?{value:r.key,done:!1}:"values"==e?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})},r?"entries":"values",!r,!0),sT(e)}});var c2=function(t,e){for(var r=0,n=iB(e),i=new t(n);n>r;)i[r]=e[r++];return i},c4=Array,c3=r3([].push),c6=function(t,e,r,n){for(var i,o,s,u=nS(t),a=nt(u),c=o_(e,r),p=om(null),l=iB(a),f=0;l>f;f++)(o=nz(c(s=a[f],f,u)))in p?c3(p[o],s):p[o]=[s];if(n&&(i=n(u))!==c4)for(o in p)p[o]=c2(i,p[o]);return p};i9({target:"Array",proto:!0},{group:function(t){var e=arguments.length>1?arguments[1]:void 0;return c6(this,t,e)}}),o5("group"),i9({target:"Array",proto:!0,forced:!aC("groupBy")},{groupBy:function(t){var e=arguments.length>1?arguments[1]:void 0;return c6(this,t,e)}}),o5("groupBy");var c5=ns("Map"),c9=c5.prototype,c8=r3(c9.get),c7=r3(c9.has),pt=r3(c9.set),pe=r3([].push),pr=function(t){for(var e,r,n=nS(this),i=nt(n),o=o_(t,arguments.length>1?arguments[1]:void 0),s=new c5,u=iB(i),a=0;u>a;a++)c7(s,e=o(r=i[a],a,n))?pe(c8(s,e),r):pt(s,e,[r]);return s};i9({target:"Array",proto:!0,name:"groupToMap",forced:!aC("groupByToMap")},{groupByToMap:pr}),o5("groupByToMap"),i9({target:"Array",proto:!0},{groupToMap:pr}),o5("groupToMap");var pn=function(t,e){for(var r=iB(t),n=new e(r),i=0;i<r;i++)n[i]=t[r-i-1];return n},pi=Array;i9({target:"Array",proto:!0},{toReversed:function(){return pn(nn(this),pi)}}),o5("toReversed");var po=function(t){return rB[t].prototype},ps=Array,pu=r3(po("Array").sort);i9({target:"Array",proto:!0},{toSorted:function(t){return void 0!==t&&nT(t),pu(c2(ps,nn(this)),t)}}),o5("toSorted");var pa=Array,pc=Math.max,pp=Math.min;i9({target:"Array",proto:!0},{toSpliced:function(t,e){var r,n,i,o,s=nn(this),u=iB(s),a=iK(t,u),c=arguments.length,p=0;for(0===c?r=n=0:1===c?(r=0,n=u-a):(r=c-2,n=pp(pc(iL(e),0),u-a)),o=pa(i=ay(u+r-n));p<a;p++)o[p]=s[p];for(;p<a+r;p++)o[p]=arguments[p-a+2];for(;p<i;p++)o[p]=s[p+n-r];return o}}),o5("toSpliced");var pl=RangeError,pf=function(t,e,r,n){var i=iB(t),o=iL(r),s=o<0?i+o:o;if(s>=i||s<0)throw pl("Incorrect index");for(var u=new e(i),a=0;a<i;a++)u[a]=a===s?n:t[a];return u},ph=Array;i9({target:"Array",proto:!0},{with:function(t,e){return pf(nn(this),ph,t,e)}});var pd="USE_FUNCTION_CONSTRUCTOR",pv=nG("asyncIterator"),py=rB.AsyncIterator,pg=nM.AsyncIteratorPrototype;if(pg)k=pg;else if(ni(py))k=py.prototype;else if(nM[pd]||rB[pd])try{D=or(or(or(Function("return async function*(){}()")()))),or(D)===Object.prototype&&(k=D)}catch(t){}k||(k={}),ni(k[pv])||iU(k,pv,function(){return this});var pm=k,pE=ns("Promise"),pw="AsyncFromSyncIterator",pT=i_(pw),pb=function(t,e,r){var n=t.done;pE.resolve(t.value).then(function(t){e({done:n,value:t})},r)},pI=function(t){iI(this,{type:pw,iterator:n2(t),next:t.next})};pI.prototype=cQ(om(pm),{next:function(){var t=pT(this);return new pE(function(e,r){pb(n2(rY(t.next,t.iterator)),e,r)})},return:function(){var t=pT(this).iterator;return new pE(function(e,r){var n=nb(t,"return");if(void 0===n)return e({done:!0,value:void 0});pb(n2(rY(n,t)),e,r)})}});var pN=nG("asyncIterator"),p_=function(t,e,r,n){try{var i=nb(t,"return");if(i)return ns("Promise").resolve(rY(i,t)).then(function(){e(r)},function(t){n(t)})}catch(t){return n(t)}e(r)},pA=function(t){var e=0==t,r=1==t,n=2==t,i=3==t;return function(t,o,s){var u={iterator:t,next:nT(n2(t).next)},a=ns("Promise"),c=u.iterator,p=u.next,l=0,f=void 0!==o;return(f||!e)&&nT(o),new a(function(t,u){var h=function(t){p_(c,u,t,u)},d=function(){try{if(e&&f)try{ay(l)}catch(t){h(t)}a.resolve(n2(rY(p,c))).then(function(p){try{if(n2(p).done)e?(s.length=l,t(s)):t(!i&&(n||void 0));else{var v=p.value;try{f?a.resolve(e?o(v,l):o(v)).then(function(o){if(r)d();else if(n)o?d():p_(c,t,!1,u);else if(e)try{s[l++]=o,d()}catch(t){h(t)}else o?p_(c,t,i||v,u):d()},h):(s[l++]=v,d())}catch(t){h(t)}}}catch(t){u(t)}},u)}catch(t){u(t)}};d()})}},pO={toArray:pA(0),forEach:pA(1),every:pA(2),some:pA(3),find:pA(4)},pM=function(t,e){var r=arguments.length<2?nb(t,pN):e;return r?n2(rY(r,t)):new pI(oG(t))},pP=pO.toArray,pS=nG("asyncIterator"),pR=po("Array").values;i9({target:"Array",stat:!0,forced:!0},{fromAsync:function(t){var e=this,r=arguments.length,n=r>1?arguments[1]:void 0,i=r>2?arguments[2]:void 0;return new(ns("Promise"))(function(r){var o=nS(t);void 0!==n&&(n=o_(n,i));var s=nb(o,pS),u=s?void 0:oV(o)||pR,a=sU(e)?new e:[];r(pP(s?pM(o,s):new pI(oG(o,u)),n,a))})}});var pU=aU.filterReject;i9({target:"Array",proto:!0,forced:!0},{filterOut:function(t){return pU(this,t,arguments.length>1?arguments[1]:void 0)}}),o5("filterOut");var pC=aU.filterReject;i9({target:"Array",proto:!0,forced:!0},{filterReject:function(t){return pC(this,t,arguments.length>1?arguments[1]:void 0)}}),o5("filterReject");var px=Object.isFrozen,pk=function(t,e){if(!px||!ah(t)||!px(t))return!1;for(var r,n=0,i=t.length;n<i;)if(!("string"==typeof(r=t[n++])||e&&void 0===r))return!1;return 0!==i};i9({target:"Array",stat:!0,sham:!0,forced:!0},{isTemplateObject:function(t){if(!pk(t,!0))return!1;var e=t.raw;return e.length===t.length&&pk(e,!1)}});var pD=it.exports,pL=function(t,e,r){return r.get&&pD(r.get,e,{getter:!0}),r.set&&pD(r.set,e,{setter:!0}),nZ.f(t,e,r)};rJ&&(pL(Array.prototype,"lastItem",{configurable:!0,get:function(){var t=nS(this),e=iB(t);return 0==e?void 0:t[e-1]},set:function(t){var e=nS(this),r=iB(e);return e[0==r?0:r-1]=t}}),o5("lastItem")),rJ&&(pL(Array.prototype,"lastIndex",{configurable:!0,get:function(){var t=iB(nS(this));return 0==t?0:t-1}}),o5("lastIndex"));var pF=ns("Map"),pV=pF.prototype,pK=r3(pV.forEach),pG=r3(pV.has),pB=r3(pV.set),pH=r3([].push);i9({target:"Array",proto:!0,forced:!0},{uniqueBy:function(t){var e,r,n,i=nS(this),o=iB(i),s=aw(i,0),u=new pF,a=null!=t?nT(t):function(t){return t};for(e=0;e<o;e++)pG(u,n=a(r=i[e]))||pB(u,n,r);return pK(u,function(t){pH(s,t)}),s}}),o5("uniqueBy");var pj=function(t,e){var r;return null===e.currentSessionId?t:t.user.identifiers[tk.SESSION]?t:t.copyWithUser(W(W({},t.user),{identifiers:W(W({},t.user.identifiers),((r={})[tk.SESSION]=e.sessionId,r))}))},pJ=function(){function t(t,e,r){void 0===r&&(r=(0,K.Z)()),this.timestamp=t,this.user=e,this.insertId=r}return t.exposure=function(t,e,r,n){return new pz(n,t,e.experiment,e.variationId,e.variationKey,e.reason,r)},t.track=function(t,e,r,n){return new pq(n,r,t,e)},t.remoteConfig=function(t,e,r,n){return new pY(n,t,e.parameter,e.valueId,e.reason,r)},t.isExposureEvent=function(t){return void 0!==t.experiment},t.isTrackEvent=function(t){return void 0!==t.eventType},t.isRemoteConfigEvent=function(t){return void 0!==t.parameter},t.isExposureEventDto=function(t){return"experimentId"in t&&void 0!==t.experimentId},t.isTrackEventDto=function(t){return"eventTypeId"in t&&void 0!==t.eventTypeId},t.isRemoteConfigEventDto=function(t){return"parameterId"in t&&void 0!==t.parameterId},t.prototype.toDto=function(){return{insertId:this.insertId,timestamp:this.timestamp,userId:this.user.identifiers[tk.ID],identifiers:this.user.identifiers,userProperties:tr.sanitize(this.user.properties),hackleProperties:tr.sanitize(this.user.hackleProperties)}},t}(),pz=function(t){function e(e,r,n,i,o,s,u,a){var c=t.call(this,e,r,a)||this;return c.experiment=n,c.variationId=i,c.variationKey=o,c.decisionReason=s,c.properties=u,c}return Y(e,t),e.prototype.copyWithUser=function(t){return new e(this.timestamp,t,this.experiment,this.variationId,this.variationKey,this.decisionReason,this.properties,this.insertId)},e.prototype.toDto=function(){return W(W({},t.prototype.toDto.call(this)),{experimentId:this.experiment.id,experimentKey:this.experiment.key,experimentType:this.experiment.type,experimentVersion:this.experiment.version,variationId:this.variationId,variationKey:this.variationKey,decisionReason:this.decisionReason.toString(),properties:this.properties})},e}(pJ),pq=function(t){function e(e,r,n,i,o){var s=t.call(this,e,r,o)||this;return s.eventType=n,s.event=i,s}return Y(e,t),e.prototype.copyWithUser=function(t){return new e(this.timestamp,t,this.eventType,this.event,this.insertId)},e.prototype.toDto=function(){return W(W({},t.prototype.toDto.call(this)),{eventTypeId:this.eventType.id,eventTypeKey:this.eventType.key,value:this.event.value||0,properties:tr.sanitize(this.event.properties)})},e}(pJ),pY=function(t){function e(e,r,n,i,o,s,u){var a=t.call(this,e,r,u)||this;return a.parameter=n,a.valueId=i,a.decisionReason=o,a.properties=s,a}return Y(e,t),e.prototype.copyWithUser=function(t){return new e(this.timestamp,t,this.parameter,this.valueId,this.decisionReason,this.properties,this.insertId)},e.prototype.toDto=function(){return W(W({},t.prototype.toDto.call(this)),{parameterId:this.parameter.id,parameterKey:this.parameter.key,parameterType:this.parameter.type,valueId:this.valueId,decisionReason:this.decisionReason.toString(),properties:tr.sanitize(this.properties)})},e}(pJ),pW=function(){function t(t,e){this.userManager=t,this.core=e}return t.isSessionEvent=function(e){return!!pJ.isTrackEvent(e)&&(e.event.key===t.SESSION_START_EVENT_NAME||e.event.key===t.SESSION_END_EVENT_NAME)},t.prototype.onSessionStarted=function(e,r,n){this.track(t.SESSION_START_EVENT_NAME,e,r,n)},t.prototype.onSessionEnded=function(e,r,n){this.track(t.SESSION_END_EVENT_NAME,e,r,n)},t.prototype.track=function(t,e,r,n){var i=this.userManager.toHackleUser(r),o=this.decorateSession(i,e);this.core.track({key:t},o,n)},t.prototype.decorateSession=function(t,e){var r=new tL().add(tk.SESSION,e).addIdentifiers(t.identifiers).build();return W(W({},t),{identifiers:r})},t.SESSION_START_EVENT_NAME="$session_start",t.SESSION_END_EVENT_NAME="$session_end",t}(),pX=function(){function t(t,e,r,n){this.delegate=t,this.eventDedupDeterminer=e,this.sessionManager=r,this.userManager=n}return t.prototype.process=function(t){if(pW.isSessionEvent(t)||this.sessionManager.startNewSessionIfNeeded(this.userManager.currentUser,t.timestamp),!this.eventDedupDeterminer.isDedupTarget(t)){var e=pj(t.copyWithUser(t.user),this.sessionManager);this.delegate.process(e)}},t.prototype.flush=function(t){this.delegate.flush(t)},t.prototype.close=function(){this.delegate.close()},t.prototype.onLifecycleChanged=function(t,e){switch(t){case"hidden":case"pagehide":return this.flush(!0);case"blur":case"focus":case"locationChange":case"visible":case"pageshow":return}},t}(),p$=function(){function t(){}return t.toEvent=function(e){var r;return{key:t.EVENT_KEY,properties:{level:t.LEVEL_ERROR,type:e.name,message:null!==(r=e.message)&&void 0!==r?r:"",$stacktrace:t._stacktrace(e)}}},t._stacktrace=function(e){return B.isNullOrUndefined(e.stack)?"":e.stack.split("\n").slice(0,t.STACK_TRACK_LIMIT).join("\n")},t.EVENT_KEY="$trace",t.LEVEL_ERROR="error",t.STACK_TRACK_LIMIT=30,t}(),pZ=function(){function t(){}return t.prototype.evaluate=function(t,e){if(!this.supports(t))throw Error("Unsupported EvaluatorRequest ".concat(t.toString()));if(e.contains(t)){var r=e.stack.map(function(t){return t.toString()}).join(" - ");throw Error("Circular evaluation has occurred [".concat(r," - ").concat(t.toString(),"]"))}e.addRequest(t);try{return this.evaluateInternal(t,e)}finally{e.removeRequest(t)}},t}(),pQ=function(){function t(t,e,r,n,i,o){this.reason=t,this.targetEvaluations=e,this.experiment=r,this.variationId=n,this.variationKey=i,this.config=o}return t.prototype.with=function(e){return new t(e,this.targetEvaluations,this.experiment,this.variationId,this.variationKey,this.config)},t.of=function(e,r,n,i){return new t(i,r.targetEvaluations,e.experiment,n.id,n.key,n.config)},t.ofDefault=function(e,r,n){var i=e.experiment._getVariationByKeyOrNull(e.defaultVariationKey);return B.isNotNullOrUndefined(i)?this.of(e,r,i,n):new t(n,r.targetEvaluations,e.experiment,void 0,e.defaultVariationKey,void 0)},t}(),p0=function(t){function e(e){var r=t.call(this)||this;return r.experimentFlowFactory=e,r}return Y(e,t),e.prototype.supports=function(t){return void 0!==t.experiment},e.prototype.evaluateInternal=function(t,e){var r;return null!==(r=this.experimentFlowFactory.getExperimentFlow(t.experiment.type).evaluate(t,e))&&void 0!==r?r:pQ.ofDefault(t,e,tM.TRAFFIC_NOT_ALLOCATED)},e}(pZ),p1=function(){function t(t,e,r,n,i,o){this.reason=t,this.targetEvaluations=e,this.parameter=r,this.valueId=n,this.value=i,this.properties=o}return t.of=function(e,r,n,i,o,s){return s.returnValue=tr.truncateStringValue(i),new t(o,r.targetEvaluations,e.parameter,n,i,s)},t.ofDefault=function(t,e,r,n){return this.of(t,e,void 0,t.defaultValue,r,n)},t}(),p2=function(t){function e(e){var r=t.call(this)||this;return r.targetRuleDeterminer=e,r}return Y(e,t),e.prototype.supports=function(t){return void 0!==t.parameter},e.prototype.evaluateInternal=function(t,e){var r={};if(r.requestValueType=t.requiredType,r.requestDefaultValue=tr.truncateStringValue(t.defaultValue),B.isNullOrUndefined(t.user.identifiers[t.parameter.identifierType]))return p1.ofDefault(t,e,tM.IDENTIFIER_NOT_FOUND,r);var n=this.targetRuleDeterminer.determineTargetRuleOrNull(t,e);return B.isNotNullOrUndefined(n)?(r.targetRuleKey=n.key,r.targetRuleName=n.name,this.evaluation(t,e,n.value,tM.TARGET_RULE_MATCH,r)):this.evaluation(t,e,t.parameter.defaultValue,tM.DEFAULT_RULE,r)},e.prototype.evaluation=function(t,e,r,n,i){return"UNKNOWN"===t.requiredType||"NULL"!==t.requiredType&&typeof t.defaultValue!=typeof r.rawValue?p1.ofDefault(t,e,tM.TYPE_MISMATCH,i):p1.of(t,e,r.id,r.rawValue,n,i)},e}(pZ),p4=function(){function t(t,e){this.type=t,this.id=e}return t.prototype.isEquals=function(t){return this.type===t.type&&this.id===t.id},t}(),p3=function(){function t(){this._stack=[],this._targetEvaluations=[],this._properties={},this.map=new WeakMap}return t.create=function(){return new t},Object.defineProperty(t.prototype,"stack",{get:function(){return Array.from(this._stack)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetEvaluations",{get:function(){return Array.from(this._targetEvaluations)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return tr.sanitize(this._properties)},enumerable:!1,configurable:!0}),t.prototype.contains=function(t){return this._stack.some(function(e){return e.key.isEquals(t.key)})},t.prototype.addRequest=function(t){this._stack.push(t)},t.prototype.removeRequest=function(t){var e=this._stack.indexOf(t,0);e>-1&&this._stack.splice(e,1)},t.prototype.getEvaluation=function(t){return this._targetEvaluations.find(function(e){return e instanceof pQ&&e.experiment.id===t.id})},t.prototype.addEvaluation=function(t){this._targetEvaluations.push(t)},t.prototype.setProperty=function(t,e){this._properties[t]=e},t.prototype.get=function(t){var e=this.map.get(t);if(!e)return null;if(!(e instanceof t))throw Error("Context does not contain a value of type ".concat(t.name));return e},t.prototype.set=function(t,e){this.map.set(t,e)},t}(),p6=function(){function t(t,e,r,n){this.key=new p4("EXPERIMENT",r.id),this.workspace=t,this.user=e,this.experiment=r,this.defaultVariationKey=n}return t.of=function(e,r,n,i){return new t(e,r,n,i)},t.by=function(e,r){return new t(e.workspace,e.user,r,"A")},t.prototype.toString=function(){return"EvaluatorRequest(type=".concat(this.experiment.type,", key=").concat(this.experiment.key,")")},t}(),p5=function(){function t(t,e,r,n,i){this.key=new p4("REMOTE_CONFIG",r.id),this.workspace=t,this.user=e,this.parameter=r,this.requiredType=n,this.defaultValue=i}return t.of=function(e,r,n,i,o){return new t(e,r,n,i,o)},t.prototype.toString=function(){return"EvaluatorRequest(type=".concat(this.key.type,", key=").concat(this.parameter.key,")")},t}(),p9=function(){function t(){}return t.asString=function(t){switch(typeof t){case"string":return t;case"number":return t.toString();case"boolean":return t?"true":"false";default:return}},t.asNumber=function(t){switch(typeof t){case"number":return this.asActualNumber(t);case"string":return this.asActualNumber(Number(t));default:return}},t.asBoolean=function(t){switch(typeof t){case"boolean":return t;case"string":switch(t){case"true":return!0;case"false":return!1;default:return}default:return}},t.asActualNumber=function(t){return!isNaN(t)&&isFinite(t)?t:void 0},t}(),p8=function(){function t(t){this.storages=t}return t.prototype.getVariation=function(t,e){if(0!==this.storages.length)for(var r=0,n=this.storages;r<n.length;r++){var i=n[r].getVariation(t,e);if(void 0!==i)return i}},t}(),p7=function(){function t(t){this.listStorage=t}return t.prototype.getVariation=function(t,e){var r=this.get(t);if(r)return t._getVariationByIdOrNull(r)},t.prototype.get=function(t){var e=this.listStorage.getItem(t.id.toString());return p9.asNumber(e)},t.prototype.getAll=function(){var t=new Map;return this.listStorage.entries().forEach(function(e){var r=e[0],n=e[1],i=p9.asNumber(r),o=p9.asNumber(n);B.isNullOrUndefined(i)||i<0||B.isNullOrUndefined(o)||i<0||t.set(i,o)}),t},t.prototype.set=function(t,e){this.listStorage.setItem(t.id.toString(),e.toString())},t.prototype.remove=function(t){this.listStorage.removeItem(t.id.toString())},t.prototype.clear=function(){this.listStorage.clear()},t}(),lt=function(){function t(){this.evaluators=[]}return t.prototype.add=function(t){this.evaluators.push(t)},t.prototype.evaluate=function(t,e){var r=this.evaluators.find(function(e){return e.supports(t)});if(B.isNullOrUndefined(r))throw Error("Unsupported EvaluatorRequest [".concat(t.toString(),"]"));return r.evaluate(t,e)},t}(),le=function(){function t(){}return t.get=function(t){return B.requiredNotNullOrUndefined(this.getOrNull(t),function(){return"Instance not registered [".concat(t,"]")})},t.getOrNull=function(e){return t.instances.get(e)},t.register=function(e,r){return t.instances.set(e,r),r},t.instances=new Map,t}(),lr=function(){function t(t,e){this.targetMatcher=t,this.bucketer=e}return t.prototype.determineTargetRuleOrNull=function(t,e){var r=this;return t.parameter.targetRules.find(function(n){return r.matches(t,e,n)})},t.prototype.matches=function(t,e,r){if(!this.targetMatcher.matches(t,e,r.target))return!1;var n=t.user.identifiers[t.parameter.identifierType];if(B.isNullOrUndefined(n))return!1;var i=t.workspace.getBucketOrNull(r.bucketId);if(B.isNullOrUndefined(i))throw Error("bucket[".concat(r.bucketId,"]"));return B.isNotNullOrUndefined(this.bucketer.bucketing(i,n))},t}(),ln=function(){function t(t){this.bucketer=t}return t.prototype.resolveOrNull=function(t,e,r){switch(r.type){case"VARIATION":return this.resolveVariation(t,r);case"BUCKET":return this.resolveBucket(t,r)}},t.prototype.resolveVariation=function(t,e){return t.experiment._getVariationByIdOrNull(e.variationId)},t.prototype.resolveBucket=function(t,e){var r=t.workspace.getBucketOrNull(e.bucketId),n=t.user.identifiers[t.experiment.identifierType];if(n){var i=this.bucketer.bucketing(r,n);if(i)return t.experiment._getVariationByIdOrNull(i.variationId)}},t}(),li=function(){function t(t,e){this.flowEvaluator=t,this.nextFlow=e}return t.prototype.evaluate=function(t,e){return this.flowEvaluator&&this.nextFlow?this.flowEvaluator.evaluate(t,e,this.nextFlow):void 0},t.end=function(){return new t(void 0,void 0)},t.decision=function(e,r){return new t(e,r)},t.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this.end(),n=0,i=t.reverse();n<i.length;n++){var o=i[n];r=this.decision(o,r)}return r},t}(),lo=function(){function t(t){this.overrideResolver=t}return t.prototype.evaluate=function(t,e,r){var n=this.overrideResolver.resolveOrNull(t,e);if(!n)return r.evaluate(t,e);switch(t.experiment.type){case"AB_TEST":return pQ.of(t,e,n,tM.OVERRIDDEN);case"FEATURE_FLAG":return pQ.of(t,e,n,tM.INDIVIDUAL_TARGET_MATCH)}},t}(),ls=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return"DRAFT"===t.experiment.status?pQ.ofDefault(t,e,tM.EXPERIMENT_DRAFT):r.evaluate(t,e)},t}(),lu=function(){function t(){}return t.prototype.evaluate=function(t,e,r){if("PAUSED"!==t.experiment.status)return r.evaluate(t,e);switch(t.experiment.type){case"AB_TEST":return pQ.ofDefault(t,e,tM.EXPERIMENT_PAUSED);case"FEATURE_FLAG":return pQ.ofDefault(t,e,tM.FEATURE_FLAG_INACTIVE)}},t}(),la=function(){function t(){}return t.prototype.evaluate=function(t,e,r){if("COMPLETED"!==t.experiment.status)return r.evaluate(t,e);var n=t.experiment._winnerVariationOrNull();if(!n)throw Error("winner variation [".concat(t.experiment.id,"]"));return pQ.of(t,e,n,tM.EXPERIMENT_COMPLETED)},t}(),lc=function(){function t(t){this.experimentTargetDeterminer=t}return t.prototype.evaluate=function(t,e,r){if("AB_TEST"!==t.experiment.type)throw Error("experiment type must be AB_TEST [".concat(t.experiment.id,"]"));return this.experimentTargetDeterminer.isUserInExperimentTarget(t,e)?r.evaluate(t,e):pQ.ofDefault(t,e,tM.NOT_IN_EXPERIMENT_TARGET)},t}(),lp=function(){function t(t){this.actionResolver=t}return t.prototype.evaluate=function(t,e,r){if("RUNNING"!==t.experiment.status)throw Error("experiment status must be RUNNING [".concat(t.experiment.id,"]"));if("AB_TEST"!==t.experiment.type)throw Error("experiment type must be AB_TEST [".concat(t.experiment.id,"]"));var n=this.actionResolver.resolveOrNull(t,e,t.experiment.defaultRule);return n?n.isDropped?pQ.ofDefault(t,e,tM.VARIATION_DROPPED):pQ.of(t,e,n,tM.TRAFFIC_ALLOCATED):pQ.ofDefault(t,e,tM.TRAFFIC_NOT_ALLOCATED)},t}(),ll=function(){function t(t,e){this.targetRuleDeterminer=t,this.actionResolver=e}return t.prototype.evaluate=function(t,e,r){if("RUNNING"!==t.experiment.status)throw Error("experiment status must be RUNNING [".concat(t.experiment.id,"]"));if("FEATURE_FLAG"!==t.experiment.type)throw Error("experiment type must be FEATURE_FLAG [".concat(t.experiment.id,"]"));if(!t.user.identifiers[t.experiment.identifierType])return r.evaluate(t,e);var n=this.targetRuleDeterminer.determineTargetRuleOrNull(t,e);if(!n)return r.evaluate(t,e);var i=this.actionResolver.resolveOrNull(t,e,n.action);if(!i)throw Error("FeatureFlag must decide the Variation [".concat(t.experiment.id,"]"));return pQ.of(t,e,i,tM.TARGET_RULE_MATCH)},t}(),lf=function(){function t(t){this.actionResolver=t}return t.prototype.evaluate=function(t,e,r){if("RUNNING"!==t.experiment.status)throw Error("experiment status must be RUNNING [".concat(t.experiment.id,"]"));if("FEATURE_FLAG"!==t.experiment.type)throw Error("experiment type must be FEATURE_FLAG [".concat(t.experiment.id,"]"));if(!t.user.identifiers[t.experiment.identifierType])return pQ.ofDefault(t,e,tM.DEFAULT_RULE);var n=this.actionResolver.resolveOrNull(t,e,t.experiment.defaultRule);if(!n)throw Error("FeatureFlag must decide the Variation [".concat(t.experiment.id,"]"));return pQ.of(t,e,n,tM.DEFAULT_RULE)},t}(),lh=function(){function t(t){this.containerResolver=t}return t.prototype.evaluate=function(t,e,r){var n=t.experiment.containerId;if(!n)return r.evaluate(t,e);var i=t.workspace.getContainerOrNull(n);if(!i)throw Error("container[".concat(n,"]"));return this.containerResolver.isUserInContainerGroup(t,e,i)?r.evaluate(t,e):pQ.ofDefault(t,e,tM.NOT_IN_MUTUAL_EXCLUSION_EXPERIMENT)},t}(),ld=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return t.user.identifiers[t.experiment.identifierType]?r.evaluate(t,e):pQ.ofDefault(t,e,tM.IDENTIFIER_NOT_FOUND)},t}(),lv=function(){function t(t){this.targetMatcher=t}return t.prototype.isUserInExperimentTarget=function(t,e){var r=this;return 0===t.experiment.targetAudiences.length||t.experiment.targetAudiences.some(function(n){return r.targetMatcher.matches(t,e,n)})},t}(),ly=function(){function t(t){this.targetMatcher=t}return t.prototype.determineTargetRuleOrNull=function(t,e){var r=this;return t.experiment.targetRules.find(function(n){return r.targetMatcher.matches(t,e,n.target)})},t}(),lg=function(){function t(t,e,r){this.manualOverrideStorage=t,this.targetMatcher=e,this.actionResolver=r}return t.prototype.resolveOrNull=function(t,e){var r,n;return null!==(n=null!==(r=this.resolveManualOverride(t))&&void 0!==r?r:this._resolveUserOverride(t))&&void 0!==n?n:this._resolveSegmentOverride(t,e)},t.prototype.resolveManualOverride=function(t){return this.manualOverrideStorage.getVariation(t.experiment,t.user)},t.prototype._resolveUserOverride=function(t){var e=t.experiment,r=t.user.identifiers[e.identifierType];if(r){var n=e.userOverrides.get(r);if(n)return e._getVariationByIdOrNull(n)}},t.prototype._resolveSegmentOverride=function(t,e){var r=this,n=t.experiment.segmentOverrides.find(function(n){return r.targetMatcher.matches(t,e,n.target)});if(n)return this.actionResolver.resolveOrNull(t,e,n.action)},t}(),lm=function(){function t(t){this.bucketer=t}return t.prototype.isUserInContainerGroup=function(t,e,r){var n=t.user.identifiers[t.experiment.identifierType];if(B.isNullOrUndefined(n))return!1;var i=t.workspace.getBucketOrNull(r.bucketId);if(B.isNullOrUndefined(i))throw Error("Bucket[".concat(r.bucketId,"]"));var o=this.bucketer.bucketing(i,n);if(B.isNullOrUndefined(o))return!1;var s=r.getGroupOrNull(o.variationId);if(B.isNullOrUndefined(s))throw Error("ContainerGroup[".concat(o.variationId,"]"));return s.experiments.includes(t.experiment.id)},t}(),lE=function(){function t(t,e,r){var n=new ln(e),i=new lg(t,r,n),o=new lm(e);this.abTestFlow=li.of(new lo(i),new ld,new lh(o),new lc(new lv(r)),new ls,new lu,new la,new lp(n)),this.featureFlagFlow=li.of(new ls,new lu,new la,new lo(i),new ld,new ll(new ly(r),n),new lf(n))}return t.prototype.getExperimentFlow=function(t){switch(t){case"AB_TEST":return this.abTestFlow;case"FEATURE_FLAG":return this.featureFlagFlow}},t}(),lw=function(){function t(t){this.conditionMatcherFactory=t}return t.prototype.matches=function(t,e,r){var n=this;return r.conditions.every(function(r){return n._matches(t,e,r)})},t.prototype.anyMatches=function(t,e,r){var n=this;return!r.length||r.some(function(r){return n.matches(t,e,r)})},t.prototype._matches=function(t,e,r){return this.conditionMatcherFactory.getMatcher(r.key.type).matches(t,e,r)},t}(),lT=function(){function t(){}return t.prototype.decorate=function(t){return t},t}(),lb=function(){function t(){}return t.prototype.decorate=function(t){return"string"==typeof t?rR.decodeURIOrOriginal(t):t},t}(),lI=function(){function t(t,e){this.valueMatcherFactory=t,this.operatorMatcherFactory=e}return t.prototype.matches=function(t,e,r){void 0===r&&(r=new lT);var n=this.valueMatcherFactory.getMatcher(e.valueType),i=this.operatorMatcherFactory.getMatcher(e.operator),o=this.userValueMatches(t,e,n,i,r);return this.typeMatches(e.type,o)},t.prototype.userValueMatches=function(t,e,r,n,i){return Array.isArray(t)?this.arrayMatches(t,e,r,n,i):this.singleMatches(t,e,r,n,i)},t.prototype.singleMatches=function(t,e,r,n,i){var o=i.decorate(t),s=e.values.map(i.decorate);return n.matches(r,o,s)},t.prototype.arrayMatches=function(t,e,r,n,i){var o=this;return t.some(function(t){return o.singleMatches(t,e,r,n,i)})},t.prototype.typeMatches=function(t,e){switch(t){case"MATCH":return e;case"NOT_MATCH":return!e}},t}(),lN=function(){function t(){}return t.prototype.matches=function(t,e,r){return!B.isNullOrUndefined(e)&&r.some(function(r){return t.inMatches(e,r)})},t}(),l_=function(){function t(){}return t.prototype.matches=function(t,e,r){return!B.isNullOrUndefined(e)&&r.some(function(r){return t.containsMatches(e,r)})},t}(),lA=function(){function t(){}return t.prototype.matches=function(t,e,r){return!B.isNullOrUndefined(e)&&r.some(function(r){return t.startsWithMatches(e,r)})},t}(),lO=function(){function t(){}return t.prototype.matches=function(t,e,r){return!B.isNullOrUndefined(e)&&r.some(function(r){return t.endsWithMatches(e,r)})},t}(),lM=function(){function t(){}return t.prototype.matches=function(t,e,r){return!B.isNullOrUndefined(e)&&r.some(function(r){return t.greaterThanMatches(e,r)})},t}(),lP=function(){function t(){}return t.prototype.matches=function(t,e,r){return!B.isNullOrUndefined(e)&&r.some(function(r){return t.greaterThanOrEqualMatches(e,r)})},t}(),lS=function(){function t(){}return t.prototype.matches=function(t,e,r){return!B.isNullOrUndefined(e)&&r.some(function(r){return t.lessThanMatches(e,r)})},t}(),lR=function(){function t(){}return t.prototype.matches=function(t,e,r){return!B.isNullOrUndefined(e)&&r.some(function(r){return t.lessThanOrEqualMatches(e,r)})},t}(),lU=function(){function t(){}return t.prototype.matches=function(t,e,r){return!B.isNullOrUndefined(e)},t}(),lC=function(){function t(){}return t.prototype.getMatcher=function(e){switch(e){case"IN":return t.IN_MATCHER;case"CONTAINS":return t.CONTAINS_MATCHER;case"STARTS_WITH":return t.STARTS_WITH_MATCHER;case"ENDS_WITH":return t.ENDS_WITH_MATCHER;case"GT":return t.GT_MATCHER;case"GTE":return t.GTE_MATCHER;case"LT":return t.LT_MATCHER;case"LTE":return t.LTE_MATCHER;case"EXISTS":return t.EXISTS_MATCHER}},t.IN_MATCHER=new lN,t.CONTAINS_MATCHER=new l_,t.STARTS_WITH_MATCHER=new lA,t.ENDS_WITH_MATCHER=new lO,t.GT_MATCHER=new lM,t.GTE_MATCHER=new lP,t.LT_MATCHER=new lS,t.LTE_MATCHER=new lR,t.EXISTS_MATCHER=new lU,t}(),lx=function(){function t(){}return t.prototype.inMatches=function(t,e){var r=p9.asString(t),n=p9.asString(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r===n},t.prototype.containsMatches=function(t,e){var r=p9.asString(t),n=p9.asString(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r.includes(n)},t.prototype.startsWithMatches=function(t,e){var r=p9.asString(t),n=p9.asString(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r.startsWith(n)},t.prototype.endsWithMatches=function(t,e){var r=p9.asString(t),n=p9.asString(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r.endsWith(n)},t.prototype.greaterThanMatches=function(t,e){var r=p9.asString(t),n=p9.asString(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r>n},t.prototype.greaterThanOrEqualMatches=function(t,e){var r=p9.asString(t),n=p9.asString(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r>=n},t.prototype.lessThanMatches=function(t,e){var r=p9.asString(t),n=p9.asString(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r<n},t.prototype.lessThanOrEqualMatches=function(t,e){var r=p9.asString(t),n=p9.asString(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r<=n},t}(),lk=function(){function t(){}return t.prototype.inMatches=function(t,e){var r=p9.asNumber(t),n=p9.asNumber(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r===n},t.prototype.containsMatches=function(t,e){return!1},t.prototype.startsWithMatches=function(t,e){return!1},t.prototype.endsWithMatches=function(t,e){return!1},t.prototype.greaterThanMatches=function(t,e){var r=p9.asNumber(t),n=p9.asNumber(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r>n},t.prototype.greaterThanOrEqualMatches=function(t,e){var r=p9.asNumber(t),n=p9.asNumber(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r>=n},t.prototype.lessThanMatches=function(t,e){var r=p9.asNumber(t),n=p9.asNumber(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r<n},t.prototype.lessThanOrEqualMatches=function(t,e){var r=p9.asNumber(t),n=p9.asNumber(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r<=n},t}(),lD=function(){function t(){}return t.prototype.inMatches=function(t,e){var r=p9.asBoolean(t),n=p9.asBoolean(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r===n},t.prototype.containsMatches=function(t,e){return!1},t.prototype.startsWithMatches=function(t,e){return!1},t.prototype.endsWithMatches=function(t,e){return!1},t.prototype.greaterThanMatches=function(t,e){return!1},t.prototype.greaterThanOrEqualMatches=function(t,e){return!1},t.prototype.lessThanMatches=function(t,e){return!1},t.prototype.lessThanOrEqualMatches=function(t,e){return!1},t}(),lL=function(){function t(){}return t.prototype.inMatches=function(t,e){var r=t$.tryParse(t),n=t$.tryParse(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r.isEqualTo(n)},t.prototype.containsMatches=function(t,e){return!1},t.prototype.startsWithMatches=function(t,e){return!1},t.prototype.endsWithMatches=function(t,e){return!1},t.prototype.greaterThanMatches=function(t,e){var r=t$.tryParse(t),n=t$.tryParse(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r.isGreaterThan(n)},t.prototype.greaterThanOrEqualMatches=function(t,e){var r=t$.tryParse(t),n=t$.tryParse(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r.isGreaterThanOrEqualTo(n)},t.prototype.lessThanMatches=function(t,e){var r=t$.tryParse(t),n=t$.tryParse(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r.isLessThan(n)},t.prototype.lessThanOrEqualMatches=function(t,e){var r=t$.tryParse(t),n=t$.tryParse(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&r.isLessThanOrEqualTo(n)},t}(),lF=function(){function t(){}return t.prototype.inMatches=function(t,e){var r=rR.tryParse(t),n=p9.asString(e);return!(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))&&rR.decodeURIOrOriginal(rR.removePathnameTrailingSlash(r))===rR.decodeURIOrOriginal(rR.removePathnameTrailingSlash(n))},t.prototype.containsMatches=function(t,e){var r=rR.tryParse(t),n=p9.asString(e);if(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))return!1;var i=rR.decodeURIOrOriginal(r.href);return i.includes(n)||i.includes(encodeURI(n))},t.prototype.startsWithMatches=function(t,e){var r=rR.tryParse(t),n=p9.asString(e);if(B.isNullOrUndefined(r)||B.isNullOrUndefined(n))return!1;var i=rR.decodeURIOrOriginal(r.href);return i.startsWith(n)||i.startsWith(encodeURI(n))},t.prototype.endsWithMatches=function(t,e){return!1},t.prototype.greaterThanMatches=function(t,e){return!1},t.prototype.greaterThanOrEqualMatches=function(t,e){return!1},t.prototype.lessThanMatches=function(t,e){return!1},t.prototype.lessThanOrEqualMatches=function(t,e){return!1},t}(),lV=function(){function t(){}return t.prototype.inMatches=function(t,e){return!1},t.prototype.containsMatches=function(t,e){return!1},t.prototype.startsWithMatches=function(t,e){return!1},t.prototype.endsWithMatches=function(t,e){return!1},t.prototype.greaterThanMatches=function(t,e){return!1},t.prototype.greaterThanOrEqualMatches=function(t,e){return!1},t.prototype.lessThanMatches=function(t,e){return!1},t.prototype.lessThanOrEqualMatches=function(t,e){return!1},t}(),lK=function(){function t(){}return t.prototype.getMatcher=function(e){switch(e){case"STRING":case"JSON":return t.STRING_MATCHER;case"NUMBER":return t.NUMBER_MATCHER;case"BOOLEAN":return t.BOOLEAN_MATCHER;case"VERSION":return t.VERSION_MATCHER;case"URL":return t.URL_MATCHER;case"NULL":case"UNKNOWN":return t.NULL_MATCHER}},t.STRING_MATCHER=new lx,t.NUMBER_MATCHER=new lk,t.BOOLEAN_MATCHER=new lD,t.VERSION_MATCHER=new lL,t.URL_MATCHER=new lF,t.NULL_MATCHER=new lV,t}(),lG=function(){function t(t,e){this.URL_HACKLE_PROPERTY_KEY_NAMES=["pagePath","host","url","queryParameter"],this.userValueResolver=t,this.valueOperatorMatcher=e}return t.prototype.matches=function(t,e,r){var n=this.userValueResolver.resolveOrNull(t.user,r.key),i=this.valueDecorator(r.key);return this.valueOperatorMatcher.matches(n,r.match,i)},t.prototype.valueDecorator=function(t){return"HACKLE_PROPERTY"===t.type&&this.URL_HACKLE_PROPERTY_KEY_NAMES.includes(t.name)?new lb:new lT},t}(),lB=function(){function t(){}return t.prototype.resolveOrNull=function(t,e){switch(e.type){case"USER_ID":return t.identifiers[e.name];case"USER_PROPERTY":return t.properties[e.name];case"HACKLE_PROPERTY":return t.hackleProperties[e.name];default:throw Error("Unsupported TargetKeyType [".concat(e.type,"]"))}},t}(),lH=function(){function t(t){this.segmentMatcher=t}return t.prototype.matches=function(t,e,r){var n=this;if("SEGMENT"!=r.key.type)throw Error("Unsupported TargetKeyType [".concat(r.key.type,"]"));var i=r.match.values.some(function(r){return n._matches(t,e,r)});switch(r.match.type){case"MATCH":return i;case"NOT_MATCH":return!i}},t.prototype._matches=function(t,e,r){if("string"!=typeof r)throw Error("SegmentKey[".concat(r,"]"));var n=t.workspace.getSegmentOrNull(r);if(!n)throw Error("Segment[".concat(r,"]"));return this.segmentMatcher.matches(t,e,n)},t}(),lj=function(){function t(t){this.userConditionMatcher=t}return t.prototype.matches=function(t,e,r){var n=this;return r.targets.some(function(r){return n._matches(t,e,r)})},t.prototype._matches=function(t,e,r){var n=this;return r.conditions.every(function(r){return n.userConditionMatcher.matches(t,e,r)})},t}(),lJ=function(){function t(t){this.evaluator=t}return t.prototype.evaluateInternal=function(t,e,r){var n=p6.by(t,r),i=this.evaluator.evaluate(n,e);if(!(i instanceof pQ))throw Error("Unexpected evaluation [expected=ExperimentEvaluation, actual=".concat(i.constructor.name,"]"));var o=this.resolve(t,e,i);return e.addEvaluation(o),o},t.prototype.evaluate=function(t,e,r){var n;return null!==(n=e.getEvaluation(r))&&void 0!==n?n:this.evaluateInternal(t,e,r)},t}(),lz=function(){function t(t,e){this.abTestMatcher=t,this.featureFlagMatcher=e}return t.prototype.matches=function(t,e,r){switch(r.key.type){case"AB_TEST":return this.abTestMatcher.matches(t,e,r);case"FEATURE_FLAG":return this.featureFlagMatcher.matches(t,e,r);default:throw Error("Unsupported TargetKeyType [".concat(r.key.type,"]"))}},t}(),lq=function(t){function e(e,r){var n=t.call(this,e)||this;return n.valueOperatorMatcher=r,n}return Y(e,t),e.prototype.matches=function(t,e,r){var n=B.requiredNotNullOrUndefined(p9.asNumber(r.key.name),function(){return"Invalid key [".concat(r.key.type,", ").concat(r.key.name,"]")}),i=this.experiment(t,n);if(B.isNullOrUndefined(i))return!1;var o=this.evaluate(t,e,i);return this.evaluationMatches(o,r)},e}(lJ),lY=function(t){function e(e,r){return t.call(this,e,r)||this}return Y(e,t),e.prototype.experiment=function(t,e){return t.workspace.getExperimentOrNull(e)},e.prototype.resolve=function(t,e,r){return r.reason===tM.TRAFFIC_ALLOCATED?r.with(tM.TRAFFIC_ALLOCATED_BY_TARGETING):r},e.prototype.evaluationMatches=function(t,r){return!!e.AB_TEST_MATCHED_REASONS.includes(t.reason)&&this.valueOperatorMatcher.matches(t.variationKey,r.match)},e.AB_TEST_MATCHED_REASONS=[tM.OVERRIDDEN,tM.TRAFFIC_ALLOCATED,tM.EXPERIMENT_COMPLETED,tM.TRAFFIC_ALLOCATED_BY_TARGETING],e}(lq),lW=function(t){function e(e,r){return t.call(this,e,r)||this}return Y(e,t),e.prototype.experiment=function(t,e){return t.workspace.getFeatureFlagOrNull(e)},e.prototype.resolve=function(t,e,r){return r},e.prototype.evaluationMatches=function(t,e){var r="A"!==t.variationKey;return this.valueOperatorMatcher.matches(r,e.match)},e}(lq),lX=function(){function t(t,e){this.eventValueResolver=t,this.valueOperatorMatcher=e}return t.prototype.matches=function(t,e,r){if(!this.isEventEvaluatorRequest(t))return!1;var n=this.eventValueResolver.resolveOrNull(t.event,r.key);return this.valueOperatorMatcher.matches(n,r.match)},t.prototype.isEventEvaluatorRequest=function(t){return void 0!==t.event},t}(),l$=function(){function t(){}return t.prototype.resolveOrNull=function(t,e){var r;switch(e.type){case"EVENT_PROPERTY":return null===(r=this.properties(t))||void 0===r?void 0:r[e.name];case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":case"SEGMENT":case"AB_TEST":case"FEATURE_FLAG":case"COHORT":throw Error("Unsupported TargetKeyType [".concat(e.type,"]"))}},t.prototype.properties=function(t){return pJ.isTrackEvent(t)?t.event.properties:pJ.isExposureEvent(t)||pJ.isRemoteConfigEvent(t)?t.properties:void 0},t}(),lZ=function(){function t(t){this.valueOperatorMatcher=t}return t.prototype.matches=function(t,e,r){if("COHORT"!==r.key.type)throw Error("Unsupported TargetKeyType [".concat(r.key.type,"]"));var n,i,o=null!==(i=null===(n=t.user.cohorts)||void 0===n?void 0:n.map(function(t){return t.id}))&&void 0!==i?i:[];return this.valueOperatorMatcher.matches(o,r.match)},t}(),lQ=function(){function t(t,e){this.valueOperatorMatcher=t,this.clock=e}return t.prototype.supports=function(t){return"NUMBER_OF_EVENTS_IN_DAYS"===t||"NUMBER_OF_EVENTS_WITH_PROPERTY_IN_DAYS"===t},t.prototype.matches=function(t,e,r){var n,i=r.key.type;if(!this.supports(i))throw Error("Unsupported TargetKeyType [".concat(i,"]"));var o=null!==(n=t.user.targetEvents)&&void 0!==n?n:[];switch(i){case"NUMBER_OF_EVENTS_IN_DAYS":return new l1(this.valueOperatorMatcher,this.clock).matches(t,o,r);case"NUMBER_OF_EVENTS_WITH_PROPERTY_IN_DAYS":return new l2(this.valueOperatorMatcher,this.clock).matches(t,o,r);default:return i}},t}(),l0=function(){},l1=function(t){function e(e,r){var n=t.call(this)||this;return n.valueOperatorMatcher=e,n.clock=r,n}return Y(e,t),e.prototype.matches=function(t,e,r){var n=this,i=this.convertTargetConditionToExpression(r),o=this.clock.currentMillis()-ti.daysToUnit(i.days,"milliseconds"),s=e.filter(function(t){return n.expressionMatch(t,i)}),u=H.sum(s,function(t){return t.countWithinDays(o)});return this.valueOperatorMatcher.matches(u,r.match)},e.prototype.expressionMatch=function(t,e){return t.eventKey===e.eventKey&&null===t.property},e.prototype.convertTargetConditionToExpression=function(t){try{return JSON.parse(t.key.name)}catch(t){throw Error("Failed to parse UserTargetCondition. ".concat(t))}},e}(l0),l2=function(t){function e(e,r){var n=t.call(this)||this;return n.valueOperatorMatcher=e,n.clock=r,n}return Y(e,t),e.prototype.matches=function(t,e,r){var n=this,i=this.convertTargetConditionToExpression(r),o=this.clock.currentMillis()-ti.daysToUnit(i.days,"milliseconds"),s=e.filter(function(t){return n.expressionMatch(t,i)}),u=H.sum(s,function(t){return t.countWithinDays(o)});return this.valueOperatorMatcher.matches(u,r.match)},e.prototype.propertyMatch=function(t,e){return(null==t?void 0:t.type)===e.key.type&&t.key===e.key.name&&this.valueOperatorMatcher.matches(t.value,e.match)},e.prototype.expressionMatch=function(t,e){return t.eventKey===e.eventKey&&this.propertyMatch(t.property,e.propertyFilter)},e.prototype.convertTargetConditionToExpression=function(t){try{return JSON.parse(t.key.name)}catch(t){throw Error("Failed to parse UserTargetCondition. ".concat(t))}},e}(l0),l4=function(){function t(t,e){var r=new lI(new lK,new lC);this.userConditionMatcher=new lG(new lB,r),this.eventConditionMatcher=new lX(new l$,r),this.segmentConditionMatcher=new lH(new lj(this.userConditionMatcher)),this.experimentConditionMatcher=new lz(new lY(t,r),new lW(t,r)),this.cohortConditionMatcher=new lZ(r),this.userTargetConditionMatcher=new lQ(r,e)}return t.prototype.getMatcher=function(t){switch(t){case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":return this.userConditionMatcher;case"EVENT_PROPERTY":return this.eventConditionMatcher;case"SEGMENT":return this.segmentConditionMatcher;case"AB_TEST":case"FEATURE_FLAG":return this.experimentConditionMatcher;case"COHORT":return this.cohortConditionMatcher;case"NUMBER_OF_EVENTS_IN_DAYS":case"NUMBER_OF_EVENTS_WITH_PROPERTY_IN_DAYS":return this.userTargetConditionMatcher;default:return t}},t}(),l3={murmurhash3_x86_32:function(t,e,r,n){void 0===n&&(n=t.length);for(var i,o=-4&n,s=e,u=0;u<o;u+=4)i=255&t.charCodeAt(u)|(255&t.charCodeAt(u+1))<<8|(255&t.charCodeAt(u+2))<<16|(255&t.charCodeAt(u+3))<<24,i=(131071&(i=this.mul32(i,3432918353)))<<15|i>>>17,s^=i=this.mul32(i,461845907),s=5*(s=(524287&s)<<13|s>>>19)+3864292196|0;switch(i=0,n%4){case 3:i=(255&t.charCodeAt(o+2))<<16;case 2:i|=(255&t.charCodeAt(o+1))<<8;case 1:i|=255&t.charCodeAt(o),i=(131071&(i=this.mul32(i,3432918353)))<<15|i>>>17,s^=i=this.mul32(i,461845907)}return s^=n,s^=s>>>16,s=this.mul32(s,2246822507),s^=s>>>13,s=this.mul32(s,3266489909),s^=s>>>16},mul32:function(t,e){var r=65535&e;return((e-r)*t|0)+(r*t|0)|0}},l6=function(){function t(){}return t.prototype.bucketing=function(t,e){var r=this.calculateSlotNumber(t.seed,t.slotSize,e);return t.slots.find(function(t){return t.contains(r)})},t.prototype.calculateSlotNumber=function(t,e,r){return Math.abs(l3.murmurhash3_x86_32(r,t))%Math.abs(e)},t}(),l5=J.log,l9=function(){function t(t,e,r,n,i,o){this.experimentEvaluator=t,this.remoteConfigEvaluator=e,this.workspaceFetcher=r,this.eventFactory=n,this.eventProcessor=i,this.errorDedupDeterminer=o}return t.create=function(e,r,n,i){var o=to.instance,s=le.register("delegatingEvaluator",new lt),u=new l6,a=le.register("targetMatcher",new lw(new l4(s,o))),c=new p8(i),p=new lr(a,u),l=new p0(new lE(c,u,le.get("targetMatcher"))),f=new p2(p);return s.add(l),s.add(f),new t(l,f,e,r,n,new l8)},t.prototype.getExperiment=function(t){if(!t){l5.error("experimentKey must not be empty");return}var e=this.workspaceFetcher.get();if(e)return e.getExperimentOrNull(t)},t.prototype.experiment=function(t,e,r){var n=this;if(!t)return l5.error("experimentKey must not be empty"),t_.of(r,tM.INVALID_INPUT);var i=this.workspaceFetcher.get();if(!i)return l5.warn("SDK not ready."),t_.of(r,tM.SDK_NOT_READY);var o=i.getExperimentOrNull(t);if(!o)return l5.warn("Experiment does not exist."),t_.of(r,tM.EXPERIMENT_NOT_FOUND);var s=p6.of(i,e,o,r),u=this.experimentInternal(s),a=u[0],c=u[1];return this.eventFactory.create(s,a).forEach(function(t){return n.eventProcessor.process(t)}),c},t.prototype.experiments=function(t){var e=this,r=new eH(function(t,e){return t.id===e.id}),n=this.workspaceFetcher.get();return n&&n.getExperiments().forEach(function(i){var o=p6.of(n,t,i,"A"),s=e.experimentInternal(o);s[0];var u=s[1];r.add(i,u)}),r},t.prototype.experimentInternal=function(t){var e,r=this.experimentEvaluator.evaluate(t,p3.create()),n=null!==(e=r.config)&&void 0!==e?e:new ts,i=t_.of(r.variationKey,r.reason,n,r.experiment);return[r,i]},t.prototype.featureFlag=function(t,e){var r=this;if(!t)return l5.error("featureKey must not be empty"),tA.off(tM.INVALID_INPUT);var n=this.workspaceFetcher.get();if(!n)return l5.warn("SDK not ready."),tA.off(tM.SDK_NOT_READY);var i=n.getFeatureFlagOrNull(t);if(!i)return l5.warn("FeatureFlag does not exist."),tA.off(tM.FEATURE_FLAG_NOT_FOUND);var o=p6.of(n,e,i,"A"),s=this.featureFlagInternal(o),u=s[0],a=s[1];return this.eventFactory.create(o,u).forEach(function(t){return r.eventProcessor.process(t)}),a},t.prototype.featureFlags=function(t){var e=this,r=new eH(function(t,e){return t.id===e.id}),n=this.workspaceFetcher.get();return n&&n.getFeatureFlags().forEach(function(i){var o=p6.of(n,t,i,"A"),s=e.featureFlagInternal(o);s[0];var u=s[1];r.add(i,u)}),r},t.prototype.featureFlagInternal=function(t){var e,r=this.experimentEvaluator.evaluate(t,p3.create()),n=null!==(e=r.config)&&void 0!==e?e:new ts,i="A"===r.variationKey?tA.off(r.reason,n,r.experiment):tA.on(r.reason,n,r.experiment);return[r,i]},t.prototype.inAppMessage=function(t,e,r){var n=r.evaluate(t,e);return r.record(t,n),n},t.prototype.track=function(t,e,r){if(void 0===r&&(r=new Date().getTime()),!t){l5.warn("event must not be null.");return}if("object"!=typeof t){l5.warn("Event must be event type.");return}if("object"==typeof t&&(!t.key||"string"!=typeof t.key)){l5.warn("Event key must be not null. or event key must be string type.");return}var n,i=(null===(n=this.workspaceFetcher.get())||void 0===n?void 0:n.getEventTypeOrNull(t.key))||new tx(0,t.key);this.eventProcessor.process(pJ.track(i,t,e,r))},t.prototype.trackException=function(t,e){if(!this.errorDedupDeterminer.isDedupTarget(t)){var r=p$.toEvent(t);this.flush(),this.track(r,e),this.flush()}},t.prototype.flush=function(t){void 0===t&&(t=!1),this.eventProcessor.flush(t)},t.prototype.remoteConfig=function(t,e,r,n){var i=this,o=this.workspaceFetcher.get();if(B.isNullOrUndefined(o))return l5.warn("SDK not ready."),tN.of(n,tM.SDK_NOT_READY);var s=o.getRemoteConfigParameterOrNull(t);if(B.isNullOrUndefined(s))return l5.warn("Remote config parameter does not exist."),tN.of(n,tM.REMOTE_CONFIG_PARAMETER_NOT_FOUND);var u=p5.of(o,e,s,r,n),a=this.remoteConfigEvaluator.evaluate(u,p3.create());return this.eventFactory.create(u,a).forEach(function(t){return i.eventProcessor.process(t)}),tN.of(a.value,a.reason)},t.prototype.close=function(){this.eventProcessor.close()},t}(),l8=function(){function t(){}return t.prototype.isDedupTarget=function(t){return!!this._isSameError(t,this.previous)||(this.previous=t,!1)},t.prototype._isSameError=function(t,e){return!B.isNullOrUndefined(e)&&t.name===e.name&&t.message===e.message&&t.stack===e.stack},t}(),l7=function(){function t(){this._installed=[],this._installations={onerror:fe,onunhandledrejection:fr}}return t.prototype.install=function(t,e){this._install("onerror",t,e),this._install("onunhandledrejection",t,e)},t.prototype._install=function(t,e,r){t in this._installed||((0,this._installations[t])(e,r),this._installed.push(t))},t}(),ft=null;function fe(t,e){ft=window.onerror,window.onerror=function(r,n,i,o,s){B.isNotNullOrUndefined(s)&&t.trackException(s,e.resolve()),ft&&ft.apply(this,arguments)}}function fr(t,e){L=window.onunhandledrejection,window.onunhandledrejection=function(r){var n;try{"reason"in r?n=r.reason:"detail"in r&&"reason"in r.detail&&(n=r.detail.reason)}catch(t){}n instanceof Error&&t.trackException(n,e.resolve()),L&&L.apply(this,arguments)}}var fn=function(){function t(t,e,r){this.storage=t,this.storageKey=e,this.maxSize=r}return t.prototype.read=function(){return X(this,void 0,void 0,function(){var t;return $(this,function(e){return(t=this.storage.getItem(this.storageKey))?[2,JSON.parse(t)]:[2,[]]})})},t.prototype.save=function(t){return X(this,void 0,void 0,function(){var e;return $(this,function(r){return 0===t.length?[2,this.clear()]:(e=JSON.stringify(t.slice(-this.maxSize)),this.storage.setItem(this.storageKey,e),[2])})})},t.prototype.add=function(t){return X(this,void 0,void 0,function(){var e;return $(this,function(r){switch(r.label){case 0:return[4,this.read()];case 1:return e=r.sent(),[4,this.save(e.concat(t).slice(-this.maxSize))];case 2:return r.sent(),[2]}})})},t.prototype.delete=function(t){return X(this,void 0,void 0,function(){var e,r=this;return $(this,function(n){switch(n.label){case 0:return[4,this.read()];case 1:return e=n.sent().filter(function(e){return!r.isDeleteTarget(e,t)}),[4,this.save(e)];case 2:return n.sent(),[2]}})})},t.prototype.isDeleteTarget=function(t,e){return e.some(function(e){return e.insertId===t.insertId})},t.prototype.clear=function(){return X(this,void 0,void 0,function(){return $(this,function(t){return this.storage.removeItem(this.storageKey),[2]})})},t}(),fi=function(t,e){return null!==t&&t.userId===e.userId&&t.deviceId===e.deviceId},fo=function(){function t(t){this.cohorts=t}return t.builder=function(){return new fs},t.empty=function(){return t.builder().build()},t.from=function(e){return new t(e)},t.fromDto=function(e){for(var r=t.builder(),n=0,i=e.cohorts;n<i.length;n++){var o=i[n];r.put({identifier:o.identifier,cohorts:o.cohorts.map(function(t){return new eD(t)})})}return r.build()},Object.defineProperty(t.prototype,"rawCohorts",{get:function(){return this.cohorts.values().flatMap(function(t){return t.cohorts})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){return this.cohorts.get(t)},t.prototype.filterBy=function(e){var r=tD(e),n=this.asComparable().filter(function(t,e){return r[t.type]===t.value});return t.from(n)},t.prototype.asArray=function(){return this.cohorts.values()},t.prototype.asComparable=function(){return this.cohorts},t.prototype.toBuilder=function(){return new fs(this)},t}(),fs=function(){function t(t){this.cohorts=new eH(tt.isEqual),t&&this.putAll(t)}return t.prototype.put=function(t){return this.cohorts.add(t.identifier,t),this},t.prototype.putAll=function(t){var e=this;return t.asArray().forEach(function(t){return e.put(t)}),this},t.prototype.build=function(){return new fo(this.cohorts)},t}(),fu="model",fa="name",fc="type",fp="vendor",fl="version",ff="architecture",fh="console",fd="mobile",fv="tablet",fy="smarttv",fg="wearable",fm=function(){function t(){}return t.parse=function(e){return{browser:t.getBrowser(e),cpu:t.getCPU(e),device:t.getDevice(e),engine:t.getEngine(e),os:t.getOS(e)}},t.getBrowser=function(e){var r={name:void 0,version:void 0,major:void 0};return t.mapper.rgx.call(r,e,t.regexes.browser),r.major=t.util.major(r.version),r},t.getCPU=function(e){var r={architecture:void 0};return t.mapper.rgx.call(r,e,t.regexes.cpu),r},t.getDevice=function(e){var r={model:void 0,type:void 0,vendor:void 0};return t.mapper.rgx.call(r,e,t.regexes.device),r},t.getEngine=function(e){var r={name:void 0,version:void 0};return t.mapper.rgx.call(r,e,t.regexes.os),r},t.getOS=function(e){var r={name:void 0,version:void 0};return t.mapper.rgx.call(r,e,t.regexes.os),r},t.util={extend:function(t,e){var r={};for(var n in t)e[n]&&e[n].length%2==0?r[n]=e[n].concat(t[n]):r[n]=t[n];return r},has:function(t,e){return"string"==typeof t&&-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()},major:function(t){return"string"==typeof t?t.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},t.mapper={rgx:function(t,e){for(var r,n,i,o,s,u,a=0;a<e.length&&!s;){var c=e[a],p=e[a+1];for(r=n=0;r<c.length&&!s;)if(s=c[r++].exec(t))for(i=0;i<p.length;i++)u=s[++n],"object"==typeof(o=p[i])&&o.length>0?2==o.length?"function"==typeof o[1]?this[o[0]]=o[1].call(this,u):this[o[0]]=o[1]:3==o.length?"function"!=typeof o[1]||o[1].exec&&o[1].test?this[o[0]]=u?u.replace(o[1],o[2]):void 0:this[o[0]]=u?o[1].call(this,u,o[2]):void 0:4==o.length&&(this[o[0]]=u?o[3].call(this,u.replace(o[1],o[2])):void 0):this[o]=u||void 0;a+=2}},str:function(e,r){for(var n in r)if("object"==typeof r[n]&&r[n].length>0){for(var i=0;i<r[n].length;i++)if(t.util.has(r[n][i],e))return"?"===n?void 0:n}else if(t.util.has(r[n],e))return"?"===n?void 0:n;return e}},t.maps={browser:{oldsafari:{version:{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},t.regexes={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[fa,fl],[/(opios)[\/\s]+([\w\.]+)/i],[[fa,"Opera Mini"],fl],[/\s(opr)\/([\w\.]+)/i],[[fa,"Opera"],fl],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[fa,fl],[/(konqueror)\/([\w\.]+)/i],[[fa,"Konqueror"],fl],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[fa,"IE"],fl],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[fa,"Edge"],fl],[/(yabrowser)\/([\w\.]+)/i],[[fa,"Yandex"],fl],[/(Avast)\/([\w\.]+)/i],[[fa,"Avast Secure Browser"],fl],[/(AVG)\/([\w\.]+)/i],[[fa,"AVG Secure Browser"],fl],[/(puffin)\/([\w\.]+)/i],[[fa,"Puffin"],fl],[/(focus)\/([\w\.]+)/i],[[fa,"Firefox Focus"],fl],[/(opt)\/([\w\.]+)/i],[[fa,"Opera Touch"],fl],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[fa,"UCBrowser"],fl],[/(comodo_dragon)\/([\w\.]+)/i],[[fa,/_/g," "],fl],[/(windowswechat qbcore)\/([\w\.]+)/i],[[fa,"WeChat(Win) Desktop"],fl],[/(micromessenger)\/([\w\.]+)/i],[[fa,"WeChat"],fl],[/(brave)\/([\w\.]+)/i],[[fa,"Brave"],fl],[/(whale)\/([\w\.]+)/i],[[fa,"Whale"],fl],[/(qqbrowserlite)\/([\w\.]+)/i],[fa,fl],[/(QQ)\/([\d\.]+)/i],[fa,fl],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[fa,fl],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[fa,fl],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[fa,fl],[/(MetaSr)[\/\s]?([\w\.]+)/i],[fa],[/(LBBROWSER)/i],[fa],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[fl,[fa,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[fl,[fa,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[fa,fl],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[fl,[fa,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[fa,/(.+)/,"$1 WebView"],fl],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[fa,/(.+(?:g|us))(.+)/,"$1 $2"],fl],[/((?:android.+)crmo|crios)\/([\w\.]+)/i,/android.+(chrome)\/([\w\.]+)\s+(?:mobile\s?safari)/i],[[fa,"Chrome Mobile"],fl],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[fl,[fa,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[fa,"Sailfish Browser"],fl],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[fa,fl],[/(dolfin)\/([\w\.]+)/i],[[fa,"Dolphin"],fl],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[fa,"360 Browser"]],[/(coast)\/([\w\.]+)/i],[[fa,"Opera Coast"],fl],[/fxios\/([\w\.-]+)/i],[fl,[fa,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[fl,[fa,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[fl,fa],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[fa,"GSA"],fl],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[fa,[fl,t.mapper.str,t.maps.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[fa,fl],[/(navigator|netscape)\/([\w\.-]+)/i],[[fa,"Netscape"],fl],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[fa,fl]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[ff,"amd64"]],[/(ia32(?=;))/i],[[ff,t.util.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[ff,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[ff,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[ff,/ower/,"",t.util.lowerize]],[/(sun4\w)[;\)]/i],[[ff,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[ff,t.util.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[fu,fp,[fc,fv]],[/applecoremedia\/[\w\.]+ \((ipad)/],[fu,[fp,"Apple"],[fc,fv]],[/(apple\s{0,1}tv)/i],[[fu,"Apple TV"],[fp,"Apple"],[fc,fy]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[fp,fu,[fc,fv]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[fu,[fp,"Amazon"],[fc,fv]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[fu,t.mapper.str,t.maps.device.amazon.model],[fp,"Amazon"],[fc,fd]],[/android.+aft([bms])\sbuild/i],[fu,[fp,"Amazon"],[fc,fy]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[fu,fp,[fc,fd]],[/\((ip[honed|\s\w*]+);/i],[fu,[fp,"Apple"],[fc,fd]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[fp,fu,[fc,fd]],[/\(bb10;\s(\w+)/i],[fu,[fp,"BlackBerry"],[fc,fd]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[fu,[fp,"Asus"],[fc,fv]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[fp,"Sony"],[fu,"Xperia Tablet"],[fc,fv]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[fu,[fp,"Sony"],[fc,fd]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[fp,fu,[fc,fh]],[/android.+;\s(shield)\sbuild/i],[fu,[fp,"Nvidia"],[fc,fh]],[/(playstation\s[34portablevi]+)/i],[fu,[fp,"Sony"],[fc,fh]],[/(sprint\s(\w+))/i],[[fp,t.mapper.str,t.maps.device.sprint.vendor],[fu,t.mapper.str,t.maps.device.sprint.model],[fc,fd]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[fp,[fu,/_/g," "],[fc,fd]],[/(nexus\s9)/i],[fu,[fp,"HTC"],[fc,fv]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29)/i],[fu,[fp,"Huawei"],[fc,fd]],[/android.+(bah2?-a?[lw]\d{2})/i],[fu,[fp,"Huawei"],[fc,fv]],[/(microsoft);\s(lumia[\s\w]+)/i],[fp,fu,[fc,fd]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[fu,[fp,"Microsoft"],[fc,fh]],[/(kin\.[onetw]{3})/i],[[fu,/\./g," "],[fp,"Microsoft"],[fc,fd]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[fu,[fp,"Motorola"],[fc,fd]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[fu,[fp,"Motorola"],[fc,fv]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[fp,t.util.trim],[fu,t.util.trim],[fc,fy]],[/hbbtv.+maple;(\d+)/i],[[fu,/^/,"SmartTV"],[fp,"Samsung"],[fc,fy]],[/\(dtv[\);].+(aquos)/i],[fu,[fp,"Sharp"],[fc,fy]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[fp,"Samsung"],fu,[fc,fv]],[/smart-tv.+(samsung)/i],[fp,[fc,fy],fu],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[fp,"Samsung"],fu,[fc,fd]],[/sie-(\w*)/i],[fu,[fp,"Siemens"],[fc,fd]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[fp,"Nokia"],fu,[fc,fd]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[fu,[fp,"Acer"],[fc,fv]],[/android.+([vl]k\-?\d{3})\s+build/i],[fu,[fp,"LG"],[fc,fv]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[fp,"LG"],fu,[fc,fv]],[/(lg) netcast\.tv/i],[fp,fu,[fc,fy]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[fu,[fp,"LG"],[fc,fd]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[fp,fu,[fc,fv]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[fu,[fp,"Lenovo"],[fc,fv]],[/(lenovo)[_\s-]?([\w-]+)/i],[fp,fu,[fc,fd]],[/linux;.+((jolla));/i],[fp,fu,[fc,fd]],[/((pebble))app\/[\d\.]+\s/i],[fp,fu,[fc,fg]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[fp,fu,[fc,fd]],[/crkey/i],[[fu,"Chromecast"],[fp,"Google"],[fc,fy]],[/android.+;\s(glass)\s\d/i],[fu,[fp,"Google"],[fc,fg]],[/android.+;\s(pixel c)[\s)]/i],[fu,[fp,"Google"],[fc,fv]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[fu,[fp,"Google"],[fc,fd]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[fu,/_/g," "],[fp,"Xiaomi"],[fc,fd]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[fu,/_/g," "],[fp,"Xiaomi"],[fc,fv]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[fu,[fp,"Meizu"],[fc,fd]],[/(mz)-([\w-]{2,})/i],[[fp,"Meizu"],fu,[fc,fd]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[fu,[fp,"OnePlus"],[fc,fd]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[fu,[fp,"RCA"],[fc,fv]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[fu,[fp,"Dell"],[fc,fv]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[fu,[fp,"Verizon"],[fc,fv]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[fp,"Barnes & Noble"],fu,[fc,fv]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[fu,[fp,"NuVision"],[fc,fv]],[/android.+;\s(k88)\sbuild/i],[fu,[fp,"ZTE"],[fc,fv]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[fu,[fp,"Swiss"],[fc,fd]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[fu,[fp,"Swiss"],[fc,fv]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[fu,[fp,"Zeki"],[fc,fv]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[fp,"Dragon Touch"],fu,[fc,fv]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[fu,[fp,"Insignia"],[fc,fv]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[fu,[fp,"NextBook"],[fc,fv]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[fp,"Voice"],fu,[fc,fd]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[fp,"LvTel"],fu,[fc,fd]],[/android.+;\s(PH-1)\s/i],[fu,[fp,"Essential"],[fc,fd]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[fu,[fp,"Envizen"],[fc,fv]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[fp,fu,[fc,fv]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[fu,[fp,"MachSpeed"],[fc,fv]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[fp,fu,[fc,fv]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[fu,[fp,"Rotor"],[fc,fv]],[/android.+(KS(.+))\s+build/i],[fu,[fp,"Amazon"],[fc,fv]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[fp,fu,[fc,fv]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[fc,t.util.lowerize],fp,fu],[/[\s\/\(](smart-?tv)[;\)]/i],[[fc,fy]],[/(android[\w\.\s\-]{0,9});.+build/i],[fu,[fp,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[fl,[fa,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[fl,[fa,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[fa,fl],[/rv\:([\w\.]{1,9}).+(gecko)/i],[fl,fa]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[fa,fl],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[[fa,t.mapper.str,t.maps.os.windows],[fl,t.mapper.str,t.maps.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[fa,"Windows"],[fl,t.mapper.str,t.maps.os.windows.version]],[/\((bb)(10);/i],[[fa,"BlackBerry"],fl],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[fa,fl],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[fa,"Symbian"],fl],[/\((series40);/i],[fa],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[fa,"Firefox OS"],fl],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[[fa,"Linux"],fl],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[fa,"Chromium OS"],fl],[/(sunos)\s?([\w\.\d]*)/i],[[fa,"Solaris"],fl],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[[fa,"Linux"],fl],[/(iphone)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[fa,"iOS"],[fl,/_/g,"."]],[/(ipad)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[fa,"iOS"],[fl,/_/g,"."]],[/(haiku)\s(\w+)/i],[fa,fl],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[fl,/_/g,"."],[fa,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[fa,"Mac"],[fl,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[fa,fl]]},t}(),fE=function(){function t(){}return t.generate=function(t,e){i=void 0===t?{navigator:{userAgent:"",vendor:"",languages:[]},screen:{width:"",height:""}}:t;var r,n,i,o=fm.parse(i.navigator.userAgent).browser,s="";try{s=null!==(n=null===(r=screen.orientation.type.match(/\b(landscape|portrait)\b/))||void 0===r?void 0:r[0])&&void 0!==n?n:""}catch(t){}return W({browserName:o.name||"",browserMajorVersion:o.major||"",browserVersion:o.version||"",orientation:s,userAgent:i.navigator.userAgent||""},e.toProperties())},t}(),fw=function(){function t(){}return t.generate=function(t){u=void 0===t?{navigator:{userAgent:"",vendor:"",languages:[]},screen:{width:"",height:""}}:t;var e,r,n,i,o,s,u,a=fm.parse(u.navigator.userAgent),c=a.os,p=a.device,l=u.screen,f=(null===(e=u.navigator.languages)||void 0===e?void 0:e[0])||"",h=f.split("-")[0],d=(null!==(r=p.type)&&void 0!==r?r:"pc").replace(/\b(mobile|smarttv)\b/g,function(t,e){return"mobile"===e?"phone":"smarttv"===e?"tv":t}),v=c.name||"",y="";try{v=null!==(i=null===(n=v.match(/\b(Mac|Windows|Linux|Android|iOS)\b/))||void 0===n?void 0:n[0])&&void 0!==i?i:v,orientation=null!==(s=null===(o=l.orientation.type.match(/\b(landscape|portrait)\b/))||void 0===o?void 0:o[0])&&void 0!==s?s:"",y=Intl.DateTimeFormat().resolvedOptions().timeZone||""}catch(t){}return{osName:v,osVersion:c.version||"",deviceModel:p.model||"",deviceType:d,deviceVendor:p.vendor||"",deviceBrand:p.vendor||"",screenWidth:l.width||"",screenHeight:l.height||"",locale:f,language:h,timeZone:y}},t}(),fT=function(){function t(){}return t.generate=function(t,e){var r=null!=e?e:rI.createWithCurrentPage();return W(W({platform:"Web"},fE.generate(t,r)),fw.generate(t))},t}(),fb=function(){function t(t,e){this.previous=t,this.current=e}return t.prototype.map=function(e){return new t(e(this.previous),e(this.current))},t}(),fI=function(){function t(t){this.events=t}return t.empty=function(){return this.from([])},t.from=function(e){return new t(e)},t.fromDto=function(t){return this.from(t.events.map(function(t){return eV.fromJson(t)}))},Object.defineProperty(t.prototype,"rawEvents",{get:function(){return this.events},enumerable:!1,configurable:!0}),t}(),fN=function(){function t(t,e,r,n,i,o,s,u,a){this.hackleDeviceId=t,this.storage=e,this.userTargetFetcher=r,this.userCohortFetcher=n,this.campaignParser=i,this.pageManager=o,this.clock=s,this.userListeners=[],this.defaultUser={id:this.hackleDeviceId,deviceId:this.hackleDeviceId},this.context=this.initContext(u,a),this.storage.saveUser(this.context.user)}return t.prototype.initContext=function(t,e){var r,n=null!==(r=null!=e?e:t)&&void 0!==r?r:this.defaultUser;return fA.of(fO(n,this.hackleDeviceId),fo.empty(),fI.empty())},t.prototype.addListener=function(t){this.userListeners.push(t)},Object.defineProperty(t.prototype,"currentUser",{get:function(){return this.context.user},enumerable:!1,configurable:!0}),t.prototype.resolve=function(t){var e=this.resolveContext(t);return this.hackleUser(e)},t.prototype.resolveContext=function(t){return void 0===t?this.context:"string"==typeof t?this.updateUser({id:t}).current:this.updateUser(t).current},t.prototype.toHackleUser=function(t){var e=this.context.with(t);return this.hackleUser(e)},t.prototype.hackleUser=function(t){var e=new tL().addIdentifiers(t.user.identifiers||{}).add(tk.ID,t.user.id||this.hackleDeviceId).add(tk.DEVICE,t.user.deviceId||this.hackleDeviceId).add(tk.HACKLE_DEVICE,this.hackleDeviceId);B.isNotNullOrUndefined(t.user.userId)&&e.add(tk.USER,t.user.userId);var r=e.build(),n=this.campaignParser.parse();return{identifiers:r,properties:W(W({},n),t.user.properties),hackleProperties:this.hackleProperties(),cohorts:t.cohorts.rawCohorts,targetEvents:t.targetEvents.rawEvents}},t.prototype.hackleProperties=function(){var t;return"undefined"!=typeof window?fT.generate(window,this.pageManager.currentPage):t||{}},t.prototype.setUser=function(t){return this.updateUser(t).map(function(t){return t.user})},t.prototype.setUserId=function(t){var e=W(W({},this.context.user),{userId:t});return this.setUser(e)},t.prototype.setDeviceId=function(t){var e=W(W({},this.context.user),{deviceId:t});return this.setUser(e)},t.prototype.updateUserProperties=function(t){return this.operateProperties(t).map(function(t){return t.user})},t.prototype.resetUser=function(){var t=this;return this.updateContext(function(){return t.defaultUser}).map(function(t){return t.user})},t.prototype.changeUser=function(t,e,r){this.userListeners.forEach(function(n){n.onUserUpdated(t,e,r)})},t.prototype.saveUser=function(t){this.storage.saveUser(t)},t.prototype.updateContext=function(t){var e=this.context,r=e.user,n=t(r),i=this.context.with(n);return this.context=i,fi(r,n)||(this.changeUser(r,n,this.clock.currentMillis()),this.saveUser(n)),new fb(e,i)},t.prototype.updateUser=function(t){var e=this;return this.updateContext(function(r){var n;return fi(r,n=fO(t,e.hackleDeviceId))?W(W({},n),{properties:W(W({},r.properties),n.properties)}):n})},t.prototype.operateProperties=function(t){return this.updateContext(function(e){var r,n=null!==(r=e.properties)&&void 0!==r?r:{},i=t.operate(new Map(Object.entries(n)));return W(W({},e),{properties:B.fromMap(i)})})},t.prototype.sync=function(){return X(this,void 0,void 0,function(){return $(this,function(t){switch(t.label){case 0:return[4,Promise.all([this.syncCohort(),this.syncUserTarget()])];case 1:return t.sent(),[2]}})})},t.prototype.syncIfNeeded=function(t){return X(this,void 0,void 0,function(){return $(this,function(e){switch(e.label){case 0:if(!this.hasNewIdentifiers(t.previous,t.current))return[3,2];return[4,this.syncCohort()];case 1:e.sent(),e.label=2;case 2:if(fi(t.previous,t.current))return[3,4];return[4,this.syncUserTarget()];case 3:e.sent(),e.label=4;case 4:return[2]}})})},t.prototype.syncCohort=function(){return X(this,void 0,void 0,function(){var t,e;return $(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.userCohortFetcher.fetch(this.currentUser)];case 1:return t=r.sent(),this.context=this.context.update(t,this.context.targetEvents),[3,3];case 2:return e=r.sent(),J.log.error("Failed to sync cohorts: ".concat(e)),[3,3];case 3:return[2]}})})},t.prototype.syncUserTarget=function(){return X(this,void 0,void 0,function(){var t,e;return $(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.userTargetFetcher.fetch(this.currentUser)];case 1:return t=r.sent(),this.context=this.context.update(this.context.cohorts,t),[3,3];case 2:return e=r.sent(),J.log.error("Failed to sync userTargets: ".concat(e)),[3,3];case 3:return[2]}})})},t.prototype.hasNewIdentifiers=function(t,e){var r=tD(t);return Object.entries(tD(e)).some(function(t){var e=t[0],n=t[1];return r[e]!==n})},t.prototype.close=function(){return X(this,void 0,void 0,function(){return $(this,function(t){return[2]})})},t}(),f_=function(){function t(t){this.storage=t}return t.prototype.getUser=function(){var t=this.deviceId||void 0,e=this.userId||void 0;return void 0!==t||void 0!==e?{deviceId:t,userId:e}:null},t.prototype.saveUser=function(t){this.setDeviceId(t.deviceId||null),this.setUserId(t.userId||null)},Object.defineProperty(t.prototype,"deviceId",{get:function(){return this.storage.getItem(tg)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userId",{get:function(){return this.storage.getItem(ty)},enumerable:!1,configurable:!0}),t.prototype.setDeviceId=function(t){this.setId(tg,t)},t.prototype.setUserId=function(t){this.setId(ty,t)},t.prototype.setId=function(t,e){B.isNotNullOrUndefined(e)?this.storage.setItem(t,e):this.storage.removeItem(t)},t}(),fA=function(){function t(t,e,r){this.user=t,this.cohorts=e,this.targetEvents=r}return t.of=function(e,r,n){return new t(e,r.filterBy(e),n)},t.prototype.with=function(e){return t.of(e,this.cohorts.filterBy(e),this.targetEvents)},t.prototype.update=function(e,r){var n=e.filterBy(this.user),i=this.cohorts.toBuilder().putAll(n).build();return t.of(this.user,i,r)},t}(),fO=function(t,e){return W(W({},t),{id:t.id||e,deviceId:t.deviceId||e})},fM=function(){function t(t,e){this.sessionTimeoutMillis=t,this.storage=e,this.sessionListeners=[],this._currentSessionId=null,this._lastEventTime=null,this.loadSession(),this.loadLastEventTime()}return Object.defineProperty(t.prototype,"currentSessionId",{get:function(){return this._currentSessionId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionId",{get:function(){var e;return null!==(e=this._currentSessionId)&&void 0!==e?e:t.EMPTY_SESSION_ID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastEventTime",{get:function(){return this._lastEventTime},enumerable:!1,configurable:!0}),t.prototype.addListener=function(t){this.sessionListeners.push(t)},t.prototype.startNewSession=function(t,e,r){return t&&this.endSession(t),this.newSession(e,r)},t.prototype.startNewSessionIfNeeded=function(t,e){var r=this._lastEventTime;return null===r?this.startNewSession(t,t,e):null!==this._currentSessionId&&e-r<this.sessionTimeoutMillis?(this.updateLastEventTime(e),this._currentSessionId):this.startNewSession(t,t,e)},t.prototype.updateLastEventTime=function(t){this._lastEventTime=t,this.storage.setItem(tv,"".concat(t))},t.prototype.endSession=function(t){var e=this._currentSessionId,r=this._lastEventTime;null!==e&&null!==r&&this.sessionListeners.forEach(function(n){return n.onSessionEnded(e,t,r)})},t.prototype.newSession=function(t,e){var r="".concat(e,".").concat((0,K.Z)().slice(0,8));return this.saveSession(r),this.updateLastEventTime(e),this.sessionListeners.forEach(function(n){n.onSessionStarted(r,t,e)}),r},t.prototype.saveSession=function(t){this._currentSessionId=t,this.storage.setItem(td,t)},t.prototype.loadSession=function(){this._currentSessionId=this.storage.getItem(td)},t.prototype.loadLastEventTime=function(){var t=this.storage.getItem(tv);if(null!==t){var e=Number.parseFloat(t);e>0&&(this._lastEventTime=e)}},t.prototype.onUserUpdated=function(t,e,r){this.endSession(t),this.newSession(e,r)},t.prototype.onLifecycleChanged=function(t,e){switch(t){case"hidden":case"pagehide":return this.updateLastEventTime(e);case"blur":case"focus":case"locationChange":case"visible":case"pageshow":return}},t.EMPTY_SESSION_ID="0.ffffffff",t}(),fP=function(){function t(){this.storage=window.localStorage}return t.prototype.getItem=function(t){var e,r;return null!==(r=null===(e=this.storage)||void 0===e?void 0:e.getItem(t))&&void 0!==r?r:null},t.prototype.removeItem=function(t){var e;null===(e=this.storage)||void 0===e||e.removeItem(t)},t.prototype.setItem=function(t,e){var r;null===(r=this.storage)||void 0===r||r.setItem(t,e)},t.prototype.clear=function(){var t;null===(t=this.storage)||void 0===t||t.clear()},t}(),fS=function(){function t(t,e){this.delegate=t,this.transform=e}return t.postfix=function(e,r){return new t(e,function(t){return"".concat(t).concat(r)})},t.prefix=function(e,r){return new t(e,function(t){return"".concat(r).concat(t)})},t.prototype.getItem=function(t){return this.delegate.getItem(this.transform(t))},t.prototype.removeItem=function(t){this.delegate.removeItem(this.transform(t))},t.prototype.setItem=function(t,e){this.delegate.setItem(this.transform(t),e)},t}(),fR=function(){function t(t,e,r){void 0===r&&(r=4096);var n=this;this.delegate=t,this.listKey=e,this.encodedListCharLen=6,this.resolveMaxLength=function(t){var e=t-n.encodedListCharLen;return e<0?0:e},this.maxLength=this.resolveMaxLength(r)}return t.prototype.isEqualItem=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.prototype.getRemainListSize=function(){try{return this.maxLength-JSON.stringify(this.getList()).length}catch(t){return 0}},t.prototype.isAddableItem=function(t){try{return this.getRemainListSize()>JSON.stringify(t).length}catch(t){return!1}},t.prototype.getVictimIndex=function(t){var e=this.getRemainListSize();try{var r=JSON.stringify(t),n=this.getList(),i=0;return n.findIndex(function(t){return(i+=JSON.stringify(t).length)+e>=r.length})}catch(t){return -1}},t.prototype.getList=function(){try{var t=this.delegate.getItem(this.listKey);if(!t)return[];var e=JSON.parse(t);if(!Array.isArray(e))return[];return e}catch(t){return[]}},t.prototype.entries=function(){return this.getList().flatMap(Object.entries)},t.prototype.setItem=function(t,e){var r;try{this.removeItem(t);var n=this.getList(),i=((r={})[t]=e,r);if(!this.isAddableItem(i)){var o=this.getVictimIndex(i);if(o<0)return;n=n.slice(o+1)}var s=JSON.stringify(n.concat(i));this.delegate.setItem(this.listKey,s)}catch(t){}},t.prototype.getItem=function(t){var e=this,r=this.getList().find(function(r){return e.isEqualItem(r,t)});if(r&&r[t])return r[t]},t.prototype.removeItem=function(t){var e=this,r=this.getList();try{var n=r.filter(function(r){return!e.isEqualItem(r,t)}),i=JSON.stringify(n);this.delegate.setItem(this.listKey,i)}catch(t){}},t.prototype.clear=function(){this.delegate.removeItem(this.listKey)},t}(),fU=function(){function t(t,e,r,n){this.core=t,this.userManager=e,this.abOverrideStorage=r,this.ffOverrideStorage=n}return t.prototype.currentUser=function(){return this.userManager.resolve()},t.prototype.getAbTestDecisions=function(){return this.core.experiments(this.currentUser()).entries()},t.prototype.getAbTestOverrides=function(){return this.abOverrideStorage.getAll()},t.prototype.setAbTestOverride=function(t,e){this.abOverrideStorage.set(t,e),this.increment("AB_TEST","set")},t.prototype.resetAbTestOverride=function(t){this.abOverrideStorage.remove(t),this.increment("AB_TEST","reset")},t.prototype.resetAllAbTestOverride=function(){this.abOverrideStorage.clear(),this.increment("AB_TEST","reset.all")},t.prototype.getFeatureFlagDecisions=function(){return this.core.featureFlags(this.currentUser()).entries()},t.prototype.getFeatureFlagOverrides=function(){return this.ffOverrideStorage.getAll()},t.prototype.setFeatureFlagOverride=function(t,e){this.ffOverrideStorage.set(t,e),this.increment("FEATURE_FLAG","set")},t.prototype.resetFeatureFlagOverride=function(t){this.ffOverrideStorage.remove(t),this.increment("FEATURE_FLAG","reset")},t.prototype.resetAllFeatureFlagOverride=function(){this.ffOverrideStorage.clear(),this.increment("FEATURE_FLAG","reset.all")},t.prototype.increment=function(t,e){e3.counter("experiment.manual.override",{"experiment.type":t,operation:e}).increment()},t}(),fC=function(){function t(){}return t.serverFetch=function(t,e){return"".concat(t,"/api/v2/workspaces/").concat(e,"/config")},t.clientFetch=function(t,e){return"".concat(t,"/api/v2/workspaces/").concat(e,"/config")},t.userCohorts=function(t){return"".concat(t,"/api/v1/cohorts")},t.serverDispatch=function(t){return"".concat(t,"/api/v2/events")},t.clientDispatch=function(t){return"".concat(t,"/api/v2/w/events")},t.beaconDispatch=function(t,e){return"".concat(t,"/api/v2/w/").concat(e,"/events")},t.inAppMessageRenderer=function(t,e){return"".concat(t,"/sdk/iam-renderer/").concat(e,"/iam-renderer.js")},t.monitoring=function(t){return"".concat(t,"/metrics")},t.userTargets=function(t){return"".concat(t,"/api/v1/user-targets")},t}(),fx=function(){function t(t){this.storage=t}return t.prototype.exist=function(t,e){var r=this.key(t),n=this.storage.getItem(r);if(B.isNullOrUndefined(n))return!1;var i=Number.parseInt(n,10);return Number.isNaN(i)?(this.storage.removeItem(r),!1):e<=i||(this.storage.removeItem(r),!1)},t.prototype.put=function(t,e){this.storage.setItem(this.key(t),"".concat(e))},t.prototype.key=function(t){return"".concat(t.key)},t}(),fk=function(){function t(t){this.handlers=t}return t.prototype.get=function(t){return this.handlers.find(function(e){return e.supports(t)})},t}(),fD=function(){function t(){}return t.prototype.handle=function(t,e){t.close()},t.prototype.supports=function(t){return"CLOSE"===t.type},t}(),fL=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){J.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"WEB_LINK"===t.type},t}(),fF=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){t.close();try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){J.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_AND_CLOSE"===t.type},t}(),fV=function(){function t(t,e){this.storage=t,this.clock=e}return t.prototype.handle=function(t,e){if(t.context.decisionReason===tM.OVERRIDDEN){t.close();return}var r=this.clock.currentMillis()+864e5;this.storage.put(t.context.inAppMessage,r),t.close()},t.prototype.supports=function(t){return"HIDDEN"===t.type},t}(),fK=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){J.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_NEW_WINDOW"===t.type},t}(),fG=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){t.close();try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){J.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_NEW_WINDOW_AND_CLOSE"===t.type},t}(),fB=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){J.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_NEW_TAB"===t.type},t}(),fH=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){t.close();try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){J.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_NEW_TAB_AND_CLOSE"===t.type},t}(),fj=function(){function t(t){this.core=t}return t.prototype.track=function(t,e,r){var n=this.createTrackEvent(e,t);this.core.track(n,t.user,r)},t.prototype.commonProperties=function(t){return W(W({},t.properties),{in_app_message_id:t.inAppMessage.id,in_app_message_key:t.inAppMessage.key,in_app_message_display_type:t.message.layout.displayType,decision_reason:String(t.decisionReason)})},t.prototype.createTrackEvent=function(t,e){var r,n,i,o;switch(t.type){case"IMPRESSION":return{key:"$in_app_impression",properties:W(W({},this.commonProperties(e)),{title_text:null===(n=null===(r=e.message.text)||void 0===r?void 0:r.title)||void 0===n?void 0:n.text,body_text:null===(o=null===(i=e.message.text)||void 0===i?void 0:i.body)||void 0===o?void 0:o.text,button_text:e.message.buttons.map(function(t){return t.text}),image_url:e.message.images.map(function(t){return t.imagePath})})};case"CLOSE":return{key:"$in_app_close",properties:this.commonProperties(e)};case"ACTION":return{key:"$in_app_action",properties:W(W({},this.commonProperties(e)),{action_type:t.action.type,action_area:t.area,action_value:t.action.value,button_text:t.buttonText,image_url:t.imageUrl,image_order:t.imageOrder})};case"IMAGE_IMPRESSION":return{key:"$in_app_image_impression",properties:W(W({},this.commonProperties(e)),{image_url:t.imageUrl,image_order:t.imageOrder})}}},t}(),fJ=function(){function t(t,e,r,n){void 0===n&&(n=null),this.messageViewFactory=t,this.eventHandler=e,this.interactionHandlerFactory=r,this.inAppMessageListener=n,this.currentMessageView=null,this.opening=!1}return t.prototype.setListener=function(t){this.inAppMessageListener=t},t.prototype.present=function(t){return X(this,void 0,void 0,function(){var e;return $(this,function(r){switch(r.label){case 0:if(this.currentMessageView||this.opening)return[2];this.opening=!0,e=null,r.label=1;case 1:if(r.trys.push([1,3,4,5]),null===(e=this.messageViewFactory.create(t,this)))return[2];return this.currentMessageView=e,[4,e.open()];case 2:return r.sent(),[3,5];case 3:return r.sent(),null==e||e.close(),[3,5];case 4:return this.opening=!1,[7];case 5:return[2]}})})},t}(),fz=function(){function t(e,r,n,i,o,s){var u=this;this.scriptLoader=e,this.context=r,this.ui=n,this.renderTypeResolver=i,this.status=o,this.lifecycleRegistry=s,this.container=null,this.renderer=null,this.resolveLifecycleEnd=function(t){if(t instanceof CustomEvent&&"string"==typeof t.detail.id&&["OPEN","CLOSE"].includes(t.detail.type)){var e=t.detail,r=e.id,n=e.type,i=u.lifecycleRegistry.getAndRemove(n,r);null==i||i()}},this.handleInAppMessageInteraction=function(e){if(e instanceof CustomEvent&&e.type===t.HACKLE_IAM_INTERACTION_EVENT_TYPE){var r=e.detail;u.handleInteraction(r)}}}return t.prototype.open=function(){var e,r;return X(this,void 0,void 0,function(){var n,i,o,s,u=this;return $(this,function(a){switch(a.label){case 0:if(!this.status.canOpen())return J.log.debug("InAppMessage is already opened. (key=".concat(this.context.inAppMessage.key,")")),[2];n=r_.toPublic(this.context.inAppMessage),a.label=1;case 1:return a.trys.push([1,4,,5]),null===(r=null===(e=this.ui.inAppMessageListener)||void 0===e?void 0:e.beforeInAppMessageOpen)||void 0===r||r.call(e,n),this.status.current="OPENING",window.addEventListener(t.HACKLE_IAM_INTERACTION_EVENT_TYPE,this.handleInAppMessageInteraction),window.addEventListener(t.HACKLE_IAM_LIFECYCLE_END_EVENT_TYPE,this.resolveLifecycleEnd),[4,this.scriptLoader.load()];case 2:return a.sent(),(i=this.addContainer()).style.display="none",i.classList.add("".concat(t.CONTAINER_CLASS_NAME,"--loading")),o=window.HackleInAppMessageRenderer,this.renderer=new o.HackleInAppMessageRenderer(i),s=this.renderTypeResolver.resolve(this.context),[4,this.renderer.render({messageId:this.context.inAppMessage.id,message:this.context.message.toJson(),renderType:s})];case 3:return a.sent(),i.classList.remove("".concat(t.CONTAINER_CLASS_NAME,"--loading")),i.style.display="block",this.handleInAppMessageLifecycle("OPEN",function(){var t,e;u.handleEvent({type:"IMPRESSION"}),u.status.current="OPENED",null===(e=null===(t=u.ui.inAppMessageListener)||void 0===t?void 0:t.afterInAppMessageOpen)||void 0===e||e.call(t,n)},function(){J.log.warn("Failed to open inAppMessage with [Timeout expired.]"),u.destroy()}),[3,5];case 4:return a.sent(),this.destroy(),[3,5];case 5:return[2]}})})},t.prototype.close=function(){var t,e,r=this;if(!this.status.canClose()){J.log.debug("InAppMessage is already closed. (key=".concat(this.context.inAppMessage.key,")"));return}var n=r_.toPublic(this.context.inAppMessage);null===(e=null===(t=this.ui.inAppMessageListener)||void 0===t?void 0:t.beforeInAppMessageClose)||void 0===e||e.call(t,n),this.status.current="CLOSING",this.handleInAppMessageLifecycle("CLOSE",function(){var t,e;r.handleEvent({type:"CLOSE"}),r.destroy(),null===(e=null===(t=r.ui.inAppMessageListener)||void 0===t?void 0:t.afterInAppMessageClose)||void 0===e||e.call(t,n)},function(){var t,e;J.log.warn("Failed to close inAppMessage with [Timeout expired.]"),r.destroy(),null===(e=null===(t=r.ui.inAppMessageListener)||void 0===t?void 0:t.afterInAppMessageClose)||void 0===e||e.call(t,n)})},t.prototype.handleInAppMessageLifecycle=function(e,r,n){var i=this,o=this.lifecycleRegistry.register(e,r);window.dispatchEvent(new CustomEvent(t.HACKLE_IAM_LIFECYCLE_START_EVENT_TYPE,{detail:{type:e,id:o}})),setTimeout(function(){void 0!==i.lifecycleRegistry.getAndRemove(e,o)&&n()},t.LIFE_CYCLE_EVENT_LISTEN_TIMEOUT)},t.prototype.destroy=function(){var e;window.removeEventListener(t.HACKLE_IAM_INTERACTION_EVENT_TYPE,this.handleInAppMessageInteraction),window.removeEventListener(t.HACKLE_IAM_LIFECYCLE_END_EVENT_TYPE,this.resolveLifecycleEnd),null===(e=this.renderer)||void 0===e||e.destroy(),this.renderer=null,this.removeContainer(),this.ui.currentMessageView=null,this.status.current="CLOSED"},t.prototype.addContainer=function(){if(!this.container){var e=document.createElement("div");e.classList.add(t.CONTAINER_CLASS_NAME),this.container=e}return this.container.parentNode||document.body.appendChild(this.container),this.container},t.prototype.removeContainer=function(){var t;this.container&&(null===(t=this.container.parentNode)||void 0===t||t.removeChild(this.container),this.container=null)},t.prototype.handleInteraction=function(t){var e=this.ui.interactionHandlerFactory.get(t);e&&e.handle(this,t)},t.prototype.handleEvent=function(t){this.ui.eventHandler.handle(this,t)},t.HACKLE_IAM_INTERACTION_EVENT_TYPE="hackle-iam-interaction",t.HACKLE_IAM_LIFECYCLE_START_EVENT_TYPE="hackle-iam-lifecycle-start",t.HACKLE_IAM_LIFECYCLE_END_EVENT_TYPE="hackle-iam-lifecycle-end",t.CONTAINER_CLASS_NAME="hackle-iam",t.LIFE_CYCLE_EVENT_LISTEN_TIMEOUT=5e3,t}(),fq=function(){function t(){this.mobileOSRegex=/(iOS|Android|iPad|iPhone)/g,this.mobileDeviceRegex=/(mobile|phone|tablet)/g}return t.prototype.isMobileOS=function(t){var e=t.user.hackleProperties.osName;return"string"==typeof e&&!!e.match(this.mobileOSRegex)},t.prototype.isMobileDeviceType=function(t){var e=t.user.hackleProperties.deviceType;return"string"==typeof e&&!!e.match(this.mobileDeviceRegex)},t.prototype.resolve=function(t){return this.isMobileOS(t)||this.isMobileDeviceType(t)?"mobile":"pc"},t}(),fY=function(){function t(t){void 0===t&&(t="CLOSED"),this.current=t}return t.prototype.canOpen=function(){return"OPENED"!==this.current&&"OPENING"!==this.current},t.prototype.canClose=function(){return"CLOSED"!==this.current&&"CLOSING"!==this.current},t}(),fW=function(){function t(){this.record={}}return t.prototype.resolveKey=function(t,e){return"".concat(t,"_").concat(e)},t.prototype.register=function(t,e){var r=(0,K.Z)(),n=this.resolveKey(t,r);return this.record[n]=e,r},t.prototype.getAndRemove=function(t,e){var r=this.resolveKey(t,e),n=this.record,i=n[r],o=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}(n,["symbol"==typeof r?r:r+""]);return this.record=o,i},t}(),fX=function(){function t(t){this.scriptLoader=t}return t.create=function(e){return new t(e)},t.prototype.create=function(t,e){var r=new fq,n=new fY,i=new fW;switch(t.message.layout.displayType){case"MODAL":case"BANNER":case"BOTTOM_SHEET":return new fz(this.scriptLoader,t,e,r,n,i);case"NONE":return null}},t}(),f$=function(){function t(t){this.scriptUrl=t}return t.prototype.load=function(){return X(this,void 0,void 0,function(){var t;return $(this,function(e){switch(e.label){case 0:if(window.HackleInAppMessageRenderer)return[2];return t=this.createScript(),document.head.appendChild(t),[4,this.waitForLoad(t)];case 1:return[2,e.sent()]}})})},t.prototype.createScript=function(){var t=document.createElement("script");return t.type="text/javascript",t.async=!0,t.src=this.scriptUrl,t},t.prototype.waitForLoad=function(t){return new Promise(function(e,r){var n=function(){o(),e(t)},i=function(t){o(),r(t.message)},o=function(){t.removeEventListener("error",i),t.removeEventListener("load",n)};t.addEventListener("load",n),t.addEventListener("error",i)})},t}(),fZ=function(){function t(t){this.targetMatcher=t}return t.prototype.matches=function(t,e,r){var n=this;return e.eventTrigger.rules.some(function(i){return n.ruleMatches(t,r,e,i)})},t.prototype.ruleMatches=function(t,e,r,n){if(e.event.key!==n.eventKey)return!1;var i=fQ.of(t,e,r);return this.targetMatcher.anyMatches(i,p3.create(),n.targets)},t}(),fQ=function(){function t(t,e,r,n){this.key=t,this.workspace=e,this.user=r,this.event=n}return t.of=function(e,r,n){return new t(new p4("IN_APP_MESSAGE",n.id),e,r.user,r)},t}(),f0=function(){function t(t){this.storage=t}return t.prototype.get=function(t){var e=this.storage.getItem(t.id.toString());return B.isNullOrUndefined(e)?[]:JSON.parse(e)},t.prototype.set=function(t,e){this.storage.setItem(t.id.toString(),JSON.stringify(e))},t}(),f1=function(){function t(t){this.processors=t}return t.prototype.get=function(t){return this.processors.find(function(e){return e.supports(t)})},t}(),f2=function(){function t(){}return t.prototype.process=function(t,e,r){},t.prototype.supports=function(t){return"IMPRESSION"===t.type},t}(),f4=function(){function t(){}return t.prototype.process=function(t,e,r){},t.prototype.supports=function(t){return"CLOSE"===t.type},t}(),f3=function(){function t(t){this.actionHandlerFactory=t}return t.prototype.process=function(t,e,r){var n,i,o=this.actionHandlerFactory.get(e.action);!(null===(i=null===(n=t.ui.inAppMessageListener)||void 0===n?void 0:n.onInAppMessageClick)||void 0===i?void 0:i.call(n,r_.toPublic(t.context.inAppMessage),rA.toPublic(t),ek.fromAction(e.action)))&&t.status.canClose()&&(null==o||o.handle(t,e.action))},t.prototype.supports=function(t){return"ACTION"===t.type},t}(),f6=function(){function t(t,e,r){this.clock=t,this.eventTracker=e,this.eventProcessorFactory=r}return t.prototype.handle=function(t,e){var r=this.clock.currentMillis();this.eventTracker.track(t.context,e,r);var n=this.eventProcessorFactory.get(e);n&&n.process(t,e,r)},t}(),f5=function(){function t(t){this.ruleMatcher=t}return t.prototype.matches=function(t,e,r){return this.ruleMatcher.matches(t,e,r)},t}(),f9=function(){function t(t){this.handlers=t}return t.prototype.get=function(t){return this.handlers.find(function(e){return e.supports(t)})},t}(),f8=function(){function t(){}return t.prototype.handle=function(t,e){t.close()},t.prototype.supports=function(t){return"CLOSE"===t.type},t}(),f7=function(){function t(t){this.eventHandler=t}return t.prototype.handle=function(t,e){var r=this.eventOrNull(e);r&&this.eventHandler.handle(t,r)},t.prototype.eventOrNull=function(t){var e=eR.fromJson(t.action);return e?{type:"ACTION",action:e,area:t.area,buttonText:t.buttonText,imageUrl:t.imageUrl,imageOrder:t.imageOrder}:null},t.prototype.supports=function(t){return"ACTION"===t.type},t}(),ht=function(){function t(t){this.eventHandler=t}return t.prototype.handle=function(t,e){var r={type:"IMAGE_IMPRESSION",imageUrl:e.imageUrl,imageOrder:e.imageOrder};this.eventHandler.handle(t,r)},t.prototype.supports=function(t){return"IMAGE_IMPRESSION"===t.type},t}(),he=function(){function t(){}return t.prototype.open=function(t){window.location.href=t.href},t}(),hr=function(){function t(){}return t.prototype.open=function(t){window.open(t.href,"Hackle","resizable:true")},t}(),hn=function(){function t(){}return t.prototype.open=function(t){window.open(t.href)},t}(),hi=function(){function t(){}return t.prototype.open=function(t){window.location.replace(t)},t}(),ho={utm_campaign:void 0,utm_content:void 0,utm_id:void 0,utm_medium:void 0,utm_source:void 0,utm_term:void 0,gclid:void 0,fbclid:void 0},hs={current:void 0,referrer:void 0},hu=function(t,e){return Object.keys(ho).every(function(r){return t[r]===e[r]})},ha=function(t,e){for(var r=0,n=Object.entries(t);r<n.length;r++){var i=n[r],o=i[0],s=i[1];e6.isNotEmptyString(s)&&e.searchParams.set(o,s)}return e},hc=function(){function t(t,e,r,n){this.storage=t,this.parser=e,this.core=r,this.userManager=n}return t.prototype.startNewCampaign=function(t,e,r){for(var n=W(W({},ho),e),i=new rw,o=0,s=Object.entries(n);o<s.length;o++){var u=s[o],a=u[0],c=u[1];c?i.set(a,c):i.unset(a)}var p=i.build(),l=p.toEvent(),f=this.userManager.toHackleUser(t);this.core.track(l,f,r),this.userManager.updateUserProperties(p)},t.prototype.startNewCampaignIfNeeded=function(t,e){var r,n=this.storage.get(),i=this.parser.parse();r=this.parser.parseDomain(),(null===n?0:hu(i,ho)&&r.current===r.referrer||hu(n,i))||(this.storage.set(i),this.startNewCampaign(t,i,e))},t.prototype.onSessionEnded=function(t,e,r){},t.prototype.onSessionStarted=function(t,e,r){this.startNewCampaignIfNeeded(e,r)},t}(),hp=function(){function t(t){this.storage=t}return t.prototype.get=function(){var t=this.storage.getItem(tm);return t?JSON.parse(t):null},t.prototype.set=function(t){this.storage.setItem(tm,JSON.stringify(t))},t}(),hl=function(){function t(t){this.search=t}return t.prototype.getQueryParam=function(t){return this.getQueryParams(function(){return!0})[t]||""},t.prototype.getQueryParams=function(t){for(var e={},r=this.search.substring(1).split("&"),n=0;n<r.length;n++){var i=r[n].split("="),o=i[0],s=i[1];if(!t||t(o,s)){var u=rR.tryDecodeURIComponent(s);u&&(e[o]=u)}}return e},t}(),hf=function(){function t(){}return t.extractDomain=function(t){var e=this.DOMAIN_MATCH_REGEX,r=t.split("."),n=r[r.length-1];(n.length>4||"com"===n||"org"===n)&&(e=this.SIMPLE_DOMAIN_MATCH_REGEX);var i=t.match(e);return i?i[0]:t},t.DOMAIN_MATCH_REGEX=/[a-z0-9][a-z0-9-]+\.[a-z.]{2,6}$/i,t.SIMPLE_DOMAIN_MATCH_REGEX=/[a-z0-9][a-z0-9-]*\.[a-z]+$/i,t}(),hh=function(){function t(t){this.pageManager=t}return t.prototype.parse=function(t){var e=this.params(t);return this.resolve(e)},t.prototype.params=function(e){return new hl(B.isNotNullOrUndefined(e)?e:this.pageManager.currentPage.queryParameter).getQueryParams(t.CAMPAIGN_QUERY_CONDITION)},t.prototype.resolve=function(t){return{utm_campaign:t[hd],utm_content:t[hv],utm_id:t[hy],utm_medium:t[hg],utm_source:t[hm],utm_term:t[hE],gclid:t[hw],fbclid:t[hT]}},t.prototype.parseDomain=function(){var t=this;return"undefined"==typeof window?hs:{current:hf.extractDomain(this.pageManager.currentPage.hostname),referrer:function(){var e=t.pageManager.currentPage.referrer;if(e){var r=new URL(e).hostname;return hf.extractDomain(r)}}()}},t.CAMPAIGN_QUERY_CONDITION=function(t,e){return e6.isNotEmptyString(e)},t}(),hd="utm_campaign",hv="utm_content",hy="utm_id",hg="utm_medium",hm="utm_source",hE="utm_term",hw="gclid",hT="fbclid",hb=function(){function t(t,e){var r=this;this.userEventEmitter=t,this.determiner=e,this.onEvent=function(t){var e=r.determiner.determineTargetExposureOrNull(t);e&&r.send(e)},this.initialize()}return t.prototype.initialize=function(){this.userEventEmitter.on("event",this.onEvent)},t.prototype.send=function(t){var e=t.experiment.key,r=t.variationKey,n="HACKLE-EXPERIMENT_".concat(e,"_V").concat(t.experiment.version,"-").concat(r);try{window.gtag("event","experience_impression",{exp_variant_string:n})}catch(t){J.log.error("Unexpected exception while sending an event to Google Analytics with gtag: ".concat(t))}},t}(),hI=function(){function t(t){this.workspaceFetcher=t}return t.prototype.determineTargetExposureOrNull=function(t){var e=this.workspaceFetcher.get();return e&&e.getAttributes().integration_ga_experiment&&pJ.isExposureEvent(t)&&"RUNNING"===t.experiment.status&&t.decisionReason===tM.TRAFFIC_ALLOCATED?t:null},t}(),hN={user:void 0,debug:!1,log_disabled:!1,automaticPageTracking:!0,pollingIntervalMillis:-1,exposureEventDedupIntervalMillis:6e4,sessionTimeoutMillis:18e5,autoOpenDevTool:!1,sdkUrl:"https://sdk-api.hackle.io",eventUrl:"https://event-api.hackle.io",monitoringUrl:"https://monitoring.hackle.io",cdnUrl:"https://static.hackle.io",sameSiteCookie:"LAX",secureCookie:!1,SDK_NAME_HEADER:"javascript-sdk_browser",SDK_VERSION_HEADER:"11.49.2",IAM_RENDERER_VERSION_HEADER:"0.0.12"},h_=function(){function t(){}return t.config=function(e){return W(W(W({},hN),e),{automaticPageTracking:t.resolveAutomaticPageTracking(e)})},t.resolveAutomaticPageTracking=function(t){return"boolean"!=typeof(null==t?void 0:t.automaticPageTracking)&&"boolean"!=typeof(null==t?void 0:t.auto_track_page_view)?hN.automaticPageTracking:!!t.automaticPageTracking||!!t.auto_track_page_view},t.logging=function(t){J.initCounter(function(t){return e3.counter("log",{level:t})}),J.setLogLevel(j.INFO),t.log_disabled?J.setLogLevel(j.DISABLE):t.debug&&J.setLogLevel(j.DEBUG)},t.sdk=function(t,e){return J.log.debug("SDK key: ".concat(t)),t||J.log.error("invalid sdk key: '".concat(t,"' (expected: not null, not undefined and not empty string)")),{key:t,name:e.SDK_NAME_HEADER,version:e.SDK_VERSION_HEADER}},t.isBeaconSupported=function(){var t=!1;return"undefined"!=typeof window&&(t=window&&window.navigator&&!!window.navigator.sendBeacon&&!0)&&J.log.debug("support sendBeacon API"),t},t.pollingIntervalMillis=function(t){return void 0===t.pollingIntervalMillis||"number"!=typeof t.pollingIntervalMillis||t.pollingIntervalMillis<=0?-1:Math.max(t.pollingIntervalMillis,6e4)},t.dedupIntervalMillis=function(t){return void 0===t.exposureEventDedupIntervalMillis||"number"!=typeof t.exposureEventDedupIntervalMillis?6e4:t.exposureEventDedupIntervalMillis<1e3||t.exposureEventDedupIntervalMillis>36e5?(J.log.warn("Exposure event dedup interval is outside allowed range[1_000ms..3_600_000ms]. Setting to default value[1m]."),6e4):t.exposureEventDedupIntervalMillis},t}(),hA=function(){function t(){this.synchronizers=[]}return t.prototype.add=function(t){this.synchronizers.push(t)},t.prototype.sync=function(){return X(this,void 0,void 0,function(){var t=this;return $(this,function(e){switch(e.label){case 0:return[4,Promise.all(this.synchronizers.map(function(e){return t.safe(e.sync())}))];case 1:return e.sent(),[2]}})})},t.prototype.close=function(){return X(this,void 0,void 0,function(){var t=this;return $(this,function(e){switch(e.label){case 0:return[4,Promise.all(this.synchronizers.map(function(e){return t.safe(e.close())}))];case 1:return e.sent(),[2]}})})},t.prototype.safe=function(t){return X(this,void 0,void 0,function(){var e;return $(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t];case 1:return r.sent(),[3,3];case 2:return e=r.sent(),J.log.error("Failed to sync: ".concat(e)),[3,3];case 3:return[2]}})})},t}(),hO=function(){function t(t,e,r){this.delegate=t,this.scheduler=e,this.intervalMillis=r,this.pollingJob=null}return t.prototype.sync=function(){return X(this,void 0,void 0,function(){var t;return $(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.delegate.sync()];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),J.log.error("Failed to sync: ".concat(t)),[3,3];case 3:return[2]}})})},t.prototype.start=function(){var t=this;-1!==this.intervalMillis&&null===this.pollingJob&&(this.pollingJob=this.scheduler.schedulePeriodically(this.intervalMillis,this.intervalMillis,function(){return t.sync()}))},t.prototype.stop=function(){var t;-1!==this.intervalMillis&&(null===(t=this.pollingJob)||void 0===t||t.cancel(),this.pollingJob=null)},t.prototype.close=function(){return X(this,void 0,void 0,function(){return $(this,function(t){switch(t.label){case 0:return this.stop(),[4,this.delegate.close()];case 1:return t.sent(),[2]}})})},t}(),hM=function(){function t(t){this.scheduleType=t}return t.prototype.schedule=function(t,e){var r=new hP(t,e);return r.start(),r},t.prototype.schedulePeriodically=function(t,e,r){var n;switch(this.scheduleType){case"setTimeout":n=new hS(t,e,r);break;case"setInterval":n=new hR(t,e,r)}return n.start(),n},t}(),hP=function(){function t(t,e){this.delayMillis=t,this.task=e,this.timeout=null}return t.prototype.start=function(){var t=this;this.timeout=setTimeout(function(){try{t.task()}catch(t){J.log.error("Failed to run task: ".concat(t))}finally{t.timeout=null}},this.delayMillis)},t.prototype.cancel=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},t}(),hS=function(){function t(t,e,r){this.delayMillis=t,this.intervalMillis=e,this.task=r,this.timeout=null}return t.prototype.start=function(){var t=this;this.timeout=setTimeout(function(){return t.run()},this.delayMillis)},t.prototype.run=function(){var t=this;try{this.task()}catch(t){J.log.error("Failed to run task: ".concat(t))}this.timeout=setTimeout(function(){return t.run()},this.intervalMillis)},t.prototype.cancel=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},t}(),hR=function(){function t(t,e,r){this.delayMillis=t,this.intervalMillis=e,this.task=r,this.timeout=null,this.interval=null}return t.prototype.start=function(){var t=this;this.timeout=setTimeout(function(){t.run(),t.interval=setInterval(function(){return t.run()},t.intervalMillis)},this.delayMillis)},t.prototype.run=function(){try{this.task()}catch(t){J.log.error("Failed to run task: ".concat(t))}},t.prototype.cancel=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.interval&&(clearInterval(this.interval),this.interval=null)},t}(),hU=function(){function t(t,e){this.url=t,this.transport=e}return t.prototype.fetchIfModified=function(t){return X(this,void 0,void 0,function(){var e,r;return $(this,function(n){switch(n.label){case 0:return e=this.createRequest(t),[4,this.execute(e)];case 1:return r=n.sent(),[2,this.handleResponse(r)]}})})},t.prototype.createRequest=function(t){var e=e5.builder().url(this.url).method("GET");return null!==t&&e.addHeader(e7.IF_MODIFIED_SINCE,t),e.build()},t.prototype.execute=function(t){return X(this,void 0,void 0,function(){var e,r,n;return $(this,function(i){switch(i.label){case 0:e=eG.start(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.transport.send(t)];case 2:return r=i.sent(),rn.record("get.workspace",e,r),[2,r];case 3:throw n=i.sent(),rn.record("get.workspace",e,null),n;case 4:return[2]}})})},t.prototype.handleResponse=function(t){if(t.isNotModified())return null;if(!t.isSuccessful())throw Error("Http status code: ".concat(t.statusCode));if(null===t.body)throw Error("Response body is empty");return{config:JSON.parse(t.body),lastModified:t.headers.get(e7.LAST_MODIFIED)}},t}(),hC=function(){function t(t,e){this.url=t,this.transport=e}return t.prototype.fetch=function(t){return X(this,void 0,void 0,function(){var e,r;return $(this,function(n){switch(n.label){case 0:return e=this.createRequest(t),[4,this.execute(e)];case 1:return r=n.sent(),[2,this.handleResponse(r)]}})})},t.prototype.createRequest=function(t){var e={identifiers:tD(t)},r=G.DS.encodeURL(JSON.stringify(e));return e5.builder().url(this.url).method("GET").addHeader("X-HACKLE-USER",r).build()},t.prototype.execute=function(t){return X(this,void 0,void 0,function(){var e,r,n;return $(this,function(i){switch(i.label){case 0:e=eG.start(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.transport.send(t)];case 2:return r=i.sent(),rn.record("get.cohorts",e,r),[2,r];case 3:throw n=i.sent(),rn.record("get.cohorts",e,null),n;case 4:return[2]}})})},t.prototype.handleResponse=function(t){if(!t.isSuccessful())throw Error("Http status code: ".concat(t.statusCode));if(null===t.body)throw Error("Response body is null");var e=JSON.parse(t.body);return fo.fromDto(e)},t}(),hx=function(){function t(t,e){this.url=t,this.transport=e}return t.prototype.fetch=function(t){return X(this,void 0,void 0,function(){var e,r;return $(this,function(n){switch(n.label){case 0:return e=this.createRequest(t),[4,this.execute(e)];case 1:return r=n.sent(),[2,this.handleResponse(r)]}})})},t.prototype.createRequest=function(t){var e={identifiers:tD(t)},r=G.DS.encodeURL(JSON.stringify(e));return e5.builder().url(this.url).method("GET").addHeader("X-HACKLE-USER",r).build()},t.prototype.execute=function(t){return X(this,void 0,void 0,function(){var e,r,n;return $(this,function(i){switch(i.label){case 0:e=eG.start(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.transport.send(t)];case 2:return r=i.sent(),rn.record("get.user-targets",e,r),[2,r];case 3:throw n=i.sent(),rn.record("get.user-targets",e,null),n;case 4:return[2]}})})},t.prototype.handleResponse=function(t){if(!t.isSuccessful())throw Error("Http status code: ".concat(t.statusCode));if(null===t.body)throw Error("Response body is null");var e=JSON.parse(t.body);return fI.fromDto(e)},t}(),hk=function(){function t(t,e,r,n,i,o,s,u,a,c,p){this.experiments=H.associateBy(t,function(t){return t.key}),this.splitUrlExperiments=H.associateBy(e,function(t){return t.key}),this.featureFlags=H.associateBy(r,function(t){return t.key}),this.buckets=H.associateBy(n,function(t){return t.id}),this.eventTypes=H.associateBy(i,function(t){return t.key}),this.segments=H.associateBy(o,function(t){return t.key}),this.containers=H.associateBy(s,function(t){return t.id}),this.parameterConfigurations=H.associateBy(u,function(t){return t.id}),this.remoteConfigParameters=H.associateBy(a,function(t){return t.key}),this.inAppMessages=H.associateBy(c,function(t){return t.key}),this.attributes=p}return t.prototype.getExperiments=function(){return Array.from(this.experiments.values())},t.prototype.getSplitUrlExperiments=function(){return Array.from(this.splitUrlExperiments.values())},t.prototype.getFeatureFlags=function(){return Array.from(this.featureFlags.values())},t.prototype.getInAppMessages=function(){return Array.from(this.inAppMessages.values())},t.prototype.getExperimentOrNull=function(t){return this.experiments.get(t)},t.prototype.getFeatureFlagOrNull=function(t){return this.featureFlags.get(t)},t.prototype.getBucketOrNull=function(t){return this.buckets.get(t)},t.prototype.getEventTypeOrNull=function(t){return this.eventTypes.get(t)},t.prototype.getSegmentOrNull=function(t){return this.segments.get(t)},t.prototype.getContainerOrNull=function(t){return this.containers.get(t)},t.prototype.getParameterConfigurationOrNull=function(t){return this.parameterConfigurations.get(t)},t.prototype.getRemoteConfigParameterOrNull=function(t){return this.remoteConfigParameters.get(t)},t.prototype.getInAppMessageOrNull=function(t){return this.inAppMessages.get(t)},t.prototype.getAttributes=function(){return this.attributes},t.from=function(e){var r=e.parameterConfigurations.map(tO.fromJson);return new t(H.mapNotNullOrUndefined(e.experiments,function(t){return tS.fromJson("AB_TEST",t,r)}),H.mapNotNullOrUndefined(e.experiments,function(t){return tS.fromJson("AB_TEST",t,r)}).filter(function(t){return"SPLIT_URL"===t.implementationType}),H.mapNotNullOrUndefined(e.featureFlags,function(t){return tS.fromJson("FEATURE_FLAG",t,r)}),e.buckets.map(tU.fromJson),e.events.map(tx.fromJson),H.mapNotNullOrUndefined(e.segments,tJ.fromJson),e.containers.map(tz.fromJson),r,H.mapNotNullOrUndefined(e.remoteConfigParameters,tY.fromJson),H.mapNotNullOrUndefined(e.inAppMessages,eu.fromJson),e.workspace.attributes)},t}(),hD=function(){function t(t,e){this.workspaceConfigStorage=t,this.workspaceFetcher=e,this.workspace=null,this.lastModified=null;var r=this.workspaceConfigStorage.get();r&&this.setConfig(r)}return t.prototype.setConfig=function(t){this.setWorkspace(t),this.lastModified=t.lastModified},t.prototype.setWorkspace=function(t){try{this.workspace=hk.from(t.config)}catch(t){J.log.error("Failed to set workspace: ".concat(t))}},t.prototype.get=function(){return this.workspace},t.prototype.sync=function(){return X(this,void 0,void 0,function(){var t,e;return $(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.workspaceFetcher.fetchIfModified(this.lastModified)];case 1:return(t=r.sent())&&(this.setConfig(t),this.workspaceConfigStorage.set(t)),[3,3];case 2:return e=r.sent(),J.log.error("Failed to sync workspace: ".concat(e)),[3,3];case 3:return[2]}})})},t.prototype.close=function(){return X(this,void 0,void 0,function(){return $(this,function(t){return[2]})})},t}(),hL=function(){function t(t,e,r){this.transport=t,this.synchronousTransport=e,this.retryManager=r}return t.prototype.dispatch=function(t,e){var r=t.map(function(t){return t.toDto()});return e?this.dispatchEventsSynchronously(r):this.dispatchEvents(r)},t.prototype.dispatchEventsSynchronously=function(t){return X(this,void 0,void 0,function(){var e;return $(this,function(r){switch(r.label){case 0:return[4,this.retryManager.add(t)];case 1:return r.sent(),[4,this.synchronousTransport.send(t)];case 2:if(!((e=r.sent()).isSuccessful()||e.isClientError()))return[3,4];return[4,this.retryManager.delete(t)];case 3:r.sent(),r.label=4;case 4:return[2]}})})},t.prototype.dispatchEvents=function(t){return X(this,void 0,void 0,function(){var e;return $(this,function(r){switch(r.label){case 0:return[4,this.transport.send(t)];case 1:if((e=r.sent()).isSuccessful()||e.isClientError())return[2];return[4,this.retryManager.add(t)];case 2:return r.sent(),[2]}})})},t}(),hF=function(){function t(t,e){this.url=t,this.transport=e}return t.prototype.send=function(t){var e=this.createRequest(t);return this.execute(e)},t.prototype.createRequest=function(t){var e,r,n,i=(e=[],r=[],n=[],t.forEach(function(t){t instanceof pJ?pJ.isExposureEvent(t)?e.push(t.toDto()):pJ.isTrackEvent(t)?r.push(t.toDto()):pJ.isRemoteConfigEvent(t)&&n.push(t.toDto()):pJ.isExposureEventDto(t)?e.push(t):pJ.isTrackEventDto(t)?r.push(t):pJ.isRemoteConfigEventDto(t)&&n.push(t)}),{exposureEvents:e,trackEvents:r,remoteConfigEvents:n});return e5.builder().url(this.url).method("POST").addHeader("Content-Type","application/json").body(JSON.stringify(i)).build()},t.prototype.execute=function(t){return X(this,void 0,void 0,function(){var e,r,n;return $(this,function(i){switch(i.label){case 0:e=eG.start(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.transport.send(t)];case 2:return r=i.sent(),rn.record("post.events",e,r),[2,r];case 3:throw n=i.sent(),rn.record("post.events",e,null),n;case 4:return[2]}})})},t}(),hV=function(){function t(t,e){this.repository=t,this.transport=e}return t.prototype.add=function(t){return this.repository.add(t)},t.prototype.delete=function(t){return this.repository.delete(t)},t.prototype.flush=function(){return X(this,void 0,void 0,function(){var t,e;return $(this,function(r){switch(r.label){case 0:return[4,this.repository.read()];case 1:if(0===(t=r.sent()).length)return[2];return[4,this.transport.send(t)];case 2:if(!((e=r.sent()).isSuccessful()||e.isClientError()))return[3,4];return[4,this.delete(t)];case 3:r.sent(),r.label=4;case 4:return[2]}})})},t.prototype.onLifecycleChanged=function(t,e){switch(t){case"visible":case"pageshow":this.flush().catch(function(t){return J.log.warn("Failed to flush retry events: ".concat(t))});return;case"blur":case"focus":case"hidden":case"locationChange":case"pagehide":return}},t}(),hK=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.eventDispatcher=e,o.eventDispatchMaxSize=r,o.flushScheduler=n,o.flushIntervalMillis=i,o.queue=[],o.flushingJob=null,o}return Y(e,t),e.prototype.process=function(t){this.enqueue(t),this.emit("event",t)},e.prototype.enqueue=function(t){0===this.queue.length&&this.scheduleFlush(),this.queue.push(t),this.queue.length>=this.eventDispatchMaxSize&&this.flush()},e.prototype.scheduleFlush=function(){var t,e=this;null===(t=this.flushingJob)||void 0===t||t.cancel(),this.flushingJob=this.flushScheduler.schedule(this.flushIntervalMillis,function(){return e.flush()})},e.prototype.flush=function(t){var e;void 0===t&&(t=!1),null===(e=this.flushingJob)||void 0===e||e.cancel(),0!==this.queue.length&&(this.eventDispatcher.dispatch(this.queue,t).catch(function(t){return J.log.warn("Failed to dispatch events: ".concat(t))}),this.queue=[])},e.prototype.close=function(){this.flush(!0)},e}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Y(e,t),e}(function(){function t(){this.listeners={}}return t.prototype.on=function(t,e){this.listeners[t]=(this.listeners[t]||[]).concat(e)},t.prototype.off=function(t,e){this.listeners[t]=(this.listeners[t]||[]).filter(function(t){return t!==e})},t.prototype.emit=function(t,e){(this.listeners[t]||[]).forEach(function(t){t(e)})},t}())),hG=function(){function t(t,e,r){this.sdk=t,this.clock=e,this.delegate=r}return t.prototype.send=function(t){var e=t.toBuilder().addHeader(ta,this.sdk.key).addHeader(tc,this.sdk.name).addHeader(tp,this.sdk.version).addHeader(tl,this.clock.currentMillis().toString()).build();return this.delegate.send(e)},t}(),hB=function(){function t(){}return t.intercept=function(t,e){return e instanceof hG?e:new hG(t,to.instance,e)},t}(),hH=function(){function t(){}return t.create=function(){return new t},t.prototype.send=function(t){return new Promise(function(e,r){var n=new XMLHttpRequest;t.options.timeoutMillis&&(n.timeout=t.options.timeoutMillis),n.open(t.method,t.url),n.onreadystatechange=function(){if(n.readyState===n.DONE){if(0===n.status){r(Error("Request Error"));return}e(new e8(n.status,n.responseText,function(t){var e=e7.builder(),r=t.getAllResponseHeaders();if(!r)return e.build();for(var n=0,i=r.split("\r\n");n<i.length;n++){var o=i[n],s=o.indexOf(": ");if(s>0){var u=o.slice(0,s),a=o.slice(s+2);e.add(u,a)}}return e.build()}(n)))}},function(t,e){var r=e.headers.raw();for(var n in r)r.hasOwnProperty(n)&&t.setRequestHeader(n,r[n])}(n,t),n.send(t.body)})},t}(),hj=function(){function t(){}return t.create=function(){return new t},t.prototype.send=function(t){var e=this;return new Promise(function(r,n){var i=!1;if("undefined"!=typeof window&&(i=window&&window.navigator&&!!window.navigator.sendBeacon&&!0),!i)throw Error("BeaconTransport not supported.");var o=e.createBody(t);if(!window.navigator.sendBeacon(t.url,o))throw Error("Failed to sendBeacon");r(e8.ok())})},t.prototype.createBody=function(t){var e=new URLSearchParams,r=t.headers.get(ta);r&&e.append("sdkKey",r),e.append("sdkName",t.headers.getOrDefault(tc,"unknown")),e.append("sdkVersion",t.headers.getOrDefault(tp,"unknown"));var n=t.headers.get(tl);return n&&e.append("sdkTime",n),t.body&&e.append("data",t.body),e},t}(),hJ=function(){function t(t){this.invocationResponseResolver=t}return t.prototype.invoke=function(t){var e=window.prompt(JSON.stringify(t));return this.invocationResponseResolver.resolve(e)},t}(),hz=function(){function t(t){this.invocationResponseResolver=t}return t.prototype.invoke=function(t){if(!(null===(e=window._hackleApp)||void 0===e?void 0:e.invoke))throw Error("window._hackleApp.invoke is not implemented");var e,r=window._hackleApp.invoke(JSON.stringify(t));return this.invocationResponseResolver.resolve(r)},t}();(o=F||(F={})).prompt="prompt",o.function="function";var hq=function(){function t(){}return t.prototype.getInvocator=function(t,e){return t===F.prompt?new hJ(e):t===F.function?new hz(e):null},t}(),hY=function(){function t(t,e,r,n){this.determiner=t,this.redirector=e,this.userManager=r,this.core=n}return t.prototype.onPageStarted=function(t,e){var r=this.userManager.resolve(),n=this.determiner.determineOrNull(r);n&&(this.core.flush(!0),this.redirector.redirect(n))},t.prototype.onPageEnded=function(t,e){},t}(),hW=function(t,e,r,n){this.workspace=t,this.experiment=e,this.decision=r,this.user=n},hX=function(){function t(t,e,r,n){this.workspaceFetcher=t,this.splitUrlMatcher=e,this.splitUrlRedirectedCookieStorage=r,this.core=n}return t.prototype.determineOrNull=function(t){if(this.splitUrlRedirectedCookieStorage.alreadyRedirected())return this.splitUrlRedirectedCookieStorage.clear(),null;var e=this.workspaceFetcher.get();if(!e)return null;for(var r=0,n=e.getSplitUrlExperiments();r<n.length;r++){var i=n[r];if(this.splitUrlMatcher.matches(e,i,t)){var o=this.core.experiment(i.key,t,"A");return new hW(e,i,o,t)}}return null},t}(),h$=function(){function t(t){this.targetMatcher=t}return t.prototype.matches=function(t,e,r){if("SPLIT_URL"!==e.implementationType||!e.splitUrlTargets)return!1;var n=e.splitUrlTargets,i=hZ.of(t,r);return!(n.excludeTargets.length>0&&this.targetMatcher.anyMatches(i,p3.create(),n.excludeTargets))&&n.includeTargets.length>0&&this.targetMatcher.anyMatches(i,p3.create(),n.includeTargets)},t}(),hZ=function(){function t(t,e,r){this.key=t,this.user=e,this.workspace=r}return t.of=function(e,r){return new t(new p4("SPLIT_URL",(0,K.Z)()),r,e)},t}(),hQ=function(){function t(t,e,r,n){this.urlResolver=t,this.urlHandler=e,this.splitUrlRedirectedCookieStorage=r,this.initializeEventDispatcher=n}return t.prototype.redirect=function(t){var e=this.urlResolver.resolveOrNull(t);e&&(this.initializeEventDispatcher.setNeedDispatch(!1),this.splitUrlRedirectedCookieStorage.setRedirected(!0),this.urlHandler.open(e))},t}(),h0=function(){function t(t){this.campaignParser=t}return t.prototype.resolveOrNull=function(e){try{var r=JSON.parse(e.decision.get(t.SPLIT_URL_CONFIG_KEY,"")),n=eL.fromDto(r);if(!n.needRedirect)return null;return this.resolveByRedirectType(n.redirectType,n.redirectUrl,e)}catch(t){return null}},t.prototype.resolveByRedirectType=function(t,e,r){return e&&t===u.MANUAL?this.resolveManualRedirectUrl(e,r):null},t.prototype.resolveManualRedirectUrl=function(t,e){var r=rR.tryParse(t);return r?this.decorateCampaign(r,e):null},t.prototype.decorateCampaign=function(t,e){var r=e.user.hackleProperties.queryParameter;return e6.isNotEmptyString(r)?ha(this.campaignParser.parse(r),t):t},t.SPLIT_URL_CONFIG_KEY="redirectUrl",t}(),h1=function(){function t(t,e,r){this.storage=t,this.cookieKey=e,this.cookieStorageOptions=r}return t.prototype.alreadyRedirected=function(){try{var t=this.storage.getItem(this.cookieKey);if(B.isNullOrUndefined(t))return!1;return!!JSON.parse(t)}catch(t){return!1}},t.prototype.clear=function(){this.storage.removeItem(this.cookieKey)},t.prototype.setRedirected=function(t){this.storage.setItem(this.cookieKey,String(t),this.cookieStorageOptions)},t}(),h2=function(){function t(){this.needDispatch=!0}return t.prototype.setNeedDispatch=function(t){this.needDispatch=t},t.prototype.dispatchDoneEventIfNeeded=function(){this.needDispatch&&window.dispatchEvent(new CustomEvent(t.HACKLE_INITIALIZE_DONE_EVENT_TYPE))},t.HACKLE_INITIALIZE_DONE_EVENT_TYPE="hackle-initialize-done",t}(),h4=function(){function t(t,e){this.sdk=t,this.storage=e}return t.prototype.get=function(){var t=this.storage.getItem(tw);if(B.isNullOrUndefined(t))return null;try{var e=JSON.parse(t);if(this.sdk.version!==e.version)return this.clear(),null;return e}catch(t){return this.clear(),null}},t.prototype.set=function(t){var e=W(W({},t),{version:this.sdk.version});this.storage.setItem(tw,JSON.stringify(e))},t.prototype.clear=function(){this.storage.removeItem(tw)},t}(),h3=J.log,h6=function(){function t(t){void 0===t&&(t=to.instance),this.clock=t,this.listeners=[],this._initialized=!1}return t.prototype.install=function(e){void 0===e&&(e=null);try{var r,n,i=this.changeLifecycle.bind(this);window.addEventListener("pageshow",function(){return i("pageshow")}),window.addEventListener("pagehide",function(){return i("pagehide")}),document.addEventListener("visibilitychange",function(){return i(document.visibilityState)}),window.addEventListener("blur",function(){return i("blur")}),window.addEventListener("focus",function(){return i("focus")}),t.isSafariBrowser(e)&&window.addEventListener("beforeunload",function(){return i("hidden")}),history.pushState=(r=history.pushState,function(){try{var t=r.apply(history,arguments);return i("locationChange"),t}catch(t){(t instanceof Error||"string"==typeof t)&&h3.error(t)}}),history.replaceState=(n=history.replaceState,function(){try{var t=n.apply(history,arguments);return i("locationChange"),t}catch(t){(t instanceof Error||"string"==typeof t)&&h3.error(t)}}),window.addEventListener("popstate",function(){try{i("locationChange")}catch(t){(t instanceof Error||"string"==typeof t)&&h3.error(t)}})}catch(t){(t instanceof Error||"string"==typeof t)&&h3.error(t)}},t.prototype.addListener=function(t){this.listeners.push(t)},t.prototype.initialize=function(){this._initialized=!0,this.changeLifecycle("pageshow")},t.prototype.changeLifecycle=function(t){this._initialized&&this.publish(t)},t.prototype.publish=function(t){var e=this.clock.currentMillis();this.listeners.forEach(function(r){r.onLifecycleChanged(t,e)})},t.isSafariBrowser=function(t){return!B.isNullOrUndefined(t)&&t.toLowerCase().includes("safari")},t}(),h5=function(){function t(t){this.limiter=t}return t.create=function(e,r,n){return void 0===n&&(n=to.instance),new t(new h9(n,e,r))},t.prototype.execute=function(t,e){return this.limiter.tryAcquire()?t():e()},t}(),h9=function(){function t(t,e,r){this.clock=t,this.intervalMillis=e,this.limit=r,this.currentScope=null}return t.prototype.tryAcquire=function(){var t=this.clock.currentMillis();return this.refreshScopeIfNeeded(t).tryAcquire()},t.prototype.refreshScopeIfNeeded=function(t){return(null==this.currentScope||this.currentScope.isExpired(t))&&(this.currentScope=new h8(t+this.intervalMillis,this.limit)),this.currentScope},t}(),h8=function(){function t(t,e){this.expirationTime=t,this.token=e}return t.prototype.isExpired=function(t){return this.expirationTime<t},t.prototype.tryAcquire=function(){return this.token>0&&(this.token-=1,!0)},t}(),h7=function(){function t(t){this.determiners=t}return t.prototype.isDedupTarget=function(t){var e=this.determiners.find(function(e){return e.supports(t)});return!!e&&e.isDedupTarget(t)},t}(),dt=function(){function t(t,e){this.dedupIntervalMillis=t,this.clock=e,this.cache={},this.currentUser=null}return t.prototype.isDedupTarget=function(t){if(-1===this.dedupIntervalMillis)return!1;tt.isEquals(t.user.identifiers,null===(e=this.currentUser)||void 0===e?void 0:e.identifiers)||(this.currentUser=t.user,this.cache={});var e,r=this.cacheKey(t),n=this.clock.currentMillis(),i=this.cache[r];return void 0!==i&&n-i<=this.dedupIntervalMillis||(this.cache[r]=n,!1)},t}(),de=function(t){function e(e,r){return void 0===r&&(r=to.instance),t.call(this,e,r)||this}return Y(e,t),e.prototype.supports=function(t){return pJ.isRemoteConfigEvent(t)},e.prototype.cacheKey=function(t){return[t.parameter.id,t.valueId,t.decisionReason].join("-")},e}(dt),dr=function(t){function e(e,r){return void 0===r&&(r=to.instance),t.call(this,e,r)||this}return Y(e,t),e.prototype.supports=function(t){return pJ.isExposureEvent(t)},e.prototype.cacheKey=function(t){return[t.experiment.id,t.variationId,t.variationKey,t.decisionReason].join("-")},e}(dt),dn=function(){function t(){}return t.prototype.isInvocatorResponse=function(t){return"object"==typeof t&&null!==t&&"success"in t&&"boolean"==typeof t.success&&"message"in t&&"string"==typeof t.message},t.prototype.resolve=function(t){var e=JSON.parse(null!=t?t:"");if(!this.isInvocatorResponse(e))throw Error("invalid invocator response data");if(!e.success)throw Error("failed response");return{message:e.message,success:e.success,data:e.data}},t}(),di=function(){function t(t){this.invocator=t}return t.prototype.createInvocationRequestDto=function(t){return{_hackle:{command:t.command,parameters:t.parameters,browserProperties:t.browserProperties}}},t.prototype.process=function(t){var e,r=this.createInvocationRequestDto(t);return null!==(e=this.invocator.invoke(r).data)&&void 0!==e?e:null},t}(),ds=J.log,du=function(){function t(t,e){this.core=t,this.userManager=e}return t.prototype.onPageStarted=function(t,e){this.track(t,e)},t.prototype.onPageEnded=function(t,e){},t.prototype.track=function(e,r){ds.debug("tracking page view");var n,i={key:t.PAGE_VIEW_EVENT_KEY,properties:((n={})[t.PAGE_NAME_PROPERTY_KEY]=e.pageTitle,n)};this.core.track(i,this.userManager.resolve(),r)},t.PAGE_VIEW_EVENT_KEY="$page_view",t.PAGE_NAME_PROPERTY_KEY="$page_name",t}(),da=function(){function t(){this.listeners=[],this._currentPage=null}return Object.defineProperty(t.prototype,"currentPage",{get:function(){var t;return null!==(t=this._currentPage)&&void 0!==t?t:rI.createWithCurrentPage()},enumerable:!1,configurable:!0}),t.prototype.updatePage=function(t,e){var r=this._currentPage;r&&t.isEquals(r)||(r&&this.publishEnd(r,e),this._currentPage=t,this.publishStart(t,e))},t.prototype.publishStart=function(t,e){for(var r=0,n=this.listeners;r<n.length;r++)n[r].onPageStarted(t,e)},t.prototype.publishEnd=function(t,e){for(var r=0,n=this.listeners;r<n.length;r++)n[r].onPageEnded(t,e)},t.prototype.onLifecycleChanged=function(t,e){switch(t){case"pageshow":case"locationChange":var r=rI.createWithCurrentPage();return this.updatePage(r,e);case"visible":case"pagehide":case"blur":case"focus":case"hidden":return}},t.prototype.addListener=function(t){this.listeners.push(t)},t}(),dc=J.log,dp=function(){function t(t,e,r){this.userManager=t,this.pageManager=e,this.minimumEngagementDurationMillis=r,this.listeners=[],this._lastEngagementTime=null}return Object.defineProperty(t.prototype,"lastEngagementTime",{get:function(){return this._lastEngagementTime},enumerable:!1,configurable:!0}),t.prototype.startEngagement=function(t){dc.debug("startEngagement timestamp:".concat(t,", page:").concat(this.pageManager.currentPage.url)),this._lastEngagementTime=t},t.prototype.endEngagement=function(t,e){if(!B.isNullOrUndefined(this._lastEngagementTime)){var r=this._lastEngagementTime;this._lastEngagementTime=e;var n=e-r;n<this.minimumEngagementDurationMillis||this.publish({page:t,durationMillis:n},this.userManager.resolve(),e)}},t.prototype.publish=function(t,e,r){dc.debug("onEngagement timestamp:".concat(r,", page:").concat(this.pageManager.currentPage.url));for(var n=0,i=this.listeners;n<i.length;n++)i[n].onEngagement(t,e,r)},t.prototype.onPageStarted=function(t,e){this.startEngagement(e)},t.prototype.onPageEnded=function(t,e){this.endEngagement(t,e)},t.prototype.onLifecycleChanged=function(t,e){switch(t){case"visible":case"focus":return this.startEngagement(e);case"pagehide":case"hidden":case"blur":return this.endEngagement(this.pageManager.currentPage,e);case"pageshow":case"locationChange":return}},t.prototype.addListener=function(t){this.listeners.push(t)},t}(),dl=function(){function t(t){this.core=t}return t.prototype.onEngagement=function(e,r,n){var i,o={key:t.ENGAGEMENT_EVENT_KEY,properties:((i={})[du.PAGE_NAME_PROPERTY_KEY]=e.page.pageTitle,i[t.ENGAGEMENT_TIME_PROPERTY_KEY]=e.durationMillis,i)};this.core.track(o,r,n)},t.ENGAGEMENT_EVENT_KEY="$engagement",t.ENGAGEMENT_TIME_PROPERTY_KEY="$engagement_time_ms",t}(),df=function(){function t(t,e){this.core=t,this.userManager=e}return t.prototype.setPhoneNumber=function(e,r){var n=new rw().set(t.PHONE_NUMBER_PROPERTY_KEY,e.getValue()).build().toSecuredEvent();this.track(n,r)},t.prototype.unsetPhoneNumber=function(e){var r=new rw().unset(t.PHONE_NUMBER_PROPERTY_KEY).build().toSecuredEvent();this.track(r,e)},t.prototype.track=function(t,e){var r=this.userManager.resolve();this.core.track(t,r,e)},t.PHONE_NUMBER_PROPERTY_KEY="$phone_number",t}(),dh=function(){function t(){}return t.prototype.getBrowserProperties=function(){return fE.generate(window,rI.createWithCurrentPage())},t}(),dd=function(){function t(t,e,r){this.schedule=t,this.scheduleType=e,this.requestedAt=r}return Object.defineProperty(t.prototype,"delayMillis",{get:function(){return this.schedule.time.deliverAt-this.requestedAt},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"InAppMessageScheduleRequest(scheduleType=".concat(this.scheduleType,", requestedAt=").concat(this.requestedAt,")")},t}(),dv=function(){function t(t,e,r,n,i,o){this.dispatchId=t,this.inAppMessageKey=e,this.identifiers=r,this.time=n,this.reason=i,this.eventBasedContext=o}return t.prototype.toRequest=function(t,e){return new dd(this,t,e)},t.create=function(e){return new t((0,K.Z)(),e.inAppMessage.key,e.event.user.identifiers,dy.of(e.inAppMessage,e.event.timestamp),e.reason,new dg(e.event.insertId,e.event.event))},t.fromDelayStorageEntity=function(e,r){return new t(e.schedule.dispatchId,e.schedule.inAppMessageKey,e.schedule.identifiers,new dy(r,e.schedule.time.deliverAt),e.schedule.reason,e.schedule.eventBasedContext)},t}(),dy=function(){function t(t,e){this.startedAt=t,this.deliverAt=e}return t.prototype.delayMillis=function(t){return this.deliverAt-t},t.of=function(e,r){return new t(r,e.eventTrigger.delay.deliverAt(r))},t}(),dg=function(t,e){this.insertId=t,this.event=e},dm=function(){function t(t,e,r,n,i,o){this.scheduleProcessor=t,this.delayStorage=e,this.triggerProcessor=r,this.resetProcessor=n,this.userEventEmitter=i,this.clock=o,this.initialize()}return t.prototype.initialize=function(){var t=this;this.userEventEmitter.on("event",function(e){t.onEvent(e)})},t.prototype.destroy=function(){var t=this;this.userEventEmitter.off("event",function(e){t.onEvent(e)})},t.prototype.onEvent=function(t){this.triggerProcessor.process(t)},t.prototype.onUserUpdated=function(t,e,r){var n=tD(t),i=tD(e);this.resetProcessor.process({identifiers:n},{identifiers:i})},t.prototype.loadDelaySchedule=function(){var t=this;this.delayStorage.values().forEach(function(e){var r=t.clock.currentMillis(),n=dv.fromDelayStorageEntity(e,r).toRequest("STORED",r);t.scheduleProcessor.process(n)})},t}(),dE=function(t){function e(e){return t.call(this,e)||this}return Y(e,t),e.prototype.resolve=function(t,e,r){return e.setProperty("experiment_id",r.experiment.id),e.setProperty("experiment_key",r.experiment.key),e.setProperty("variation_id",r.variationId),e.setProperty("variation_key",r.variationKey),e.setProperty("experiment_decision_reason",r.reason),r},e}(lJ),dw=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Y(e,t),e}(pZ),dT=function(){function t(t,e,r,n,i){this.request=t,this.reason=e,this.targetEvaluations=r,this.message=n,this.properties=i}return Object.defineProperty(t.prototype,"inAppMessage",{get:function(){return this.request.inAppMessage},enumerable:!1,configurable:!0}),t.of=function(e,r,n){return new t(e,tM.IN_APP_MESSAGE_TARGET,r.targetEvaluations,n,r.properties)},t}(),db=function(){function t(){}return Object.defineProperty(t.prototype,"key",{get:function(){return new p4("IN_APP_MESSAGE",this.inAppMessage.id)},enumerable:!1,configurable:!0}),t}(),dI=function(t){function e(e,r,n){var i=t.call(this)||this;return i.workspace=e,i.user=r,i.inAppMessage=n,i}return Y(e,t),e.of=function(t){return t instanceof e?t:new e(t.workspace,t.user,t.inAppMessage)},e.prototype.toString=function(){return"InAppMessageLayoutRequest(type=".concat(this.key.type,", key=").concat(this.inAppMessage.key,")")},e}(db),dN=function(t){function e(e,r,n){var i=t.call(this)||this;return i.experimentEvaluator=e,i.selector=r,i.eventRecorder=n,i}return Y(e,t),e.prototype.supports=function(t){return t instanceof dI},e.prototype.evaluateInternal=function(t,e){var r=t.inAppMessage.messageContext.experimentContext,n=null!==r?this.evaluateExperiment(t,e,r):this.evaluateDefault(t,e);return dT.of(t,e,n)},e.prototype.evaluateDefault=function(t,e){var r=d_(t.inAppMessage.messageContext.defaultLang);return this.selector.select(t.inAppMessage,r)},e.prototype.evaluateExperiment=function(t,e,r){var n,i=B.requiredNotNullOrUndefined(t.workspace.getExperimentOrNull(r.key),function(){return"Experiment[key=".concat(r.key,"]")}),o=this.experimentEvaluator.evaluate(t,e,i),s=d_(t.inAppMessage.messageContext.defaultLang),u=(n=o.variationKey,function(t){return n===t.variationKey});return this.selector.select(t.inAppMessage,function(t){return s(t)&&u(t)})},e.prototype.record=function(t,e){this.eventRecorder.record(t,e)},e}(dw);function d_(t){return function(e){return t===e.lang}}var dA=function(){function t(){}return t.prototype.select=function(t,e){var r=t.messageContext.messages.find(e);return B.requiredNotNullOrUndefined(r,function(){return"InAppMessage must be decided [".concat(t.id,"]")})},t}(),dO=function(){function t(t){this.storage=t,this.STORE_MAX_SIZE=100}return t.prototype.record=function(t,e){if(t.reason!==tM.OVERRIDDEN)try{this.doRecord(t)}catch(t){J.log.error("Failed to record InAppMessageImpression: ".concat(t))}},t.prototype.doRecord=function(t){var e=this.storage.get(t.inAppMessage),r={identifiers:t.user.identifiers,timestamp:t.requestedAt},n=Z(Z([],e,!0),[r],!1),i=n.length>this.STORE_MAX_SIZE?n.length-this.STORE_MAX_SIZE:0,o=n.slice(i);this.storage.set(t.inAppMessage,o)},t}(),dM=function(){function t(t,e){this.dispatchId=t,this.context=e}return t.prototype.toString=function(){return"InAppMessagePresentResponse(dispatchId=".concat(this.dispatchId,", inAppMessage=").concat(this.context.inAppMessage,", displayType=").concat(this.context.message.layout.displayType,", layoutType=").concat(this.context.message.layout.layoutType,")")},t.of=function(e,r){return new t(e.dispatchId,r)},t}(),dP=function(){function t(t,e,r,n,i,o){this.dispatchId=t,this.inAppMessage=e,this.message=r,this.user=n,this.decisionReason=i,this.properties=o}return t.prototype.toString=function(){return"InAppMessagePresentationContext(dispatchId=".concat(this.dispatchId,", inAppMessage=").concat(this.inAppMessage,", message=").concat(this.message,")")},t.of=function(e){return new t(e.dispatchId,e.inAppMessage,e.message,e.user,e.reason,e.properties)},t}(),dS=function(){function t(t,e){this.presenter=t,this.recorder=e}return t.prototype.process=function(t){J.log.debug("InAppMessage Present Request: ".concat(t));var e=this.present(t);return this.recorder.record(t,e),J.log.debug("InAppMessage Present Response: ".concat(e)),e},t.prototype.present=function(t){var e=dP.of(t);return this.presenter.present(e),dM.of(t,e)},t}(),dR=function(){function t(){}return t.prototype.isIdentifierChanged=function(t,e){var r=t[tk.USER],n=e[tk.USER];if(void 0!==r&&void 0!==n)return r!==n;var i=t[tk.DEVICE],o=e[tk.DEVICE];return void 0!==i&&void 0!==o&&i!==o},t}(),dU=function(){function t(t,e){this.clock=t,this.scheduler=e}return Object.defineProperty(t.prototype,"listener",{get:function(){return this._listener},set:function(t){this._listener=t},enumerable:!1,configurable:!0}),t.prototype.schedule=function(t){var e=this,r=this.scheduler.schedule(t.delayMillis,function(){return e.delayCommand(t)});return new dC(t,r)},t.prototype.delayCommand=function(t){var e,r=this.clock.currentMillis(),n=t.schedule.toRequest("DELAYED",r);null===(e=this.listener)||void 0===e||e.onSchedule(n)},t}(),dC=function(){function t(t,e){this.delay=t,this.job=e}return t.prototype.cancel=function(){this.job.cancel(),J.log.debug("InAppMessageDelay cancelled: ".concat(this.delay))},t}(),dx=function(){function t(t,e){this.schedule=t,this.requestedAt=e}return Object.defineProperty(t.prototype,"delayMillis",{get:function(){return this.schedule.time.delayMillis(this.requestedAt)},enumerable:!1,configurable:!0}),t.from=function(e){return new t(e.schedule,e.requestedAt)},t.prototype.toString=function(){return"InAppMessageDelay(dispatchId=".concat(this.schedule.dispatchId,", requestedAt=").concat(this.requestedAt,")")},t}(),dk=function(){function t(t,e,r){this.scheduler=t,this.tasks=e,this.storage=r}return t.prototype.registerAndDelay=function(t){return this.storage.set(t.schedule.inAppMessageKey,t.schedule.dispatchId,dx.from(t)),this.delay(t)},t.prototype.delay=function(t){var e=dx.from(t),r=this.scheduler.schedule(e);return this.tasks.set(e.schedule.dispatchId,r),J.log.debug("InAppMessage Delay started: dispatchId=".concat(t.schedule.dispatchId)),e},t.prototype.delete=function(t){var e,r,n=null!==(r=null===(e=this.tasks.get(t.schedule.dispatchId))||void 0===e?void 0:e.delay)&&void 0!==r?r:null;return n&&J.log.debug("InAppMessage Delay deleted: dispatchId=".concat(t.schedule.dispatchId)),this.tasks.delete(t.schedule.dispatchId),this.storage.remove(t.schedule.inAppMessageKey,t.schedule.dispatchId),n},t.prototype.cancelAll=function(){var t=Array.from(this.tasks.values());return t.forEach(function(t){return t.cancel()}),this.tasks.clear(),this.storage.clear(),J.log.debug("InAppMessage Delay clear."),t.map(function(t){return t.delay})},t}(),dD=function(){function t(t,e,r,n){this.dispatchId=t,this.inAppMessageKey=e,this.code=r,this.presentResponse=n}return t.prototype.toString=function(){return"InAppMessageDeliverResponse(dispatchId=".concat(this.dispatchId,", inAppMessageKey=").concat(this.inAppMessageKey,", code=").concat(this.code,")")},t.of=function(e,r,n){return void 0===n&&(n=null),new t(e.dispatchId,e.inAppMessageKey,r,n)},t}(),dL=function(){function t(t,e,r,n,i,o,s){this.dispatchId=t,this.inAppMessage=e,this.message=r,this.user=n,this.requestedAt=i,this.reason=o,this.properties=s}return t.prototype.toString=function(){return"InAppMessagePresentRequest(dispatchId=".concat(this.dispatchId,", inAppMessage=").concat(this.inAppMessage,", user=").concat(this.user.identifiers,", requestedAt=").concat(this.requestedAt,", reason=").concat(this.reason,", properties=").concat(this.properties,")")},t.of=function(e,r,n,i,o){return new t(e.dispatchId,r,o.message,n,e.requestedAt,i.reason,W(W({},e.properties),o.properties))},t}(),dF=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.workspace=e,o.user=r,o.inAppMessage=n,o.timestamp=i,o}return Y(e,t),e.prototype.toString=function(){return"InAppMessageEligibilityRequest(type=".concat(this.key.type,", key=").concat(this.inAppMessage.key,")")},e}(db),dV=function(){function t(t,e,r,n,i,o){this.workspaceFetcher=t,this.userManager=e,this.identifierChecker=r,this.layoutResolver=n,this.evaluateProcessor=i,this.presentProcessor=o}return t.prototype.response=function(t){try{return this.deliver(t)}catch(e){return J.log.error("Failed to process InAppMessageDeliver: ".concat(e)),dD.of(t,"EXCEPTION")}},t.prototype.process=function(t){J.log.debug("InAppMessage Deliver Request: ".concat(t));var e=this.response(t);return J.log.debug("InAppMessage Deliver Response: ".concat(e)),e},t.prototype.deliver=function(t){var e=this.workspaceFetcher.get();if(!e)return dD.of(t,"WORKSPACE_NOT_FOUND");var r=e.getInAppMessageOrNull(t.inAppMessageKey);if(!r)return dD.of(t,"IN_APP_MESSAGE_NOT_FOUND");var n=this.userManager.resolve();if(this.identifierChecker.isIdentifierChanged(t.identifiers,n.identifiers))return dD.of(t,"IDENTIFIER_CHANGED");var i=this.layoutResolver.resolve(e,r,n),o=new dF(e,n,r,t.requestedAt),s=this.evaluateProcessor.process("DELIVER",o);if(!s.isEligible)return dD.of(t,"INELIGIBLE");var u=dL.of(t,r,n,s,i),a=this.presentProcessor.process(u);return dD.of(t,"PRESENT",a)},t}(),dK=function(){function t(t){this.schedulers=t}return t.prototype.get=function(t){return B.requiredNotNullOrUndefined(this.schedulers.find(function(e){return e.supports(t)}),function(){return"Unsupported InAppMessageScheduleType[".concat(t,"]")})},t}(),dG=function(){function t(t,e,r,n,i){this.dispatchId=t,this.inAppMessageKey=e,this.code=r,this.deliverResponse=n,this.delay=i}return t.prototype.toString=function(){return"InAppMessageScheduleResponse(dispatchId=".concat(this.dispatchId,", inAppMessageKey=").concat(this.inAppMessageKey,", code=").concat(this.code,")")},t.of=function(e,r,n,i){return void 0===n&&(n=null),void 0===i&&(i=null),new t(e.schedule.dispatchId,e.schedule.inAppMessageKey,r,n,i)},t}(),dB=function(){function t(t,e,r,n,i,o){this.dispatchId=t,this.inAppMessageKey=e,this.identifiers=r,this.requestedAt=n,this.reason=i,this.properties=o}return t.of=function(e){var r=new ru().add("$trigger_event_insert_id",e.schedule.eventBasedContext.insertId).build();return new t(e.schedule.dispatchId,e.schedule.inAppMessageKey,e.schedule.identifiers,e.requestedAt,e.schedule.reason,B.fromMap(r))},t.prototype.toString=function(){return"InAppMessageDeliverRequest(dispatchId=".concat(this.dispatchId,", inAppMessageKey=").concat(this.inAppMessageKey,", identifiers=").concat(this.identifiers,", requestedAt=").concat(this.requestedAt,", reason=").concat(this.reason)},t}(),dH=function(){function t(){}return t.prototype.schedule=function(t,e){switch(t){case"DELIVER":return this.deliver(e);case"DELAY":return this.delay(e);case"IGNORE":return this.ignore(e)}},t}(),dj=function(t){function e(e,r){var n=t.call(this)||this;return n.deliverProcessor=e,n.delayManager=r,n}return Y(e,t),e.prototype.supports=function(t){return"DELAYED"===t},e.prototype.deliver=function(t){var e=this.delayManager.delete(t);B.requiredNotNullOrUndefined(e,function(){return"InAppMessageDelay not found (inAppMessageKey=".concat(t.schedule.inAppMessageKey,")")});var r=dB.of(t),n=this.deliverProcessor.process(r);return dG.of(t,"DELIVER",n)},e.prototype.delay=function(t){var e=this.delayManager.delay(t);return dG.of(t,"DELAY",null,e)},e.prototype.ignore=function(t){var e=this.delayManager.delete(t);return dG.of(t,"IGNORE",null,e)},e}(dH),dJ=function(t){function e(e,r){var n=t.call(this)||this;return n.deliverProcessor=e,n.delayManager=r,n}return Y(e,t),e.prototype.supports=function(t){return"TRIGGERED"===t},e.prototype.deliver=function(t){var e=dB.of(t),r=this.deliverProcessor.process(e);return dG.of(t,"DELIVER",r)},e.prototype.delay=function(t){var e=this.delayManager.registerAndDelay(t);return dG.of(t,"DELAY",null,e)},e.prototype.ignore=function(t){return dG.of(t,"IGNORE")},e}(dH),dz=function(){function t(t,e){this.actionDeterminer=t,this.schedulerFactory=e}return t.prototype.process=function(t){J.log.debug("InAppMessage Schedule Request: ".concat(t));var e=this.schedule(t);return J.log.debug("InAppMessage Schedule Response: ".concat(e)),e},t.prototype.schedule=function(t){try{var e=this.actionDeterminer.determine(t);return this.schedulerFactory.get(t.scheduleType).schedule(e,t)}catch(e){return J.log.error("Failed to process InAppMessageSchedule: ".concat(e)),dG.of(t,"EXCEPTION")}},t.prototype.onSchedule=function(t){this.process(t)},t}(),dq=function(){function t(){this.DELIVER_DURATION_THRESHOLD_MILLIS=-1e4}return t.prototype.shouldIgnoreRequest=function(t){return"STORED"===t.scheduleType&&t.delayMillis<0},t.prototype.determineAction=function(t){var e=t.delayMillis;if(e>0)return"DELAY";if(e>=this.DELIVER_DURATION_THRESHOLD_MILLIS)return"DELIVER";if(e<this.DELIVER_DURATION_THRESHOLD_MILLIS)return"IGNORE";throw Error("InAppMessageScheduleAction cannot be determined (key=".concat(t.schedule.inAppMessageKey,")"))},t.prototype.determine=function(t){if(this.shouldIgnoreRequest(t))return"IGNORE";var e=this.determineAction(t);return J.log.debug("InAppMessage ScheduleAction determined: action=".concat(e,", dispatchId=").concat(t.schedule.dispatchId)),e},t}(),dY=function(){function t(t,e,r){this.inAppMessage=t,this.reason=e,this.event=r}return t.prototype.toString=function(){return"InAppMessageTrigger(inAppMessage=".concat(this.inAppMessage.toString(),", reason=").concat(this.reason,", insertId=").concat(this.event.insertId,", timestamp=").concat(this.event.timestamp,", event=").concat(this.event.event.key,")")},t}(),dW=function(){function t(t,e,r){this.workspaceFetcher=t,this.eventMatcher=e,this.evaluateProcessor=r}return t.prototype.determine=function(t){var e=pJ.isTrackEvent(t)?t:null;if(!e)return null;var r=this.workspaceFetcher.get();if(!r)return null;for(var n=0,i=r.getInAppMessages();n<i.length;n++){var o=i[n];if(this.eventMatcher.matches(r,o,e)){var s=this.evaluate(r,o,e);if(s.isEligible)return new dY(o,s.reason,e)}}return null},t.prototype.evaluate=function(t,e,r){var n=new dF(t,r.user,e,r.timestamp);return this.evaluateProcessor.process("TRIGGER",n)},t}(),dX=function(){function t(t){this.scheduleProcessor=t}return t.prototype.handle=function(t){var e=dv.create(t).toRequest("TRIGGERED",t.event.timestamp);this.scheduleProcessor.process(e)},t}(),d$=function(){function t(t,e){this.determiner=t,this.handler=e}return t.prototype.process=function(t){try{var e=this.determiner.determine(t);if(!e)return;J.log.debug("InAppMessage triggered: ".concat(e)),this.handler.handle(e)}catch(t){J.log.error("Failed to process InAppMessage event trigger: ".concat(t))}},t}(),dZ=function(){function t(t,e){this.identifierChecker=t,this.delayManager=e}return t.prototype.process=function(t,e){try{this.identifierChecker.isIdentifierChanged(tD(t),tD(e))&&this.delayManager.cancelAll()}catch(t){J.log.error("Failed to reset InAppMessage: ".concat(t))}},t}(),dQ=function(){function t(t){this.storage=t,this.storageKey="iam-delay"}return t.prototype.getDelayStorageItem=function(){var t=this.storage.getItem(this.storageKey);if(B.isNullOrUndefined(t))return null;try{return JSON.parse(t)}catch(t){return J.log.warn("Failed to get delay storage item: ".concat(t)),null}},t.prototype.get=function(t,e){var r,n,i=this.getDelayStorageItem();return B.isNullOrUndefined(i)?null:null!==(n=null===(r=i[t])||void 0===r?void 0:r.find(function(t){return t.schedule.dispatchId===e}))&&void 0!==n?n:null},t.prototype.set=function(t,e,r){var n,i,o=this.getDelayStorageItem();if(B.isNullOrUndefined(o)){J.log.debug("No delay storage item found. create new item"),this.storage.setItem(this.storageKey,JSON.stringify(((n={})[t]=[r],n)));return}var s=null!==(i=o[t])&&void 0!==i?i:[];s.push(r),o[t]=s,this.storage.setItem(this.storageKey,JSON.stringify(o))},t.prototype.remove=function(t,e){var r=this.getDelayStorageItem(),n=null==r?void 0:r[t];if(B.isNullOrUndefined(r)||B.isNullOrUndefined(n)){J.log.debug("No delay storage item found for ".concat(t,". do nothing"));return}r[t]=n.filter(function(t){return t.schedule.dispatchId!==e}),0===r[t].length&&delete r[t],this.storage.setItem(this.storageKey,JSON.stringify(r))},t.prototype.values=function(){var t=this.getDelayStorageItem();return B.isNullOrUndefined(t)?(J.log.debug("No delay storage item found. do nothing"),[]):Object.values(t).flat()},t.prototype.clear=function(){this.storage.removeItem(this.storageKey)},t}(),d0=function(){function t(t){this.clock=t}return t.prototype.create=function(e,r){var n=this,i=this.clock.currentMillis(),o=[],s=this.createEvent(e,r,i,{});return s&&o.push(s),r.targetEvaluations.forEach(function(r){var s,u=((s={})[t.ROOT_TYPE]=e.key.type,s[t.ROOT_ID]=e.key.id,s),a=n.createEvent(e,r,i,u);a&&o.push(a)}),o},t.prototype.createEvent=function(e,r,n,i){var o;return r instanceof pQ?(i[t.CONFIG_ID_PROPERTY_KEY]=null===(o=r.config)||void 0===o?void 0:o.id,i[t.EXPERIMENT_VERSION_KEY]=r.experiment.version,i[t.EXECUTION_VERSION_KEY]=r.experiment.executionVersion,pJ.exposure(e.user,r,i,n)):r instanceof p1?pJ.remoteConfig(e.user,r,W(W({},i),r.properties),n):null},t.ROOT_TYPE="$targetingRootType",t.ROOT_ID="$targetingRootId",t.CONFIG_ID_PROPERTY_KEY="$parameterConfigurationId",t.EXPERIMENT_VERSION_KEY="$experiment_version",t.EXECUTION_VERSION_KEY="$execution_version",t}(),d1=function(){function t(t,e){this.eventFactory=t,this.eventProcessor=e}return t.prototype.record=function(t,e){var r=this;this.eventFactory.create(t,e).forEach(function(t){r.eventProcessor.process(t)})},t}(),d2=function(){function t(t,e,r,n,i){this.reason=t,this.targetEvaluations=e,this.inAppMessage=r,this.isEligible=n,this.layoutEvaluation=i}return t.eligible=function(e,r,n){return t.of(e,r,n,!0)},t.ineligible=function(e,r,n){return t.of(e,r,n,!1)},t.of=function(e,r,n,i){return new t(String(n),r.targetEvaluations,e.inAppMessage,i,r.get(dT))},t}(),d4=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return t.inAppMessage.supports("WEB")?r.evaluate(t,e):d2.ineligible(t,e,tM.UNSUPPORTED_PLATFORM)},t}(),d3=function(){function t(t){this.userOverrideMatcher=t}return t.prototype.evaluate=function(t,e,r){return this.userOverrideMatcher.matches(t,e)?d2.eligible(t,e,tM.OVERRIDDEN):r.evaluate(t,e)},t}(),d6=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return"DRAFT"===t.inAppMessage.status?d2.ineligible(t,e,tM.IN_APP_MESSAGE_DRAFT):r.evaluate(t,e)},t}(),d5=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return"PAUSE"===t.inAppMessage.status?d2.ineligible(t,e,tM.IN_APP_MESSAGE_PAUSED):r.evaluate(t,e)},t}(),d9=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return t.inAppMessage.period.within(t.timestamp)?r.evaluate(t,e):d2.ineligible(t,e,tM.NOT_IN_IN_APP_MESSAGE_PERIOD)},t}(),d8=function(){function t(t){this.hiddenMatcher=t}return t.prototype.evaluate=function(t,e,r){return this.hiddenMatcher.matches(t,e)?d2.ineligible(t,e,tM.IN_APP_MESSAGE_HIDDEN):r.evaluate(t,e)},t}(),d7=function(){function t(t){this.targetMatcher=t}return t.prototype.evaluate=function(t,e,r){return this.targetMatcher.matches(t,e)?r.evaluate(t,e):d2.ineligible(t,e,tM.NOT_IN_IN_APP_MESSAGE_TARGET)},t}(),vt=function(){function t(t){this.frequencyCapMatcher=t}return t.prototype.evaluate=function(t,e,r){return this.frequencyCapMatcher.matches(t,e)?d2.ineligible(t,e,tM.IN_APP_MESSAGE_FREQUENCY_CAPPED):r.evaluate(t,e)},t}(),ve=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return d2.eligible(t,e,tM.IN_APP_MESSAGE_TARGET)},t}(),vr=function(){function t(t){this.layoutEvaluator=t}return t.prototype.evaluate=function(t,e,r){var n=dI.of(t),i=this.layoutEvaluator.evaluate(n,p3.create());return e.set(dT,i),r.evaluate(t,e)},t}(),vn=function(){function t(){}return t.prototype.matches=function(t,e){var r=this;return t.inAppMessage.targetContext.overrides.some(function(e){return r.isUserOverridden(t,e)})},t.prototype.isUserOverridden=function(t,e){var r=t.user.identifiers[e.identifierType];return!B.isNullOrUndefined(r)&&e.identifiers.includes(r)},t}(),vi=function(){function t(t){this.targetMatcher=t}return t.prototype.matches=function(t,e){var r=this,n=t.inAppMessage.targetContext.targets;return 0===n.length||n.some(function(n){return r.targetMatcher.matches(t,e,n)})},t}(),vo=function(){function t(t){this.storage=t}return t.prototype.matches=function(t,e){return this.storage.exist(t.inAppMessage,t.timestamp)},t}(),vs=function(){function t(t){this.storage=t}return t.prototype.matches=function(t,e){var r=t.inAppMessage,n=t.user,i=t.timestamp;return this.isFrequencyCapped(r,n,i)},t.prototype.isFrequencyCapped=function(t,e,r){if(!t.eventTrigger.frequencyCap)return!1;var n=this.createMatchContexts(t.eventTrigger.frequencyCap);if(0===n.length)return!1;for(var i=this.storage.get(t),o=0;o<i.length;o++)for(var s=i[o],u=0;u<n.length;u++)if(n[u].matches(e,r,s))return!0;return!1},t.prototype.createMatchContexts=function(t){for(var e=[],r=0,n=t.identifierCaps;r<n.length;r++){var i=n[r];e.push(new vu(new va(i)))}return t.durationCap&&e.push(new vu(new vc(t.durationCap))),e},t}(),vu=function(){function t(t){this.matchCount=0,this.predicate=t}return t.prototype.matches=function(t,e,r){return this.predicate.matches(t,e,r)&&(this.matchCount+=1),this.matchCount>=this.predicate.thresholdCount},t}(),va=function(){function t(t){this.identifierCap=t}return Object.defineProperty(t.prototype,"thresholdCount",{get:function(){return this.identifierCap.count},enumerable:!1,configurable:!0}),t.prototype.matches=function(t,e,r){var n=t.identifiers[this.identifierCap.identifierType];if(B.isNullOrUndefined(n))return!1;var i=r.identifiers[this.identifierCap.identifierType];return!B.isNullOrUndefined(i)&&n===i},t}(),vc=function(){function t(t){this.durationCap=t}return Object.defineProperty(t.prototype,"thresholdCount",{get:function(){return this.durationCap.count},enumerable:!1,configurable:!0}),t.prototype.matches=function(t,e,r){return e-r.timestamp<=this.durationCap.durationMillis},t}(),vp=function(){function t(t,e,r){this.layoutEvaluator=r;var n=le.get("targetMatcher"),i=[new d4,new d3(new vn),new d6,new d5,new d9,new d7(new vi(n))],o=[new vr(this.layoutEvaluator)],s=[new vt(new vs(e)),new d8(new vo(t))],u=[new ve];this.triggerFlow=li.of.apply(li,Z(Z(Z(Z([],i,!1),o,!1),s,!1),u,!1)),this.deliverFlow=li.of.apply(li,Z(Z([],s,!1),u,!1)),this.deliverReEvaluateFlow=li.of.apply(li,Z(Z(Z([],i,!1),s,!1),u,!1))}return t.prototype.getTriggerFlow=function(){return this.triggerFlow},t.prototype.getDeliverFlow=function(t){return t?this.deliverReEvaluateFlow:this.deliverFlow},t}(),vl=function(t){function e(e,r){var n=t.call(this)||this;return n.evaluationFlow=e,n.eventRecorder=r,n}return Y(e,t),e.prototype.supports=function(t){return void 0!==t.inAppMessage},e.prototype.evaluateInternal=function(t,e){var r;return null!==(r=this.evaluationFlow.evaluate(t,e))&&void 0!==r?r:d2.ineligible(t,e,tM.NOT_IN_IN_APP_MESSAGE_TARGET)},e.prototype.record=function(t,e){this.eventRecorder.record(t,e),e.isEligible||null===e.layoutEvaluation||this.eventRecorder.record(e.layoutEvaluation.request,e.layoutEvaluation)},e}(dw),vf=function(){function t(t,e,r){this.core=t,this.flowFactory=e,this.eventRecorder=r}return t.prototype.process=function(t,e){var r=new vl(this.resolveFlow(t,e),this.eventRecorder);return this.core.inAppMessage(e,p3.create(),r)},t.prototype.resolveFlow=function(t,e){var r,n;return"TRIGGER"===t?this.flowFactory.getTriggerFlow():this.flowFactory.getDeliverFlow(null!==(n=null===(r=e.inAppMessage.evaluateContext)||void 0===r?void 0:r.atDeliverTime)&&void 0!==n&&n)},t}(),vh=function(){function t(t,e){this.core=t,this.layoutEvaluator=e}return t.prototype.resolve=function(t,e,r){var n=new dI(t,r,e);return this.core.inAppMessage(n,p3.create(),this.layoutEvaluator)},t}(),vd=function(t){function e(e,r){var n=t.call(this)||this;return n.deliverProcessor=e,n.delayManager=r,n}return Y(e,t),e.prototype.supports=function(t){return"STORED"===t},e.prototype.deliver=function(t){var e=this.delayManager.delete(t);B.requiredNotNullOrUndefined(e,function(){return"InAppMessageDelay not found (inAppMessageKey=".concat(t.schedule.inAppMessageKey,")")});var r=dB.of(t),n=this.deliverProcessor.process(r);return dG.of(t,"DELIVER",n,e)},e.prototype.delay=function(t){var e=this.delayManager.delay(t);return J.log.debug("StoredDelay is scheduled (inAppMessageKey=".concat(t.schedule.inAppMessageKey,", delayMillis=").concat(t.delayMillis.toLocaleString(),")")),dG.of(t,"DELAY",null,e)},e.prototype.ignore=function(t){var e=this.delayManager.delete(t);return dG.of(t,"IGNORE",null,e)},e}(dH);!function(){function t(){this.operations=new Map}t.prototype.marketing=function(t){return this.operations.set("$marketing",t),this},t.prototype.information=function(t){return this.operations.set("$information",t),this},t.prototype.custom=function(t,e){return this.operations.set(t,e),this},t.prototype.build=function(){return new vv(this.operations)}}();var vv=function(){function t(t){this.operations=t}return t.prototype.toEvent=function(t){var e=new rw;return this.operations.forEach(function(t,r){e.set(r,t)}),{key:t,properties:B.fromMap(this.operations)}},t.prototype.toRecord=function(){var t={};return this.operations.forEach(function(e,r){t[r]=e}),t},t}();(s=V||(V={})).SUBSCRIBED="SUBSCRIBED",s.UNSUBSCRIBED="UNSUBSCRIBED",s.UNKNOWN="UNKNOWN";var vy=J.log,vg=null;function vm(t,e){var r,n,i,o,s,u=h_.sdk(t,e);if(vg)return vy.debug("use already exists hackleClient"),vg;var a=new rC;a.initialize();var c=new fP,p=rU.getInstance({days:3650,isCrossSubdomain:!0,sameSite:e.sameSiteCookie,isSecure:e.secureCookie}),l=h_.isBeaconSupported(),f=hB.intercept(u,hH.create()),h=hB.intercept(u,hj.create()),d=f;l&&(d=h);var v=new hA,y=new hO(v,new hM("setTimeout"),h_.pollingIntervalMillis(e)),g=new hD(new h4(u,fS.postfix(c,"_".concat(t.slice(0,8)))),new hU(fC.clientFetch(e.sdkUrl,u.key),f));v.add(g);var m=new da,E=new hx(fC.userTargets(e.sdkUrl),f),w=new hC(fC.userCohorts(e.sdkUrl),f),T=new hh(m),b=new f_(fS.postfix(p,"_".concat(t))),I=b.getUser(),N=e.user||null,_=new fN(rx(),b,E,w,T,m,to.instance,I,N);v.add(_);var A=new fM(e.sessionTimeoutMillis,fS.postfix(p,"_".concat(t.slice(8))));_.addListener(A);var O=new fn(c,"".concat("hackle-repository-storage","_").concat(t),100),M=new hF(fC.clientDispatch(e.eventUrl),f),P=M;l&&(P=new hF(fC.beaconDispatch(e.eventUrl,u.key),h));var S=new hV(O,M),R=new hL(M,P,S),U=new h7([new de(h_.dedupIntervalMillis(e)),new dr(h_.dedupIntervalMillis(e))]),C=new hK(R,100,new hM("setTimeout"),500),x=new pX(C,U,A,_),k=new h2,D=new p7(new fR(p,"".concat("hackle-manual-override_ab","_").concat(t.slice(0,8)))),L=new p7(new fR(p,"".concat("hackle-manual-override_ff","_").concat(t.slice(0,8)))),F=new fx(fS.prefix(c,"".concat("hackle-iam-hide","_").concat(t.slice(0,8),"_"))),V=new f0(fS.prefix(c,"".concat("hackle-iam-impression","_").concat(t.slice(0,8),"_"))),K=new d0(to.instance),G=new d1(K,x),B=l9.create(g,K,x,[D,L]),H=new df(B,_),j=new hc(new hp(fS.postfix(p,"_".concat(t.slice(0,8)))),T,B,_),J=new pW(_,B);A.addListener(j),A.addListener(J);var z=new fj(B),q=new fk([new fD,new fL(new he),new fF(new he),new fV(F,to.instance),new fK(new hr),new fG(new hr),new fB(new hn),new fH(new hn)]),Y=new f1([new f2,new f3(q),new f4]),W=new f6(to.instance,z,Y),X=new f9([new f8,new f7(W),new ht(W)]),$=new f$(fC.inAppMessageRenderer(e.cdnUrl,e.IAM_RENDERER_VERSION_HEADER)),Z=new fJ(fX.create($),W,X),Q=new dN(new dE(le.get("delegatingEvaluator")),new dA,G),tt=new dS(Z,new dO(V)),te=new dR,tr=new vp(F,V,Q),tn=new vh(B,Q),ti=new dU(to.instance,new hM("setTimeout")),ts=new dQ(fS.prefix(c,"".concat("hackle-campaign-delay","_").concat(t.slice(0,8),"_"))),tu=new dk(ti,new Map,ts),ta=new vf(B,tr,G),tc=new dV(g,_,te,tn,ta,tt),tp=[new dj(tc,tu),new dJ(tc,tu),new vd(tc,tu)],tl=new dz(new dq,new dK(tp));ti.listener=tl;var tf=new d$(new dW(g,new f5(new fZ(le.get("targetMatcher"))),ta),new dX(tl)),th=new dm(tl,ts,tf,new dZ(te,tu),C,to.instance);_.addListener(th),new hb(C,new hI(g));var td=new dp(_,m,1e3);m.addListener(td);var tv=new dl(B);td.addListener(tv);var ty=new du(B,_);e.automaticPageTracking&&m.addListener(ty);var tg=new h$(le.get("targetMatcher")),tm=new h1(p,"hackle-split-url-redirected",{days:tE}),tw=new hY(new hX(g,tg,tm,B),new hQ(new h0(T),new hi,tm,k),_,B);m.addListener(tw);var tT=new fU(B,_,D,L),tb=(null===(o=e.devTool)||void 0===o?void 0:o.userExplorer)&&"function"==typeof(null===(s=e.devTool)||void 0===s?void 0:s.userExplorer),tI=e.devTool&&tb?{manager:e.devTool,userExplorer:tT}:void 0,tN=new re(fC.monitoring(e.monitoringUrl),f,d,new hM("setTimeout"),6e4);e3.addRegistry(tN);var t_=new h6;t_.addListener(m),t_.addListener(td),t_.addListener(A),t_.addListener(a),t_.addListener(S),t_.addListener(x),t_.addListener(tN),y.start();var tA=new rM(B,y,A,_,H,h5.create(6e4,1),ty,Z,tI);vg=tA;var tO=function(){e.autoOpenDevTool&&(e.devTool?tA.showUserExplorer():vy.error("DevTool is not provided"))};new l7().install(B,_);var tM=_.resolve().hackleProperties.browserName;return t_.install("string"==typeof tM?tM:null),r=Date.now(),n=_.currentUser,i=A.currentSessionId,(fi(I,n)?A.startNewSessionIfNeeded(n,r):A.startNewSession(I,n,r))===i&&j.startNewCampaignIfNeeded(n,r),tA.onReady(function(){tO(),t_.initialize(),k.dispatchDoneEventIfNeeded(),th.loadDelaySchedule()}),tA}var vE={createInstance:function(t,e){var r,n=h_.config(e);h_.logging(n);try{if((r=window)&&"_hackleApp"in r&&null!==r._hackleApp&&"object"==typeof r._hackleApp&&"getAppSdkKey"in r._hackleApp&&"function"==typeof r._hackleApp.getAppSdkKey&&"getInvocationType"in r._hackleApp&&"function"==typeof r._hackleApp.getInvocationType&&t===window._hackleApp.getAppSdkKey())return function(t,e,r){var n=new hq().getInvocator(r.getInvocationType(),new dn);if(null===n)throw Error("Failed to get invocator with invocationType:".concat(r.getInvocationType()));var i=new dh,o=new rF(new di(n),i);if(!r.getAppMode)return o;var s=r.getAppMode().toLowerCase();if(s===c.native)return o;if(s===c.web_view_wrapper){var u=new rV(vm(t,e),o);return u.syncUser(),u}throw Error("Unsupported HackleAppMode: ".concat(s))}(t,n,window._hackleApp)}catch(t){vy.error("Unexpected exception while check WebApp client: ".concat(t))}return vm(t,n)},getUserId:rx,setUserId:function(t){rU.getInstance().setItem(th,t)},removeUserId:rk,Logger:J}}}]);
//# sourceMappingURL=e6365f38-26138dde76580fce.js.map